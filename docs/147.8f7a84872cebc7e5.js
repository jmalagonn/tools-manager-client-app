"use strict";(self.webpackChunkToolsManagerClientApp=self.webpackChunkToolsManagerClientApp||[]).push([[147],{2147:(G,T,a)=>{a.r(T),a.d(T,{UsersManagementModule:()=>U});var l=a(6895),u=a(8869),c=a(3131),t=a(1571),d=a(6858),A=a(2687),x=a(2216);function C(s,i){if(1&s&&(t.TgZ(0,"button",7),t._UZ(1,"fa-icon",6),t.qZA()),2&s){const e=t.oxw(3);t.xp6(1),t.Q6J("icon",e.faCircleInfo)}}const E=function(s){return["/tools-output",s]};function F(s,i){if(1&s&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t.YNc(7,C,2,1,"button",4),t.TgZ(8,"a",5),t._UZ(9,"fa-icon",6),t.qZA()()()),2&s){const e=i.$implicit,o=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,5,e.outputDateTime)," "),t.xp6(3),t.hij(" ","open"==e.outputToolState.outputToolStateName.toLowerCase()?"Abierto":"Cerrado"," "),t.xp6(2),t.Q6J("ngIf",o.actions),t.xp6(1),t.Q6J("routerLink",t.VKq(7,E,e.outputToolId)),t.xp6(1),t.Q6J("icon",o.faCircleInfo)}}function R(s,i){if(1&s&&(t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th"),t._uU(4," Fecha de salida "),t.qZA(),t.TgZ(5,"th"),t._uU(6," Estado "),t.qZA(),t.TgZ(7,"th"),t._uU(8," Acciones "),t.qZA()()(),t.TgZ(9,"tbody"),t.YNc(10,F,10,9,"tr",3),t.qZA()()),2&s){const e=t.oxw();t.xp6(10),t.Q6J("ngForOf",e.outputsTool)}}function y(s,i){1&s&&(t.TgZ(0,"p"),t._uU(1," No se encontraron salidas de herramienta\n"),t.qZA())}class p{constructor(){this.faCircleInfo=A.DBf}static#t=this.\u0275fac=function(e){return new(e||p)};static#e=this.\u0275cmp=t.Xpm({type:p,selectors:[["output-tool-list"]],inputs:{outputsTool:"outputsTool",actions:"actions"},decls:2,vars:2,consts:[["class","table",4,"ngIf"],[4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],["class","action-button",4,"ngIf"],[3,"routerLink"],[1,"text-primary",3,"icon"],[1,"action-button"]],template:function(e,o){1&e&&(t.YNc(0,R,11,1,"table",0),t.YNc(1,y,2,0,"p",1)),2&e&&(t.Q6J("ngIf",o.outputsTool&&o.outputsTool.length),t.xp6(1),t.Q6J("ngIf",o.outputsTool&&!o.outputsTool.length))},dependencies:[l.sg,l.O5,x.BN,u.rH,l.uU]})}function I(s,i){if(1&s&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&s){const e=i.$implicit;t.xp6(1),t.hij(" ",e.displayName," ")}}function J(s,i){if(1&s&&(t.TgZ(0,"div",1)(1,"div",2)(2,"p")(3,"b"),t._uU(4,"Nombre: "),t.qZA(),t._uU(5),t.qZA()(),t.TgZ(6,"div",3)(7,"p")(8,"b"),t._uU(9,"Roles:"),t.qZA()(),t.TgZ(10,"ul"),t.YNc(11,I,2,1,"li",4),t.qZA()()()),2&s){const e=t.oxw();t.xp6(5),t.hij(" ",e.user.name,""),t.xp6(6),t.Q6J("ngForOf",e.user.userRoles)}}class m{static#t=this.\u0275fac=function(e){return new(e||m)};static#e=this.\u0275cmp=t.Xpm({type:m,selectors:[["app-user-detail-view"]],inputs:{user:"user"},decls:1,vars:1,consts:[["class","row mt-3 g-2",4,"ngIf"],[1,"row","mt-3","g-2"],[1,"col-12"],[1,"col"],[4,"ngFor","ngForOf"]],template:function(e,o){1&e&&t.YNc(0,J,12,2,"div",0),2&e&&t.Q6J("ngIf",o.user)},dependencies:[l.sg,l.O5]})}var r=a(433);function w(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"li")(1,"div",18)(2,"input",19),t.NdJ("change",function(n){t.CHM(e);const b=t.oxw(2);return t.KtG(b.setUserRoleValue(n))}),t.qZA(),t.TgZ(3,"label",20),t._uU(4),t.qZA()()()}if(2&s){const e=i.$implicit;t.xp6(2),t.Q6J("value",e.userRoleId)("id","userRoles-"+e.userRoleId)("checked",e.isActive),t.xp6(1),t.uIk("for","userRoles-"+e.userRoleId),t.xp6(1),t.hij(" ",e.displayName," ")}}function N(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"div",1)(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.editForm.valid&&n.onSubmit())}),t.TgZ(2,"div",3)(3,"div",4)(4,"label",5),t._uU(5,"Nombre"),t.qZA(),t._UZ(6,"input",6),t.qZA(),t.TgZ(7,"div",4)(8,"label",7),t._uU(9,"Email"),t.qZA(),t._UZ(10,"input",8),t.qZA(),t.TgZ(11,"div",4)(12,"label",9),t._uU(13,"Identificaci\xf3n"),t.qZA(),t._UZ(14,"input",10),t.qZA(),t.TgZ(15,"div",11)(16,"p",12),t._uU(17,"Roles"),t.qZA(),t.TgZ(18,"ul",13),t.YNc(19,w,5,5,"li",14),t.qZA()()(),t.TgZ(20,"div",15)(21,"button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.cancelEditEvent.emit())}),t._uU(22,"Cancelar"),t.qZA(),t.TgZ(23,"button",17),t._uU(24,"Guardar"),t.qZA()()()()}if(2&s){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.editForm),t.xp6(18),t.Q6J("ngForOf",e.userRoles),t.xp6(4),t.Q6J("disabled",!e.editForm.dirty&&e.editForm.valid)}}class f{constructor(i,e){this.fb=i,this.httpService=e,this.cancelEditEvent=new t.vpe,this.userUpdatedEvent=new t.vpe}ngOnChanges(){this.initform(),this.filterActiveUserRoles()}initform(){!this.user||(this.editForm=this.fb.group({name:[this.user.name,r.kI.required],email:[this.user.email],idCard:[this.user.idCard,r.kI.required],userRoles:[null]}))}filterActiveUserRoles(){!this.userRoles||!this.user||(this.userRoles=this.userRoles.map(i=>(i.isActive=!!this.user.userRoles.some(e=>e.userRoleId==i.userRoleId),i)),this.filterUserRoleFormValues())}setUserRoleValue(i){const e=this.userRoles.findIndex(o=>o.userRoleId==i.target.value);this.userRoles[e].isActive=i.target.checked,this.editForm.markAsDirty(),this.filterUserRoleFormValues()}filterUserRoleFormValues(){this.editForm?.patchValue({userRoles:this.userRoles.filter(i=>i.isActive).map(i=>i.userRoleId)})}onSubmit(){const i={company:this.user.company,email:this.editForm.controls.email.value,idCard:this.editForm.controls.idCard.value,name:this.editForm.controls.name.value,userId:this.user.userId,userRoles:this.editForm.controls.userRoles.value.map(e=>({userRoleId:e}))};this.httpService.put(c.G8.userApi,i).subscribe(()=>this.userUpdatedEvent.emit())}static#t=this.\u0275fac=function(e){return new(e||f)(t.Y36(r.qu),t.Y36(d.O))};static#e=this.\u0275cmp=t.Xpm({type:f,selectors:[["app-user-detail-edit"]],inputs:{user:"user",userRoles:"userRoles"},outputs:{cancelEditEvent:"cancelEditEvent",userUpdatedEvent:"userUpdatedEvent"},features:[t.TTD],decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"mt-3",3,"formGroup","ngSubmit"],[1,"row","g-2"],[1,"col-md-6"],["for","name",1,"form-label","fw-bold"],["type","text","id","name","formControlName","name",1,"form-control"],["for","email",1,"form-label","fw-bold"],["type","email","id","email","formControlName","email",1,"form-control"],["for","idCard",1,"form-label","fw-bold"],["type","text","id","idCard","formControlName","idCard",1,"form-control"],[1,"col-12"],[1,"fw-bold"],[1,"list-unstyled"],[4,"ngFor","ngForOf"],[1,"form-actions","d-flex","justify-content-center","mt-3"],["type","button",1,"btn","btn-outline-danger","me-2",3,"click"],["type","submit",1,"btn","btn-outline-primary",3,"disabled"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"value","id","checked","change"],[1,"form-check-label"]],template:function(e,o){1&e&&t.YNc(0,N,25,3,"div",0),2&e&&t.Q6J("ngIf",o.user&&o.editForm)},dependencies:[l.sg,l.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}function M(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"div",9)(1,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.setIsEditing(!0))}),t._uU(2,"Editar usuario"),t.qZA()()}}function q(s,i){if(1&s&&t._UZ(0,"app-user-detail-view",11),2&s){const e=t.oxw(2);t.Q6J("user",e.user)}}function S(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"app-user-detail-edit",12),t.NdJ("cancelEditEvent",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.setIsEditing(!1))})("userUpdatedEvent",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.userUpdated())}),t.qZA()}if(2&s){const e=t.oxw(2);t.Q6J("user",e.user)("userRoles",e.userRoles)}}function k(s,i){if(1&s&&(t.TgZ(0,"div",1)(1,"h2",2),t._uU(2,"Detalle de usuario"),t.qZA(),t.YNc(3,M,3,0,"div",3),t.YNc(4,q,1,1,"app-user-detail-view",4),t.YNc(5,S,1,2,"app-user-detail-edit",5),t.TgZ(6,"div",6)(7,"h4",7),t._uU(8,"Salidas de herramienta"),t.qZA(),t._UZ(9,"output-tool-list",8),t.qZA()()),2&s){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",!e.isEditing),t.xp6(1),t.Q6J("ngIf",!e.isEditing),t.xp6(1),t.Q6J("ngIf",e.isEditing),t.xp6(4),t.Q6J("outputsTool",e.user.outputsTool)}}class _{constructor(i,e){this.route=i,this.httpService=e,this.isEditing=!1}ngOnInit(){this.getUser(),this.getUserRoles()}getUser(){const i=this.route.snapshot.paramMap.get("id");this.httpService.get(`${c.G8.userEmployeeApi}/${i}`).subscribe(e=>this.user=e)}getUserRoles(){this.httpService.get(`${c.G8.userRolesApi}`).subscribe(i=>this.userRoles=i)}setIsEditing(i){this.isEditing=i}userUpdated(){this.setIsEditing(!1),this.getUser()}static#t=this.\u0275fac=function(e){return new(e||_)(t.Y36(u.gz),t.Y36(d.O))};static#e=this.\u0275cmp=t.Xpm({type:_,selectors:[["app-users-management-detail"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"text-center","mt-3"],["class","d-flex justify-content-center",4,"ngIf"],[3,"user",4,"ngIf"],[3,"user","userRoles","cancelEditEvent","userUpdatedEvent",4,"ngIf"],[1,"row","mt-3"],[1,"text-center","mb-3"],[3,"outputsTool"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-outline-primary",3,"click"],[3,"user"],[3,"user","userRoles","cancelEditEvent","userUpdatedEvent"]],template:function(e,o){1&e&&t.YNc(0,k,10,4,"div",0),2&e&&t.Q6J("ngIf",o.user)},dependencies:[l.O5,p,m,f]})}var Z=a(18);function O(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"form",8),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addUserForm.valid&&n.onSubmit())}),t.TgZ(1,"div",9)(2,"label",10),t._uU(3,"Nombre"),t.qZA(),t._UZ(4,"input",11),t.qZA(),t.TgZ(5,"button",12),t._uU(6,"Enviar"),t.qZA()()}if(2&s){const e=t.oxw();t.Q6J("formGroup",e.addUserForm),t.xp6(5),t.Q6J("disabled",!e.addUserForm.valid)}}class g{constructor(i,e,o){this.bsModalRef=i,this.fb=e,this.httpService=o,this.UserAddedEvent=new t.vpe}ngOnInit(){this.initForm()}initForm(){this.addUserForm=this.fb.group({name:["",r.kI.required]})}onSubmit(){this.httpService.post("Users/addEmployee",{name:this.addUserForm?.controls.name.value}).subscribe(e=>{this.bsModalRef.hide(),this.bsModalRef.onHide.emit(e)})}static#t=this.\u0275fac=function(e){return new(e||g)(t.Y36(Z.UZ),t.Y36(r.qu),t.Y36(d.O))};static#e=this.\u0275cmp=t.Xpm({type:g,selectors:[["app-add-user-modal"]],outputs:{UserAddedEvent:"UserAddedEvent"},decls:11,vars:1,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"formGroup","ngSubmit"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","userName","formControlName","name",1,"form-control"],[1,"btn","btn-outline-primary",3,"disabled"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Agregar Nuevo Usuario"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.bsModalRef.hide()}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4),t.YNc(7,O,7,2,"form",5),t.qZA(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return o.bsModalRef.hide()}),t._uU(10,"Cerrar"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("ngIf",o.addUserForm))},dependencies:[l.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}var Q=a(8073),Y=a(5090);class h{constructor(i,e,o){this.modalService=i,this.httpService=e,this.router=o}ngOnInit(){this.getUsersList()}onOpenAddUserModal(){this.modalRef=this.modalService.show(g),this.modalRef?.onHide&&this.modalRef.onHide.subscribe(i=>{!i.name||this.getUsersList()})}getUsersList(){this.httpService.get("Users/employees").subscribe(i=>this.users=i)}onUserClicked(i){this.router.navigateByUrl(`/${c.p7.usersManagement}/${i.id}`)}static#t=this.\u0275fac=function(e){return new(e||h)(t.Y36(Z.tT),t.Y36(d.O),t.Y36(u.F0))};static#e=this.\u0275cmp=t.Xpm({type:h,selectors:[["app-users-management"]],decls:10,vars:4,consts:[[1,"container"],[1,"text-center","mt-3"],[1,"btn","btn-outline-primary",3,"click"],[3,"items","rowClickedEvent"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Administraci\xf3n de usuarios"),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){return o.onOpenAddUserModal()}),t._uU(5,"Agregar usuario"),t.qZA()(),t.TgZ(6,"h4",1),t._uU(7,"Lista de usuarios"),t.qZA(),t.TgZ(8,"app-items-list",3),t.NdJ("rowClickedEvent",function(b){return o.onUserClicked(b)}),t.ALo(9,"toItemList"),t.qZA()()),2&e&&(t.xp6(8),t.Q6J("items",t.xi3(9,1,o.users,"user")))},dependencies:[Q.H,Y.R]})}const D=[{path:"",component:h},{path:":id",component:_}];class v{static#t=this.\u0275fac=function(e){return new(e||v)};static#e=this.\u0275mod=t.oAB({type:v});static#i=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(D),u.Bz]})}var L=a(6733);class U{static#t=this.\u0275fac=function(e){return new(e||U)};static#e=this.\u0275mod=t.oAB({type:U});static#i=this.\u0275inj=t.cJS({imports:[l.ez,v,L.m]})}}}]);