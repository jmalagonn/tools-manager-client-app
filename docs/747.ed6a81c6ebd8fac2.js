"use strict";(self.webpackChunkToolsManagerClientApp=self.webpackChunkToolsManagerClientApp||[]).push([[747],{9747:(Co,Pt,p)=>{p.r(Pt),p.d(Pt,{ToolsManagementModule:()=>H});var m=p(6895),b=p(8869),g=p(2771),t=p(1571),y=p(6858),zt=p(9993),u=p(433),h=p(2687),Z=p(2216),qt=p(4028),d=p(5861),A=p(1894);function Vt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"ngx-dropzone-image-preview",2),t.NdJ("removed",function(){const s=t.CHM(n).$implicit,l=t.oxw();return t.KtG(l.onRemoveFile(s))}),t.qZA()}2&o&&t.Q6J("file",e.$implicit)("removable",!0)}class F{constructor(){this.appFilePrefix="app-file",this.files=[],this.removeFileEvent=new t.vpe,this.addFilesEvent=new t.vpe}ngOnChanges(){(!this.files||!this.files.length)&&this.appFiles&&this.getFiles()}onSelectFile(e){const n=this.files;n.push(...e.addedFiles),this.addFilesEvent.emit(e.addedFiles),this.files=n}onRemoveFile(e){if(!this.files||!e)return;const r=this.files.filter(i=>i.name!=e.name);if(this.files=r,this.appFiles&&this.appFiles.length&&e.name.match(/app-file/)?.length){const i=e.name.substring(this.appFilePrefix.length+1),s=this.appFiles.find(l=>l.appFileId==parseInt(i));this.removeFileEvent.emit(s)}}getFiles(){var e=this;this.appFiles.map(function(){var n=(0,d.Z)(function*(r){const s=yield(yield fetch(r.url)).arrayBuffer();e.files?.push(new File([s],e.appFilePrefix+"-"+r.appFileId.toString()))});return function(r){return n.apply(this,arguments)}}())}static#t=this.\u0275fac=function(n){return new(n||F)};static#e=this.\u0275cmp=t.Xpm({type:F,selectors:[["app-add-images"]],inputs:{files:"files",appFiles:"appFiles"},outputs:{removeFileEvent:"removeFileEvent",addFilesEvent:"addFilesEvent"},features:[t.TTD],decls:4,vars:2,consts:[[3,"accept","change"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed"]],template:function(n,r){1&n&&(t.TgZ(0,"ngx-dropzone",0),t.NdJ("change",function(s){return r.onSelectFile(s)}),t.TgZ(1,"ngx-dropzone-label"),t._uU(2,"Haga click o arrastre hasta aqu\xed para a\xf1adir archivos"),t.qZA(),t.YNc(3,Vt,1,2,"ngx-dropzone-image-preview",1),t.qZA()),2&n&&(t.Q6J("accept","image/*"),t.xp6(3),t.Q6J("ngForOf",r.files))},dependencies:[m.sg,A._f,A.NP,A.sv]})}function jt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",3)(1,"label",14),t._uU(2),t.qZA(),t.TgZ(3,"div",15)(4,"input",16),t.NdJ("change",function(i){const l=t.CHM(n).$implicit,a=t.oxw(3);return t.KtG(a.onChangeParameterValue(i,l))}),t.qZA(),t.TgZ(5,"fa-icon",17),t.NdJ("click",function(){const s=t.CHM(n).$implicit,l=t.oxw(3);return t.KtG(l.onDeleteParameter(s))}),t.qZA()()()}if(2&o){const n=e.$implicit,r=t.oxw(3);t.xp6(1),t.Q6J("for","toolParameter-"+n.id),t.xp6(1),t.Oqu(n.name),t.xp6(2),t.Q6J("value",n.parameterValue),t.xp6(1),t.Q6J("icon",r.faTrash)}}function Bt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.onAddMoreParameters())}),t._uU(1," Agregar m\xe1s elementos "),t.qZA()}}function Kt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"app-add-parameter",19),t.NdJ("newParameterAddedEvent",function(i){t.CHM(n);const s=t.oxw(3);return t.KtG(s.onAddedNewParameter(i))})("cancelAddParameterEvent",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.onCancelAddMoreParameters())}),t.qZA()}if(2&o){const n=t.oxw(3);t.Q6J("existingParameters",n.toolParameters)("parametersToFilter",n.tool.toolParameters)}}function Wt(o,e){if(1&o&&(t.ynx(0),t.YNc(1,jt,6,4,"div",11),t.TgZ(2,"div",8),t.YNc(3,Bt,2,0,"button",12),t.YNc(4,Kt,1,2,"app-add-parameter",13),t.qZA(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",n.tool.toolParameters),t.xp6(2),t.Q6J("ngIf",!n.isAddingToolParameter),t.xp6(1),t.Q6J("ngIf",n.isAddingToolParameter)}}function Xt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",20)(1,"button",21),t._uU(2,"Guardar"),t.qZA(),t.TgZ(3,"button",22),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.onCancel())}),t._uU(4,"Cancelar"),t.qZA()()}if(2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("disabled",!n.editToolForm.valid)}}function te(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"form",1),t.NdJ("ngSubmit",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.editToolForm.valid&&i.onSubmit())}),t.TgZ(1,"div",2)(2,"div",3)(3,"label",4),t._uU(4,"Nombre"),t.qZA(),t._UZ(5,"input",5),t.qZA(),t.YNc(6,Wt,5,3,"ng-container",6),t.qZA(),t.TgZ(7,"div",7)(8,"h2",8),t._uU(9,"Im\xe1genes"),t.qZA(),t.TgZ(10,"app-add-images",9),t.NdJ("addFilesEvent",function(i){t.CHM(n);const s=t.oxw();return t.KtG(s.onAddFile(i))})("removeFileEvent",function(i){t.CHM(n);const s=t.oxw();return t.KtG(s.onDeleteFile(i))}),t.qZA()(),t.YNc(11,Xt,5,1,"div",10),t.qZA()}if(2&o){const n=t.oxw();t.Q6J("formGroup",n.editToolForm),t.xp6(6),t.Q6J("ngIf",n.tool.toolParameters),t.xp6(4),t.Q6J("appFiles",n.tool.files),t.xp6(1),t.Q6J("ngIf",!n.isAddingToolParameter)}}class w{constructor(e,n){this.fb=e,this.httpService=n,this.isAddingToolParameter=!1,this.faTrash=h.$aW,this.deletedFileIds=[],this.addedFiles=[],this.updatedToolEvent=new t.vpe,this.cancelUpdateToolEvent=new t.vpe}ngOnInit(){this.initForm()}initForm(){!this.tool||(this.editToolForm=this.fb.group({toolId:[this.tool.toolId,u.kI.required],toolName:[this.tool.toolName,u.kI.required]}))}onSubmit(){this.tool&&(this.tool.toolName=this.editToolForm?.controls.toolName.value,this.updatedToolEvent.emit({id:this.tool.toolId,name:this.tool.toolName,toolParameters:this.tool.toolParameters,deletedFileIds:this.deletedFileIds,addedFiles:this.addedFiles}))}onCancel(){this.cancelUpdateToolEvent.emit()}onAddMoreParameters(){this.isAddingToolParameter=!0,this.httpService.get(g.G8.toolParametersApi).subscribe(e=>this.toolParameters=e)}onAddedNewParameter(e){this.tool.toolParameters.push(e),this.isAddingToolParameter=!1}onCancelAddMoreParameters(){this.isAddingToolParameter=!1}onChangeParameterValue(e,n){if(!this.tool||!this.tool.toolParameters||!this.tool.toolParameters.length)return;const r=this.tool.toolParameters?.findIndex(i=>i.id==n.id);this.tool.toolParameters[r].parameterValue=e.target.value}onDeleteParameter(e){this.tool.toolParameters=this.tool.toolParameters.filter(n=>n.id!=e.id)}onAddFile(e){this.addedFiles.push(e)}onDeleteFile(e){!this.tool||!e.appFileId||this.deletedFileIds.push(e.appFileId)}static#t=this.\u0275fac=function(n){return new(n||w)(t.Y36(u.qu),t.Y36(y.O))};static#e=this.\u0275cmp=t.Xpm({type:w,selectors:[["app-edit-tool-form"]],inputs:{tool:"tool"},outputs:{updatedToolEvent:"updatedToolEvent",cancelUpdateToolEvent:"cancelUpdateToolEvent"},decls:1,vars:1,consts:[[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-3"],[1,"col-lg-6"],["for","toolName",1,"form-label"],["type","text","id","toolName","formControlName","toolName",1,"form-control"],[4,"ngIf"],[1,"row","mb-3"],[1,"text-center"],[3,"appFiles","addFilesEvent","removeFileEvent"],["class","text-end",4,"ngIf"],["class","col-lg-6",4,"ngFor","ngForOf"],["class","btn btn-outline-primary","type","button",3,"click",4,"ngIf"],[3,"existingParameters","parametersToFilter","newParameterAddedEvent","cancelAddParameterEvent",4,"ngIf"],[1,"form-label",3,"for"],[1,"parameter-box"],["type","text","name","'toolParameter-' + toolParameter.id",1,"form-control",3,"value","change"],["role","button",3,"icon","click"],["type","button",1,"btn","btn-outline-primary",3,"click"],[3,"existingParameters","parametersToFilter","newParameterAddedEvent","cancelAddParameterEvent"],[1,"text-end"],["type","submit",1,"btn","btn-outline-primary",3,"disabled"],["type","button",1,"btn","btn-outline-danger","ms-3",3,"click"]],template:function(n,r){1&n&&t.YNc(0,te,12,4,"form",0),2&n&&t.Q6J("ngIf",r.editToolForm)},dependencies:[m.sg,m.O5,Z.BN,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,qt.d,F],styles:[".parameter-box[_ngcontent-%COMP%]{display:flex;align-items:center;padding-right:.75rem;border:1px solid #ced4da;border-radius:.375rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.parameter-box[_ngcontent-%COMP%]:focus-within{box-shadow:0 0 0 .25rem #0d6efd40}.parameter-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none}.parameter-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{box-shadow:none}.parameter-box[_ngcontent-%COMP%]   fa-icon[_ngcontent-%COMP%]{color:#dc3545}"]})}var z=p(8246);function ee(o,e){if(o.match(/^[a-z]+:\/\//i))return o;if(o.match(/^\/\//))return window.location.protocol+o;if(o.match(/^[a-z]+:/i))return o;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),e&&(r.href=e),i.href=o,i.href}const oe=(()=>{let o=0;return()=>(o+=1,`u${`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4)}${o}`)})();function x(o){const e=[];for(let n=0,r=o.length;n<r;n++)e.push(o[n]);return e}function C(o,e){const r=(o.ownerDocument.defaultView||window).getComputedStyle(o).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function Ut(o,e={}){const n=e.width||function ne(o){const e=C(o,"border-left-width"),n=C(o,"border-right-width");return o.clientWidth+e+n}(o),r=e.height||function re(o){const e=C(o,"border-top-width"),n=C(o,"border-bottom-width");return o.clientHeight+e+n}(o);return{width:n,height:r}}function ie(){let o,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(o=parseInt(n,10),Number.isNaN(o)&&(o=1)),o||window.devicePixelRatio||1}const _=16384;function se(o){(o.width>_||o.height>_)&&(o.width>_&&o.height>_?o.width>o.height?(o.height*=_/o.width,o.width=_):(o.width*=_/o.height,o.height=_):o.width>_?(o.height*=_/o.width,o.width=_):(o.width*=_/o.height,o.height=_))}function le(o,e={}){return new Promise(o.toBlob?n=>{o.toBlob(n,e.type?e.type:"image/png",e.quality?e.quality:1)}:n=>{const r=window.atob(o.toDataURL(e.type?e.type:void 0,e.quality?e.quality:void 0).split(",")[1]),i=r.length,s=new Uint8Array(i);for(let l=0;l<i;l+=1)s[l]=r.charCodeAt(l);n(new Blob([s],{type:e.type?e.type:"image/png"}))})}function E(o){return new Promise((e,n)=>{const r=new Image;r.decode=()=>e(r),r.onload=()=>e(r),r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=o})}function ae(o){return V.apply(this,arguments)}function V(){return(V=(0,d.Z)(function*(o){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(o)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)})).apply(this,arguments)}function ce(o,e,n){return j.apply(this,arguments)}function j(){return(j=(0,d.Z)(function*(o,e,n){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${e}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${e} ${n}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),i.appendChild(s),s.appendChild(o),ae(i)})).apply(this,arguments)}const f=(o,e)=>{if(o instanceof e)return!0;const n=Object.getPrototypeOf(o);return null!==n&&(n.constructor.name===e.name||f(n,e))};function Ot(o,e,n){const r=window.getComputedStyle(o,n),i=r.getPropertyValue("content");if(""===i||"none"===i)return;const s=oe();try{e.className=`${e.className} ${s}`}catch{return}const l=document.createElement("style");l.appendChild(function pe(o,e,n){const r=`.${o}:${e}`,i=n.cssText?function ue(o){const e=o.getPropertyValue("content");return`${o.cssText} content: '${e.replace(/'|"/g,"")}';`}(n):function de(o){return x(o).map(e=>`${e}: ${o.getPropertyValue(e)}${o.getPropertyPriority(e)?" !important":""};`).join(" ")}(n);return document.createTextNode(`${r}{${i}}`)}(s,n,r)),e.appendChild(l)}const Nt="application/font-woff",Jt="image/jpeg",fe={woff:Nt,woff2:Nt,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Jt,jpeg:Jt,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function B(o){const e=function _e(o){const e=/\.([^./]*?)$/g.exec(o);return e?e[1]:""}(o).toLowerCase();return fe[e]||""}function ge(o){return o.split(/,/)[1]}function K(o){return-1!==o.search(/^(data:)/)}function Mt(o,e){return`data:${e};base64,${o}`}function Rt(o,e,n){return W.apply(this,arguments)}function W(){return(W=(0,d.Z)(function*(o,e,n){const r=yield fetch(o,e);if(404===r.status)throw new Error(`Resource "${r.url}" not found`);const i=yield r.blob();return new Promise((s,l)=>{const a=new FileReader;a.onerror=l,a.onloadend=()=>{try{s(n({res:r,result:a.result}))}catch(c){l(c)}},a.readAsDataURL(i)})})).apply(this,arguments)}const X={};function he(o,e,n){let r=o.replace(/\?.*/,"");return n&&(r=o),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}function tt(o,e,n){return et.apply(this,arguments)}function et(){return(et=(0,d.Z)(function*(o,e,n){const r=he(o,e,n.includeQueryParams);if(null!=X[r])return X[r];let i;n.cacheBust&&(o+=(/\?/.test(o)?"&":"?")+(new Date).getTime());try{i=Mt(yield Rt(o,n.fetchRequestInit,({res:l,result:a})=>(e||(e=l.headers.get("Content-Type")||""),ge(a))),e)}catch(s){i=n.imagePlaceholder||"";let l=`Failed to fetch resource: ${o}`;s&&(l="string"==typeof s?s:s.message),l&&console.warn(l)}return X[r]=i,i})).apply(this,arguments)}function Te(o){return ot.apply(this,arguments)}function ot(){return(ot=(0,d.Z)(function*(o){const e=o.toDataURL();return"data:,"===e?o.cloneNode(!1):E(e)})).apply(this,arguments)}function xe(o,e){return nt.apply(this,arguments)}function nt(){return(nt=(0,d.Z)(function*(o,e){if(o.currentSrc){const s=document.createElement("canvas"),l=s.getContext("2d");return s.width=o.clientWidth,s.height=o.clientHeight,l?.drawImage(o,0,0,s.width,s.height),E(s.toDataURL())}const n=o.poster,r=B(n);return E(yield tt(n,r,e))})).apply(this,arguments)}function ve(o){return rt.apply(this,arguments)}function rt(){return(rt=(0,d.Z)(function*(o){var e;try{if(null!==(e=o?.contentDocument)&&void 0!==e&&e.body)return yield I(o.contentDocument.body,{},!0)}catch{}return o.cloneNode(!1)})).apply(this,arguments)}function be(o,e){return it.apply(this,arguments)}function it(){return(it=(0,d.Z)(function*(o,e){return f(o,HTMLCanvasElement)?Te(o):f(o,HTMLVideoElement)?xe(o,e):f(o,HTMLIFrameElement)?ve(o):o.cloneNode(!1)})).apply(this,arguments)}const ye=o=>null!=o.tagName&&"SLOT"===o.tagName.toUpperCase();function Ae(o,e,n){return st.apply(this,arguments)}function st(){return(st=(0,d.Z)(function*(o,e,n){var r,i;let s=[];return s=ye(o)&&o.assignedNodes?x(o.assignedNodes()):f(o,HTMLIFrameElement)&&(null===(r=o.contentDocument)||void 0===r?void 0:r.body)?x(o.contentDocument.body.childNodes):x((null!==(i=o.shadowRoot)&&void 0!==i?i:o).childNodes),0===s.length||f(o,HTMLVideoElement)||(yield s.reduce((l,a)=>l.then(()=>I(a,n)).then(c=>{c&&e.appendChild(c)}),Promise.resolve())),e})).apply(this,arguments)}function Ce(o,e){return f(e,Element)&&(function Ze(o,e){const n=e.style;if(!n)return;const r=window.getComputedStyle(o);r.cssText?(n.cssText=r.cssText,n.transformOrigin=r.transformOrigin):x(r).forEach(i=>{let s=r.getPropertyValue(i);"font-size"===i&&s.endsWith("px")&&(s=Math.floor(parseFloat(s.substring(0,s.length-2)))-.1+"px"),f(o,HTMLIFrameElement)&&"display"===i&&"inline"===s&&(s="block"),"d"===i&&e.getAttribute("d")&&(s=`path(${e.getAttribute("d")})`),n.setProperty(i,s,r.getPropertyPriority(i))})}(o,e),function me(o,e){Ot(o,e,":before"),Ot(o,e,":after")}(o,e),function Fe(o,e){f(o,HTMLTextAreaElement)&&(e.innerHTML=o.value),f(o,HTMLInputElement)&&e.setAttribute("value",o.value)}(o,e),function we(o,e){if(f(o,HTMLSelectElement)){const r=Array.from(e.children).find(i=>o.value===i.getAttribute("value"));r&&r.setAttribute("selected","")}}(o,e)),e}function Ee(o,e){return lt.apply(this,arguments)}function lt(){return(lt=(0,d.Z)(function*(o,e){const n=o.querySelectorAll?o.querySelectorAll("use"):[];if(0===n.length)return o;const r={};for(let s=0;s<n.length;s++){const a=n[s].getAttribute("xlink:href");if(a){const c=o.querySelector(a),T=document.querySelector(a);!c&&T&&!r[a]&&(r[a]=yield I(T,e,!0))}}const i=Object.values(r);if(i.length){const s="http://www.w3.org/1999/xhtml",l=document.createElementNS(s,"svg");l.setAttribute("xmlns",s),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const a=document.createElementNS(s,"defs");l.appendChild(a);for(let c=0;c<i.length;c++)a.appendChild(i[c]);o.appendChild(l)}return o})).apply(this,arguments)}function I(o,e,n){return at.apply(this,arguments)}function at(){return(at=(0,d.Z)(function*(o,e,n){return n||!e.filter||e.filter(o)?Promise.resolve(o).then(r=>be(r,e)).then(r=>Ae(o,r,e)).then(r=>Ce(o,r)).then(r=>Ee(r,e)):null})).apply(this,arguments)}const Lt=/url\((['"]?)([^'"]+?)\1\)/g,Ie=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Se=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Pe(o){const e=o.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function qe(o){const e=[];return o.replace(Lt,(n,r,i)=>(e.push(i),n)),e.filter(n=>!K(n))}function Ue(o,e,n,r,i){return ct.apply(this,arguments)}function ct(){return(ct=(0,d.Z)(function*(o,e,n,r,i){try{const s=n?ee(e,n):e,l=B(e);let a;return a=i?Mt(yield i(s),l):yield tt(s,l,r),o.replace(Pe(e),`$1${a}$3`)}catch{}return o})).apply(this,arguments)}function Oe(o,{preferredFontFormat:e}){return e?o.replace(Se,n=>{for(;;){const[r,,i]=Ie.exec(n)||[];if(!i)return"";if(i===e)return`src: ${r};`}}):o}function Qt(o){return-1!==o.search(Lt)}function kt(o,e,n){return ut.apply(this,arguments)}function ut(){return(ut=(0,d.Z)(function*(o,e,n){if(!Qt(o))return o;const r=Oe(o,n);return qe(r).reduce((s,l)=>s.then(a=>Ue(a,l,e,n)),Promise.resolve(r))})).apply(this,arguments)}function S(o,e,n){return dt.apply(this,arguments)}function dt(){return(dt=(0,d.Z)(function*(o,e,n){var r;const i=null===(r=e.style)||void 0===r?void 0:r.getPropertyValue(o);if(i){const s=yield kt(i,null,n);return e.style.setProperty(o,s,e.style.getPropertyPriority(o)),!0}return!1})).apply(this,arguments)}function Ne(o,e){return pt.apply(this,arguments)}function pt(){return(pt=(0,d.Z)(function*(o,e){(yield S("background",o,e))||(yield S("background-image",o,e)),(yield S("mask",o,e))||(yield S("mask-image",o,e))})).apply(this,arguments)}function Je(o,e){return mt.apply(this,arguments)}function mt(){return(mt=(0,d.Z)(function*(o,e){const n=f(o,HTMLImageElement);if((!n||K(o.src))&&(!f(o,SVGImageElement)||K(o.href.baseVal)))return;const r=n?o.src:o.href.baseVal,i=yield tt(r,B(r),e);yield new Promise((s,l)=>{o.onload=s,o.onerror=l;const a=o;a.decode&&(a.decode=s),"lazy"===a.loading&&(a.loading="eager"),n?(o.srcset="",o.src=i):o.href.baseVal=i})})).apply(this,arguments)}function Me(o,e){return ft.apply(this,arguments)}function ft(){return(ft=(0,d.Z)(function*(o,e){const r=x(o.childNodes).map(i=>$t(i,e));yield Promise.all(r).then(()=>o)})).apply(this,arguments)}function $t(o,e){return _t.apply(this,arguments)}function _t(){return(_t=(0,d.Z)(function*(o,e){f(o,Element)&&(yield Ne(o,e),yield Je(o,e),yield Me(o,e))})).apply(this,arguments)}function Re(o,e){const{style:n}=o;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return null!=r&&Object.keys(r).forEach(i=>{n[i]=r[i]}),o}const Gt={};function Yt(o){return gt.apply(this,arguments)}function gt(){return(gt=(0,d.Z)(function*(o){let e=Gt[o];return null!=e||(e={url:o,cssText:yield(yield fetch(o)).text()},Gt[o]=e),e})).apply(this,arguments)}function Dt(o,e){return ht.apply(this,arguments)}function ht(){return ht=(0,d.Z)(function*(o,e){let n=o.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,s=(n.match(/url\([^)]+\)/g)||[]).map(function(){var l=(0,d.Z)(function*(a){let c=a.replace(r,"$1");return c.startsWith("https://")||(c=new URL(c,o.url).href),Rt(c,e.fetchRequestInit,({result:T})=>(n=n.replace(a,`url(${T})`),[a,T]))});return function(a){return l.apply(this,arguments)}}());return Promise.all(s).then(()=>n)}),ht.apply(this,arguments)}function Ht(o){if(null==o)return[];const e=[];let r=o.replace(/(\/\*[\s\S]*?\*\/)/gi,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=i.exec(r);if(null===c)break;e.push(c[0])}r=r.replace(i,"");const s=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,a=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let c=s.exec(r);if(null===c){if(c=a.exec(r),null===c)break;s.lastIndex=a.lastIndex}else a.lastIndex=s.lastIndex;e.push(c[0])}return e}function Le(o,e){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,d.Z)(function*(o,e){const n=[],r=[];return o.forEach(i=>{if("cssRules"in i)try{x(i.cssRules||[]).forEach((s,l)=>{if(s.type===CSSRule.IMPORT_RULE){let a=l+1;const T=Yt(s.href).then(v=>Dt(v,e)).then(v=>Ht(v).forEach(St=>{try{i.insertRule(St,St.startsWith("@import")?a+=1:i.cssRules.length)}catch(wo){console.error("Error inserting rule from remote css",{rule:St,error:wo})}})).catch(v=>{console.error("Error loading remote css",v.toString())});r.push(T)}})}catch(s){const l=o.find(a=>null==a.href)||document.styleSheets[0];null!=i.href&&r.push(Yt(i.href).then(a=>Dt(a,e)).then(a=>Ht(a).forEach(c=>{l.insertRule(c,i.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",s)}}),Promise.all(r).then(()=>(o.forEach(i=>{if("cssRules"in i)try{x(i.cssRules||[]).forEach(s=>{n.push(s)})}catch(s){console.error(`Error while reading CSS rules from ${i.href}`,s)}}),n))})).apply(this,arguments)}function Qe(o){return o.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>Qt(e.style.getPropertyValue("src")))}function ke(o,e){return xt.apply(this,arguments)}function xt(){return(xt=(0,d.Z)(function*(o,e){if(null==o.ownerDocument)throw new Error("Provided element is not within a Document");const n=x(o.ownerDocument.styleSheets);return Qe(yield Le(n,e))})).apply(this,arguments)}function $e(o,e){return vt.apply(this,arguments)}function vt(){return(vt=(0,d.Z)(function*(o,e){const n=yield ke(o,e);return(yield Promise.all(n.map(i=>kt(i.cssText,i.parentStyleSheet?i.parentStyleSheet.href:null,e)))).join("\n")})).apply(this,arguments)}function Ge(o,e){return bt.apply(this,arguments)}function bt(){return(bt=(0,d.Z)(function*(o,e){const n=null!=e.fontEmbedCSS?e.fontEmbedCSS:e.skipFonts?null:yield $e(o,e);if(n){const r=document.createElement("style"),i=document.createTextNode(n);r.appendChild(i),o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r)}})).apply(this,arguments)}function Ye(o){return yt.apply(this,arguments)}function yt(){return(yt=(0,d.Z)(function*(o,e={}){const{width:n,height:r}=Ut(o,e),i=yield I(o,e,!0);return yield Ge(i,e),yield $t(i,e),Re(i,e),yield ce(i,n,r)})).apply(this,arguments)}function P(o){return At.apply(this,arguments)}function At(){return(At=(0,d.Z)(function*(o,e={}){const{width:n,height:r}=Ut(o,e),i=yield Ye(o,e),s=yield E(i),l=document.createElement("canvas"),a=l.getContext("2d"),c=e.pixelRatio||ie(),T=e.canvasWidth||n,v=e.canvasHeight||r;return l.width=T*c,l.height=v*c,e.skipAutoScale||se(l),l.style.width=`${T}`,l.style.height=`${v}`,e.backgroundColor&&(a.fillStyle=e.backgroundColor,a.fillRect(0,0,l.width,l.height)),a.drawImage(s,0,0,l.width,l.height),l})).apply(this,arguments)}function Ct(){return(Ct=(0,d.Z)(function*(o,e={}){const n=yield P(o,e);return yield le(n)})).apply(this,arguments)}var He=p(7185),It=p(7129);class q{constructor(e){this.toastrService=e,this.qrCodeElementType=z.TT.IMG,this.qrCodeErrorCorrectionLevel=z.Jk.HIGH,this.faImage=h.VmB,this.faSave=h.r6l}copyOrSaveQRInfo(e=!0){var n=this;return(0,d.Z)(function*(){const r=document.getElementById("tool-qr-info"),i=r.firstChild;i.innerHTML=n.tool.toolName;const s=yield function De(o){return Ct.apply(this,arguments)}(r,{backgroundColor:"white"});e?yield navigator.clipboard.write([new ClipboardItem({"image/png":s})]):n.saveQrInfo(s),i.innerHTML="C\xf3digo QR",n.toastrService.success("Imagen copiada al portapapeles")})()}saveQrInfo(e){var n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=`${this.tool.toolName}.png`,r.click(),r.remove()}static#t=this.\u0275fac=function(n){return new(n||q)(t.Y36(He._W))};static#e=this.\u0275cmp=t.Xpm({type:q,selectors:[["app-qr-info"]],inputs:{tool:"tool"},decls:15,vars:8,consts:[["id","tool-qr-info"],[1,"text-center","tool-qr-info--name"],[1,"qr-card"],[1,"text-center",3,"elementType","value","errorCorrectionLevel"],[1,"text-center"],[1,"d-flex","justify-content-center"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[3,"icon"],[1,"btn","btn-sm","btn-outline-primary","ms-2",3,"click"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"C\xf3digo QR"),t.qZA(),t.TgZ(3,"div",2),t._UZ(4,"ngx-qrcode",3),t.TgZ(5,"p",4),t._uU(6),t.ALo(7,"lastCharacters"),t.qZA()()(),t.TgZ(8,"div",5)(9,"button",6),t.NdJ("click",function(){return r.copyOrSaveQRInfo()}),t._uU(10,"Copiar "),t._UZ(11,"fa-icon",7),t.qZA(),t.TgZ(12,"button",8),t.NdJ("click",function(){return r.copyOrSaveQRInfo(!1)}),t._uU(13,"Guardar "),t._UZ(14,"fa-icon",7),t.qZA()()),2&n&&(t.xp6(4),t.Q6J("elementType",r.qrCodeElementType)("value",r.tool.toolGuid)("errorCorrectionLevel",r.qrCodeErrorCorrectionLevel),t.xp6(2),t.Oqu(t.lcZ(7,6,r.tool.toolGuid)),t.xp6(5),t.Q6J("icon",r.faImage),t.xp6(3),t.Q6J("icon",r.faSave))},dependencies:[Z.BN,z.zF,It.$]})}function ze(o,e){if(1&o&&(t.TgZ(0,"div",10)(1,"p")(2,"b"),t._uU(3),t.qZA(),t._uU(4),t.qZA()()),2&o){const n=e.$implicit;t.xp6(3),t.hij("",n.name,":"),t.xp6(1),t.hij(" ",n.measurementUnitSymbol?n.parameterValue+" | "+n.measurementUnitSymbol:n.parameterValue,"")}}function Ve(o,e){1&o&&t._UZ(0,"app-image-thumbnail",17),2&o&&t.Q6J("appFile",e.$implicit)}function je(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"div",10)(3,"p")(4,"b"),t._uU(5,"Nombre:"),t.qZA(),t._uU(6),t.qZA()(),t.TgZ(7,"div",10)(8,"p")(9,"b"),t._uU(10,"Estado:"),t.qZA(),t._uU(11),t.qZA()(),t.YNc(12,ze,5,2,"div",11),t.qZA(),t.TgZ(13,"div",12)(14,"h2",7),t._uU(15,"Im\xe1genes"),t.qZA(),t.TgZ(16,"div",13),t.YNc(17,Ve,1,1,"app-image-thumbnail",14),t.qZA()(),t.TgZ(18,"div",15)(19,"button",16),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.setUpdatingTool(!0))}),t._uU(20,"Editar herramienta"),t.qZA()(),t.BQk()}if(2&o){const n=t.oxw(2);t.xp6(6),t.hij(" ",n.tool.toolName,""),t.xp6(5),t.hij(" ",n.tool.toolState.toolStateName,""),t.xp6(1),t.Q6J("ngForOf",n.tool.toolParameters),t.xp6(5),t.Q6J("ngForOf",n.tool.files)}}function Be(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"app-edit-tool-form",18),t.NdJ("cancelUpdateToolEvent",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.setUpdatingTool(!1))})("updatedToolEvent",function(i){t.CHM(n);const s=t.oxw(2);return t.KtG(s.onToolUpdated(i))}),t.qZA()}if(2&o){const n=t.oxw(2);t.Q6J("tool",n.tool)}}function Ke(o,e){if(1&o&&(t.TgZ(0,"div",1)(1,"h1",2),t._uU(2),t.qZA(),t.TgZ(3,"div",3)(4,"div",4),t._UZ(5,"app-qr-info",5),t.qZA(),t.TgZ(6,"div",6)(7,"h2",7),t._uU(8,"Informaci\xf3n general"),t.qZA(),t.YNc(9,je,21,4,"ng-container",8),t.YNc(10,Be,1,1,"app-edit-tool-form",9),t.qZA()()()),2&o){const n=t.oxw();t.xp6(2),t.Oqu(n.tool.toolName),t.xp6(3),t.Q6J("tool",n.tool),t.xp6(4),t.Q6J("ngIf",!n.updatingTool),t.xp6(1),t.Q6J("ngIf",n.updatingTool)}}class U{constructor(e,n){this.route=e,this.httpService=n,this.updatingTool=!1}ngOnInit(){this.getTool()}getTool(){const e=this.route.snapshot.paramMap.get("id");this.httpService.get(`${g.G8.toolsApi}/${e}`).subscribe(n=>this.tool=n)}setUpdatingTool(e){this.updatingTool=e}onToolUpdated(e){const n=new FormData;n.append("id",e.id.toString()),n.append("name",e.name),n.append("toolParameters",JSON.stringify(e.toolParameters)),n.append("deletedFileIds",e.deletedFileIds.length?e.deletedFileIds.toString():"[]"),e.addedFiles.map(r=>n.append("addedFiles",r)),this.httpService.put(g.G8.toolsApi,n).subscribe(r=>{this.tool=r,this.updatingTool=!1})}static#t=this.\u0275fac=function(n){return new(n||U)(t.Y36(b.gz),t.Y36(y.O))};static#e=this.\u0275cmp=t.Xpm({type:U,selectors:[["app-tool-detail"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"text-center","mt-3"],[1,"row","mt-3"],[1,"col-sm-4"],[3,"tool"],[1,"col-sm-8"],[1,"text-center"],[4,"ngIf"],[3,"tool","cancelUpdateToolEvent","updatedToolEvent",4,"ngIf"],[1,"col-sm-6"],["class","col-sm-6",4,"ngFor","ngForOf"],[1,"row-mt-3"],[1,"d-flex","gap-2"],[3,"appFile",4,"ngFor","ngForOf"],[1,"mt-3"],["type","button",1,"btn","btn-outline-primary",3,"click"],[3,"appFile"],[3,"tool","cancelUpdateToolEvent","updatedToolEvent"]],template:function(n,r){1&n&&t.YNc(0,Ke,11,4,"div",0),2&n&&t.Q6J("ngIf",r.tool)},dependencies:[m.sg,m.O5,zt.w,w,q]})}var O=p(9453);function We(o,e){if(1&o&&(t.TgZ(0,"form",9)(1,"div",10)(2,"label",11),t._uU(3,"Nombre"),t.qZA(),t._UZ(4,"input",12),t.qZA()()),2&o){const n=t.oxw();t.Q6J("formGroup",n.addToolForm)}}class N{constructor(e,n,r){this.activeModal=e,this.fb=n,this.httpService=r,this.toolAddedEvent=new t.vpe}ngOnInit(){this.initForm()}initForm(){this.addToolForm=this.fb.group({toolName:["",u.kI.required]})}onSubmit(){this.httpService.post("Tools",{toolName:this.addToolForm?.controls.toolName.value}).subscribe(()=>this.activeModal.close(!0))}static#t=this.\u0275fac=function(n){return new(n||N)(t.Y36(O.Kz),t.Y36(u.qu),t.Y36(y.O))};static#e=this.\u0275cmp=t.Xpm({type:N,selectors:[["app-add-tool-modal"]],outputs:{toolAddedEvent:"toolAddedEvent"},decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"btn","btn-outline-primary",3,"disabled","click"],[3,"formGroup"],[1,"mb-3"],["for","toolName",1,"form-label"],["type","text","id","toolName","formControlName","toolName",1,"form-control"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Agregar Nueva herramienta"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return r.activeModal.close(!1)}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4),t.YNc(7,We,5,1,"form",5),t.qZA(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return r.activeModal.close(!1)}),t._uU(10,"Cancelar"),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){return r.addToolForm.valid&&r.onSubmit()}),t._uU(12,"Guardar"),t.qZA()()),2&n&&(t.xp6(7),t.Q6J("ngIf",r.addToolForm),t.xp6(4),t.Q6J("disabled",!r.addToolForm.valid))},dependencies:[m.O5,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u]})}var Xe=p(1875);function to(o,e){1&o&&(t.TgZ(0,"p"),t._uU(1,"No hay herramientas seleccionadas"),t.qZA())}function eo(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"lastCharacters"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._UZ(7,"fa-icon",4),t.TgZ(8,"fa-icon",5),t.NdJ("click",function(){const s=t.CHM(n).$implicit,l=t.oxw(2);return t.KtG(l.onDeleteTool(s))}),t.qZA()()()}if(2&o){const n=e.$implicit,r=t.oxw(2);t.xp6(2),t.Oqu(t.xi3(3,4,n.toolGuid,6)),t.xp6(3),t.Oqu(n.toolName),t.xp6(2),t.Q6J("icon",r.faCircleInfo),t.xp6(1),t.Q6J("icon",r.faTrash)}}function oo(o,e){if(1&o&&(t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th"),t._uU(4,"Id"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Nombre"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Acciones"),t.qZA()()(),t.TgZ(9,"tbody"),t.YNc(10,eo,9,7,"tr",3),t.qZA()()),2&o){const n=t.oxw();t.xp6(10),t.Q6J("ngForOf",n.tools)}}class J{constructor(){this.faTrash=h.$aW,this.faCircleInfo=h.DBf,this.deleteToolEvent=new t.vpe}onDeleteTool(e){this.deleteToolEvent.emit(e)}static#t=this.\u0275fac=function(n){return new(n||J)};static#e=this.\u0275cmp=t.Xpm({type:J,selectors:[["app-selected-tools-list"]],inputs:{tools:"tools"},outputs:{deleteToolEvent:"deleteToolEvent"},decls:2,vars:2,consts:[[4,"ngIf"],["class","table",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],["role","button",1,"me-2",3,"icon"],["role","button",1,"text-danger",3,"icon","click"]],template:function(n,r){1&n&&(t.YNc(0,to,2,0,"p",0),t.YNc(1,oo,11,1,"table",1)),2&n&&(t.Q6J("ngIf",!r.tools||r.tools&&!r.tools.length),t.xp6(1),t.Q6J("ngIf",r.tools&&r.tools.length))},dependencies:[m.sg,m.O5,Z.BN,It.$]})}function no(o,e){1&o&&(t.TgZ(0,"p"),t._uU(1,"No hay herramientas disponibles"),t.qZA())}function ro(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"lastCharacters"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._UZ(7,"fa-icon",4),t.TgZ(8,"fa-icon",5),t.NdJ("click",function(){const s=t.CHM(n).$implicit,l=t.oxw(2);return t.KtG(l.onSelectTool(s))}),t.qZA()()()}if(2&o){const n=e.$implicit,r=t.oxw(2);t.xp6(2),t.Oqu(t.xi3(3,4,n.toolGuid,6)),t.xp6(3),t.Oqu(n.toolName),t.xp6(2),t.Q6J("icon",r.faCircleInfo),t.xp6(1),t.Q6J("icon",r.faPlus)}}function io(o,e){if(1&o&&(t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th"),t._uU(4,"Id"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Nombre"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Acciones"),t.qZA()()(),t.TgZ(9,"tbody"),t.YNc(10,ro,9,7,"tr",3),t.qZA()()),2&o){const n=t.oxw();t.xp6(10),t.Q6J("ngForOf",n.tools)}}class M{constructor(){this.faPlus=h.r8p,this.faCircleInfo=h.DBf,this.selectToolEvent=new t.vpe}onSelectTool(e){this.selectToolEvent.emit(e)}static#t=this.\u0275fac=function(n){return new(n||M)};static#e=this.\u0275cmp=t.Xpm({type:M,selectors:[["app-available-tools-list"]],inputs:{tools:"tools"},outputs:{selectToolEvent:"selectToolEvent"},decls:2,vars:2,consts:[[4,"ngIf"],["class","table",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],["role","button",1,"me-2",3,"icon"],["role","button",1,"text-primary",3,"icon","click"]],template:function(n,r){1&n&&(t.YNc(0,no,2,0,"p",0),t.YNc(1,io,11,1,"table",1)),2&n&&(t.Q6J("ngIf",r.tools&&!r.tools.length),t.xp6(1),t.Q6J("ngIf",r.tools&&r.tools.length))},dependencies:[m.sg,m.O5,Z.BN,It.$]})}var so=p(7281);function lo(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",15)(1,"div",12)(2,"label",16),t._uU(3,"Responsable"),t.qZA(),t.TgZ(4,"app-dropdown",17),t.NdJ("onSelectOptionEvent",function(i){t.CHM(n);const s=t.oxw(2);return t.KtG(s.onSelectResponsible(i))}),t.ALo(5,"toDropdownItem"),t.qZA()()()}if(2&o){const n=t.oxw(2);t.xp6(4),t.Q6J("options",t.xi3(5,1,n.employees,"user"))}}function ao(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"form",9),t.YNc(1,lo,6,4,"div",10),t.TgZ(2,"div",11)(3,"div",12)(4,"h5"),t._uU(5,"Herramientas seleccionadas"),t.qZA(),t.TgZ(6,"app-selected-tools-list",13),t.NdJ("deleteToolEvent",function(i){t.CHM(n);const s=t.oxw();return t.KtG(s.onDeleteTool(i))}),t.qZA()()(),t.TgZ(7,"div",11)(8,"div",12)(9,"h5"),t._uU(10,"Listado de herramientas"),t.qZA(),t.TgZ(11,"app-available-tools-list",14),t.NdJ("selectToolEvent",function(i){t.CHM(n);const s=t.oxw();return t.KtG(s.onSelectTool(i))}),t.qZA()()()()}if(2&o){const n=t.oxw();t.Q6J("formGroup",n.registerOutputForm),t.xp6(1),t.Q6J("ngIf",n.employees),t.xp6(5),t.Q6J("tools",n.selectedTools),t.xp6(5),t.Q6J("tools",n.availableTools)}}class R{constructor(e,n,r){this.activeModal=e,this.httpService=n,this.fb=r,this.availableTools=[],this.selectedTools=[]}ngOnInit(){this.initForm(),this.getEmployees(),this.getTools()}getEmployees(){this.httpService.get("Users/employees").subscribe(e=>this.employees=e)}getTools(){this.httpService.get("Tools/available-tools").subscribe(e=>this.availableTools=e)}onSelectTool(e){this.availableTools=this.availableTools?.filter(n=>n.toolId!=e.toolId),this.selectedTools?.push(e),this.registerOutputForm.controls.tools.patchValue(this.selectedTools)}onDeleteTool(e){this.selectedTools=this.selectedTools.filter(n=>n.toolId!=e.toolId),this.availableTools.push(e),this.registerOutputForm.controls.tools.patchValue(this.selectedTools)}initForm(){this.registerOutputForm=this.fb.group({responsible:[null,u.kI.required],tools:[null,u.kI.required]})}registerOutput(){this.httpService.post(g.G8.toolOutputsApi,this.registerOutputForm?.value).subscribe(()=>this.activeModal.close(!0))}onSelectResponsible(e){this.responsible=this.employees.find(n=>n.userId==e.id),this.registerOutputForm.controls.responsible.setValue({...this.responsible})}static#t=this.\u0275fac=function(n){return new(n||R)(t.Y36(O.Kz),t.Y36(y.O),t.Y36(u.qu))};static#e=this.\u0275cmp=t.Xpm({type:R,selectors:[["app-add-tools-output-modal"]],decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"btn","btn-outline-primary","ms-2",3,"disabled","click"],[3,"formGroup"],["class","row",4,"ngIf"],[1,"row","mt-3"],[1,"col"],[3,"tools","deleteToolEvent"],[3,"tools","selectToolEvent"],[1,"row"],["for","responsible",1,"form-label"],[1,"d-block",3,"options","onSelectOptionEvent"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Registrar nueva salida"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return r.activeModal.close()}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4),t.YNc(7,ao,12,4,"form",5),t.qZA(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return r.activeModal.close()}),t._uU(10,"Cerrar"),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){return r.registerOutput()}),t._uU(12,"Guardar"),t.qZA()()),2&n&&(t.xp6(7),t.Q6J("ngIf",r.registerOutputForm),t.xp6(4),t.Q6J("disabled",!r.registerOutputForm.valid))},dependencies:[m.O5,u._Y,u.JL,u.sg,Xe.J,J,M,so.s]})}function co(o,e){1&o&&(t.TgZ(0,"p",5),t._uU(1,"No se han registrado usuarios a\xfan."),t.qZA())}const uo=function(o){return[o]};function po(o,e){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"a",8),t._UZ(7,"fa-icon",9),t.qZA()()()),2&o){const n=e.$implicit,r=t.oxw(3);t.xp6(2),t.hij(" ",n.toolName," "),t.xp6(2),t.hij(" ",n.toolState.toolStateName," "),t.xp6(2),t.Q6J("routerLink",t.VKq(4,uo,n.toolId)),t.xp6(1),t.Q6J("icon",r.faCircleInfo)}}function mo(o,e){if(1&o&&(t.TgZ(0,"table",6)(1,"thead")(2,"tr")(3,"th"),t._uU(4,"Nombre"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Estado"),t.qZA(),t._UZ(7,"th"),t.qZA()(),t.TgZ(8,"tbody"),t.YNc(9,po,8,6,"tr",7),t.qZA()()),2&o){const n=t.oxw(2);t.xp6(9),t.Q6J("ngForOf",n.tools)}}function fo(o,e){if(1&o&&(t.TgZ(0,"div",1)(1,"div",2),t.YNc(2,co,2,0,"p",3),t.YNc(3,mo,10,1,"table",4),t.qZA()()),2&o){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",!n.tools.length),t.xp6(1),t.Q6J("ngIf",n.tools.length)}}class L{constructor(){this.faPen=h.IwR,this.faTrash=h.$aW,this.faCircleInfo=h.DBf}static#t=this.\u0275fac=function(n){return new(n||L)};static#e=this.\u0275cmp=t.Xpm({type:L,selectors:[["app-tools-list"]],inputs:{tools:"tools"},decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col"],["class","text-center",4,"ngIf"],["class","table",4,"ngIf"],[1,"text-center"],[1,"table"],[4,"ngFor","ngForOf"],[3,"routerLink"],["role","button",1,"me-2","text-primary",3,"icon"]],template:function(n,r){1&n&&t.YNc(0,fo,4,2,"div",0),2&n&&t.Q6J("ngIf",r.tools)},dependencies:[m.sg,m.O5,b.rH,Z.BN]})}class Q{transform(e,...n){return 1==e.toolOutputStateId?"Abierto":"Cerrado"}static#t=this.\u0275fac=function(n){return new(n||Q)};static#e=this.\u0275pipe=t.Yjl({name:"outputToolState",type:Q,pure:!0})}function _o(o,e){1&o&&(t.TgZ(0,"p"),t._uU(1,"No hay salidas de herramienta registradas. "),t.qZA())}function go(o,e){if(1&o&&(t.TgZ(0,"tr")(1,"td")(2,"a",6),t._uU(3),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"outputToolState"),t.qZA()()),2&o){const n=e.$implicit,r=t.oxw(2);t.xp6(2),t.Q6J("routerLink","/"+r.routeConstants.toolOutput+"/"+n.toolOutputId),t.xp6(1),t.hij(" ",n.toolOutputId," "),t.xp6(2),t.Oqu(t.xi3(6,5,n.outputDateTime,"dd/MM/YYYY")),t.xp6(3),t.Oqu(n.responsible.name),t.xp6(2),t.hij(" ",t.lcZ(11,8,n.toolOutputState)," ")}}function ho(o,e){if(1&o&&(t.TgZ(0,"table",4)(1,"thead")(2,"tr")(3,"th"),t._uU(4," Id "),t.qZA(),t.TgZ(5,"th"),t._uU(6," Fecha de salida "),t.qZA(),t.TgZ(7,"th"),t._uU(8," Responsable "),t.qZA(),t.TgZ(9,"th"),t._uU(10," Estado "),t.qZA()()(),t.TgZ(11,"tbody"),t.YNc(12,go,12,10,"tr",5),t.qZA()()),2&o){const n=t.oxw();t.xp6(12),t.Q6J("ngForOf",n.toolOutputs)}}class k{constructor(){this.routeConstants=g.p7}static#t=this.\u0275fac=function(n){return new(n||k)};static#e=this.\u0275cmp=t.Xpm({type:k,selectors:[["app-tool-outputs-list"]],inputs:{toolOutputs:"toolOutputs"},decls:5,vars:2,consts:[[1,"row","mt-3"],[1,"col"],[4,"ngIf","ngIfElse"],["noToolsOutput",""],[1,"table","mt-4"],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(n,r){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,_o,2,0,"p",2),t.YNc(3,ho,13,1,"ng-template",null,3,t.W1O),t.qZA()()),2&n){const i=t.MAs(4);t.xp6(2),t.Q6J("ngIf",!r.toolOutputs||!r.toolOutputs.length)("ngIfElse",i)}},dependencies:[m.sg,m.O5,b.rH,m.uU,Q]})}class ${constructor(e,n){this.modalService=e,this.httpService=n,this.routeConstants=g.p7}ngOnInit(){this.getToolsList(),this.getToolOutputs()}onOpenAddToolModal(){this.modalRef=this.modalService.open(N),this.modalRef.closed.subscribe(e=>{e&&this.getToolsList()})}getToolsList(){this.httpService.get("Tools").subscribe(e=>this.tools=e)}getToolOutputs(){this.httpService.get(g.G8.toolOutputsApi).subscribe(e=>this.toolOutputs=e)}openAddToolOutputModal(){this.modalRef=this.modalService.open(R,{size:"lg",scrollable:!0}),this.modalRef.closed.subscribe(()=>this.getToolOutputs())}static#t=this.\u0275fac=function(n){return new(n||$)(t.Y36(O.FF),t.Y36(y.O))};static#e=this.\u0275cmp=t.Xpm({type:$,selectors:[["app-tools-management"]],decls:17,vars:3,consts:[[1,"container"],[1,"text-center","mt-3"],[3,"tools"],[1,"text-center"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"mt-5"],[3,"toolOutputs"],[1,"btn","btn-outline-primary",3,"click"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Administraci\xf3n de equipos y herramienta"),t.qZA(),t.TgZ(3,"section")(4,"h2",1),t._uU(5,"Inventario"),t.qZA(),t._UZ(6,"app-tools-list",2),t.TgZ(7,"div",3)(8,"a",4),t._uU(9,"Agregar nuevo elemento"),t.qZA()()(),t.TgZ(10,"section",5)(11,"h2",3),t._uU(12,"Salidas de herramienta"),t.qZA(),t._UZ(13,"app-tool-outputs-list",6),t.TgZ(14,"div",3)(15,"button",7),t.NdJ("click",function(){return r.openAddToolOutputModal()}),t._uU(16,"Agregar nueva elemento"),t.qZA()()()()),2&n&&(t.xp6(6),t.Q6J("tools",r.tools),t.xp6(2),t.Q6J("routerLink",r.routeConstants.addToolPath),t.xp6(5),t.Q6J("toolOutputs",r.toolOutputs))},dependencies:[b.rH,L,k]})}class G{transform(e){return e.measurementUnitSymbol?`${e.parameterValue} | ${e.measurementUnitSymbol}`:`${e.parameterValue}`}static#t=this.\u0275fac=function(n){return new(n||G)};static#e=this.\u0275pipe=t.Yjl({name:"parameterValue",type:G,pure:!0})}function To(o,e){if(1&o&&(t.TgZ(0,"div",4)(1,"label",14),t._uU(2),t.qZA(),t._UZ(3,"input",15),t.ALo(4,"parameterValue"),t.qZA()),2&o){const n=e.$implicit;t.xp6(2),t.Oqu(n.name),t.xp6(1),t.Q6J("value",t.lcZ(4,2,n))}}function xo(o,e){if(1&o&&(t.ynx(0,12),t.YNc(1,To,5,4,"div",13),t.BQk()),2&o){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.tool.toolParameters)}}function vo(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",1)(1,"button",16),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.initAdditionalInformation())}),t._uU(2," Agregar informaci\xf3n adicional "),t.qZA(),t.TgZ(3,"button",17),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.addNewTool())}),t._uU(4,"Guardar"),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(3),t.Q6J("disabled",!n.addNewToolForm.valid)}}function bo(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",12)(1,"app-add-parameter",18),t.NdJ("newParameterAddedEvent",function(i){t.CHM(n);const s=t.oxw();return t.KtG(s.addToolParameter(i))})("cancelAddParameterEvent",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.setIsAddingAdditionalInfo(!1))}),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("existingParameters",n.toolParameters)("parametersToFilter",null==n.tool?null:n.tool.toolParameters)}}function yo(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"ngx-dropzone-image-preview",21),t.NdJ("removed",function(){const s=t.CHM(n).$implicit,l=t.oxw(2);return t.KtG(l.onRemoveFile(s))}),t.qZA()}2&o&&t.Q6J("file",e.$implicit)("removable",!0)}function Ao(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"ngx-dropzone",19),t.NdJ("change",function(i){t.CHM(n);const s=t.oxw();return t.KtG(s.onSelectFile(i))}),t.TgZ(1,"ngx-dropzone-label"),t._uU(2,"Haga click o arrastre hasta aqu\xed para a\xf1adir archivos"),t.qZA(),t.YNc(3,yo,1,2,"ngx-dropzone-image-preview",20),t.qZA()}if(2&o){const n=t.oxw();t.Q6J("accept","image/*"),t.xp6(3),t.Q6J("ngForOf",n.addNewToolForm.controls.files.value)}}class Y{constructor(e,n,r,i){this.fb=e,this.httpService=n,this.router=r,this.modalService=i,this.isAddingAdditionalInfo=!1,this.isAddingExistingParameter=!1,this.isAddingNewParameter=!1}ngOnInit(){this.initForm(),this.getToolParameters()}getToolParameters(){this.httpService.get(g.G8.toolParametersApi).subscribe(e=>this.toolParameters=e)}initForm(){this.addNewToolForm=this.fb.group({toolName:[null,u.kI.required],files:[new Array]})}onAddParameter(e){this.addToolParameter(e),this.setIsAddingAdditionalInfo(!1)}addToolParameter(e){const n={id:e.id,name:e.name,measurementUnitId:e.measurementUnitId,measurementUnitSymbol:e.measurementUnitSymbol,parameterValue:e.parameterValue};this.tool&&this.tool.toolParameters?this.tool.toolParameters.push(n):this.tool={...this.tool,toolParameters:[n]},this.setIsAddingAdditionalInfo(!1)}addNewTool(){if(!this.addNewToolForm.valid)return;const e=this.addNewToolForm.controls.files.value,n=new FormData;n.append("name",this.addNewToolForm.controls.toolName.value),n.append("toolParameters",JSON.stringify(this.tool.toolParameters)),e.map(r=>n.append("files",r)),this.httpService.post(g.G8.toolsApi,n).subscribe(()=>this.router.navigateByUrl(`/${g.p7.toolsPath}`))}initAdditionalInformation(){this.setIsAddingAdditionalInfo(!0),this.setIsAddingExistingParameter(!1),this.setIsAddingNewParameter(!1)}setIsAddingAdditionalInfo(e){this.isAddingAdditionalInfo=e}setIsAddingExistingParameter(e){this.isAddingExistingParameter=e}setIsAddingNewParameter(e){this.isAddingNewParameter=e}setExistingParameter(e){this.tempParameter=this.toolParameters.find(n=>n.id==e.id),this.setIsAddingExistingParameter(!0)}onSelectFile(e){const n=this.addNewToolForm.controls.files.value;n.push(...e.addedFiles),this.addNewToolForm.patchValue({files:n})}onRemoveFile(e){if(!this.addNewToolForm.controls.files.value)return;const r=this.addNewToolForm.controls.files.value.filter(i=>i.name!=e.name);this.addNewToolForm.patchValue({files:r})}static#t=this.\u0275fac=function(n){return new(n||Y)(t.Y36(u.qu),t.Y36(y.O),t.Y36(b.F0),t.Y36(O.FF))};static#e=this.\u0275cmp=t.Xpm({type:Y,selectors:[["app-add-new-tool"]],decls:17,vars:5,consts:[[1,"container"],[1,"text-center","mt-3"],[3,"formGroup"],[1,"row","justify-content-center"],[1,"col-lg-3","col-md-4","col-sm-6"],["for","toolName",1,"form-label"],["type","text","id","toolName","formControlName","toolName",1,"form-control"],["class","row mt-3",4,"ngIf"],["class","text-center mt-3",4,"ngIf","ngIfElse"],["addingAdditionalInfo",""],[1,"row"],[3,"accept","change",4,"ngIf"],[1,"row","mt-3"],["class","col-lg-3 col-md-4 col-sm-6",4,"ngFor","ngForOf"],[1,"form-label"],["type","text","disabled","",1,"form-control",3,"value"],[1,"btn","btn-outline-primary","ms-2",3,"click"],[1,"btn","btn-outline-primary","ms-2",3,"disabled","click"],[3,"existingParameters","parametersToFilter","newParameterAddedEvent","cancelAddParameterEvent"],[3,"accept","change"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed"]],template:function(n,r){if(1&n&&(t.TgZ(0,"section",0)(1,"h1",1),t._uU(2,"Agregar nuevo equipo o herramienta"),t.qZA(),t.TgZ(3,"form",2)(4,"div",3)(5,"div",4)(6,"label",5),t._uU(7,"Nombre"),t.qZA(),t._UZ(8,"input",6),t.qZA(),t.YNc(9,xo,2,1,"ng-container",7),t.qZA(),t.YNc(10,vo,5,1,"div",8),t.YNc(11,bo,2,2,"ng-template",null,9,t.W1O),t.TgZ(13,"div",10)(14,"h2",1),t._uU(15,"A\xf1adir im\xe1genes"),t.qZA(),t.YNc(16,Ao,4,2,"ngx-dropzone",11),t.qZA()()()),2&n){const i=t.MAs(12);t.xp6(3),t.Q6J("formGroup",r.addNewToolForm),t.xp6(6),t.Q6J("ngIf",r.tool&&r.tool.toolParameters&&r.tool.toolParameters.length),t.xp6(1),t.Q6J("ngIf",!r.isAddingAdditionalInfo)("ngIfElse",i),t.xp6(6),t.Q6J("ngIf",r.addNewToolForm)}},dependencies:[m.sg,m.O5,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,A._f,A.NP,A.sv,qt.d,G]})}const Zo=[{path:"",component:$},{path:"add-tool",component:Y},{path:":id",component:U}];class D{static#t=this.\u0275fac=function(n){return new(n||D)};static#e=this.\u0275mod=t.oAB({type:D});static#o=this.\u0275inj=t.cJS({imports:[b.Bz.forChild(Zo),b.Bz]})}var Fo=p(6619);class H{static#t=this.\u0275fac=function(n){return new(n||H)};static#e=this.\u0275mod=t.oAB({type:H});static#o=this.\u0275inj=t.cJS({imports:[m.ez,D,Fo.m]})}}}]);