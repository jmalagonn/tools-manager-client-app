"use strict";(self.webpackChunkToolsManagerClientApp=self.webpackChunkToolsManagerClientApp||[]).push([[686],{1686:(Oe,at,m)=>{m.r(at),m.d(at,{CustomersModule:()=>nt});var c=m(6895),d=m(8869),ct=m(5861),a=m(433),p=m(2771),t=m(1571),_=m(9453),l=m(6858),h=m(2687),Z=m(7185),v=m(2216),mt=m(3366),ot=m(1875),it=m(7281);function pt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"form",1)(1,"div",2)(2,"h5"),t._uU(3,"Nuevo par\xe1metro"),t.qZA(),t.TgZ(4,"div",3)(5,"label",4),t._uU(6,"Nombre"),t.qZA(),t._UZ(7,"input",5),t.qZA(),t.TgZ(8,"div",3)(9,"label",4),t._uU(10,"Magnitud"),t.qZA(),t.TgZ(11,"app-dropdown",6),t.NdJ("onSelectOptionEvent",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.setMeasurementUnitValue(r))}),t.ALo(12,"toDropdownItem"),t.qZA()(),t.TgZ(13,"div",7)(14,"label",4),t._uU(15,"Valor"),t.qZA(),t._UZ(16,"input",8),t.qZA(),t.TgZ(17,"div",9)(18,"button",10),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addNewEquipmenParameter())}),t._UZ(19,"fa-icon",11),t.qZA(),t.TgZ(20,"button",12),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.cancelAddNewParameterEvent.emit())}),t._UZ(21,"fa-icon",11),t.qZA()()()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.equipmentParameterForm),t.xp6(11),t.Q6J("options",t.xi3(12,5,e.measurementUnits,"measurementUnits")),t.xp6(7),t.Q6J("disabled",e.equipmentParameterForm.invalid),t.xp6(1),t.Q6J("icon",e.faCheck),t.xp6(2),t.Q6J("icon",e.faX)}}class x{constructor(n,e){this.httpService=n,this.fb=e,this.faCheck=h.LEp,this.faX=h.EOp,this.cancelAddNewParameterEvent=new t.vpe,this.addNewEquipmentParameterEvent=new t.vpe}ngOnInit(){this.getMeasurementUnits(),this.initForm()}initForm(){this.equipmentParameterForm=this.fb.group({equipmentParameterName:["",a.kI.required],measurementUnit:[null,a.kI.required],parameterValue:[null,a.kI.required]})}getMeasurementUnits(){this.httpService.get(p.G8.measurementUnitsApi).subscribe(n=>this.measurementUnits=n)}addNewEquipmenParameter(){this.equipmentParameterForm.invalid||this.addNewEquipmentParameterEvent.emit({equipmentParameterEquipmentId:0,equipmentParameterId:0,name:this.equipmentParameterForm.controls.equipmentParameterName.value,measurementUnitId:this.equipmentParameterForm.controls.measurementUnit.value.measurementUnitId,measurementUnitSymbol:this.equipmentParameterForm.controls.measurementUnit.value.symbol,parameterValue:this.equipmentParameterForm.controls.parameterValue.value})}setMeasurementUnitValue(n){this.equipmentParameterForm.patchValue({measurementUnit:this.measurementUnits.find(e=>e.measurementUnitId==n.id)})}static#t=this.\u0275fac=function(e){return new(e||x)(t.Y36(l.O),t.Y36(a.qu))};static#e=this.\u0275cmp=t.Xpm({type:x,selectors:[["app-add-new-equipment-parameter"]],outputs:{cancelAddNewParameterEvent:"cancelAddNewParameterEvent",addNewEquipmentParameterEvent:"addNewEquipmentParameterEvent"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"row","g-2"],[1,"col-md-4"],[1,"form-label"],["type","text","formControlName","equipmentParameterName",1,"form-control"],[3,"options","onSelectOptionEvent"],[1,"col-md-2"],["type","number","formControlName","parameterValue",1,"form-control"],[1,"col-md-2","action-buttons"],["type","button",1,"btn","btn-sm","btn-outline-success","action-buttons--button","me-2",3,"disabled","click"],[3,"icon"],["type","button",1,"btn","btn-sm","btn-outline-danger","action-buttons--button",3,"click"]],template:function(e,o){1&e&&t.YNc(0,pt,22,8,"form",0),2&e&&t.Q6J("ngIf",o.equipmentParameterForm)},dependencies:[c.O5,v.BN,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.sg,a.u,ot.J,it.s],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:end;padding-top:35px}.action-buttons--button[_ngcontent-%COMP%]{width:2rem;height:2rem}"]})}var b=m(5090);function dt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-dropdown-input",3),t.NdJ("selectItemEvent",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.onSelectItem(r))})("addNewItemEvent",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.setAddingNewParameter(!0))}),t.ALo(1,"toItemList"),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("buttonText","Seleccionar par\xe1metro")("options",t.xi3(1,4,e.equipmentParameters,"equipmentParameter"))("showAddNewItemButton",!0)("showAddNewItemButtonText","A\xf1adir nuevo par\xe1metro")}}function lt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-add-new-equipment-parameter",4),t.NdJ("cancelAddNewParameterEvent",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.cancelAddParameterEvent.emit())})("addNewEquipmentParameterEvent",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.addParameterEvent.emit(r))}),t.qZA()}}function ut(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"h5"),t._uU(2,"A\xf1adir par\xe1metro"),t.qZA(),t.TgZ(3,"div",5)(4,"div",6),t._uU(5),t.qZA(),t.TgZ(6,"div",7)(7,"input",8),t.NdJ("ngModelChange",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.parameterValue=r)}),t.qZA()(),t.TgZ(8,"div",9)(9,"button",10),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addEquipmentParameter())}),t._UZ(10,"fa-icon",11),t.qZA(),t.TgZ(11,"button",12),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.cancelAddParameterEvent.emit())}),t._UZ(12,"fa-icon",11),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.selectedItem.name+" | "+e.selectedItem.measurementUnitSymbol," "),t.xp6(2),t.Q6J("ngModel",e.parameterValue),t.xp6(3),t.Q6J("icon",e.faCheck),t.xp6(2),t.Q6J("icon",e.faX)}}class w{constructor(n,e){this.httpService=n,this.toastrService=e,this.selectingParameter=!0,this.faCheck=h.LEp,this.faX=h.EOp,this.addingNewParameter=!1,this.cancelAddParameterEvent=new t.vpe,this.addParameterEvent=new t.vpe}ngOnInit(){this.getEquipmentParameters()}getEquipmentParameters(){this.httpService.get(p.G8.equipmentParametersApi).subscribe(n=>this.equipmentParameters=n)}onSelectItem(n){this.selectedItem=this.equipmentParameters?.find(e=>e.equipmentParameterId==n.id),this.setSelectingParameter(!1)}setSelectingParameter(n){this.selectingParameter=n}setAddingNewParameter(n){this.setSelectingParameter(!1),this.addingNewParameter=n}addEquipmentParameter(){if(null==this.parameterValue)return void this.toastrService.error(p.aX.equipmentParameterWrongValue);const n={...this.selectedItem,equipmentParameterEquipmentId:this.selectedItem.equipmentParameterEquipmentId||0,parameterValue:this.parameterValue};this.addParameterEvent.emit(n)}static#t=this.\u0275fac=function(e){return new(e||w)(t.Y36(l.O),t.Y36(Z._W))};static#e=this.\u0275cmp=t.Xpm({type:w,selectors:[["app-add-equipment-parameter"]],outputs:{cancelAddParameterEvent:"cancelAddParameterEvent",addParameterEvent:"addParameterEvent"},decls:3,vars:3,consts:[[3,"buttonText","options","showAddNewItemButton","showAddNewItemButtonText","selectItemEvent","addNewItemEvent",4,"ngIf"],[3,"cancelAddNewParameterEvent","addNewEquipmentParameterEvent",4,"ngIf"],[4,"ngIf"],[3,"buttonText","options","showAddNewItemButton","showAddNewItemButtonText","selectItemEvent","addNewItemEvent"],[3,"cancelAddNewParameterEvent","addNewEquipmentParameterEvent"],[1,"row","g-1"],[1,"col-6"],[1,"col-4"],["type","number","placeholder","Valor",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"col-2","d-flex","justify-content-end"],[1,"btn","btn-sm","btn-outline-success","action-button","me-2",3,"click"],[3,"icon"],[1,"btn","btn-sm","btn-outline-danger","action-button",3,"click"]],template:function(e,o){1&e&&(t.YNc(0,dt,2,7,"app-dropdown-input",0),t.YNc(1,lt,1,0,"app-add-new-equipment-parameter",1),t.YNc(2,ut,13,4,"div",2)),2&e&&(t.Q6J("ngIf",o.selectingParameter),t.xp6(1),t.Q6J("ngIf",o.addingNewParameter),t.xp6(1),t.Q6J("ngIf",!o.selectingParameter&&!o.addingNewParameter&&o.selectedItem))},dependencies:[c.O5,v.BN,a.Fj,a.wV,a.JJ,a.On,mt.i,x,b.R],styles:[".action-button[_ngcontent-%COMP%]{width:2rem;height:2rem}"]})}const _t=function(i){return{"last-child":i}};function ht(i,n){if(1&i&&(t.TgZ(0,"p",23),t._uU(1),t.TgZ(2,"span"),t._uU(3,","),t.qZA()()),2&i){const e=n.$implicit;t.Q6J("ngClass",t.VKq(4,_t,n.last)),t.xp6(1),t.lnq(" ",e.name,": ",e.parameterValue," ",e.measurementUnitSymbol,"")}}function ft(i,n){if(1&i&&(t.TgZ(0,"div",21),t.YNc(1,ht,4,6,"p",22),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.equipmentParameters)}}function gt(i,n){1&i&&(t.TgZ(0,"p"),t._uU(1,"A\xfan no se ha agregado ning\xfan par\xe1metro."),t.qZA())}function vt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",24)(1,"button",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.setAddNewParameter(!0))}),t._uU(2," Agregar nuevo par\xe1metro "),t.qZA()()}}function bt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-add-equipment-parameter",26),t.NdJ("cancelAddParameterEvent",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.setAddNewParameter(!1))})("addParameterEvent",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onAddEquipmentParameter(r))}),t.qZA()}}function wt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"form",9),t.NdJ("ngSubmit",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addEquipmentForm.valid&&r.onSubmit())}),t.TgZ(1,"div",10)(2,"div",11)(3,"label",12),t._uU(4,"Nombre"),t.qZA(),t._UZ(5,"input",13),t.qZA(),t.TgZ(6,"div",11)(7,"label",14),t._uU(8,"Descripci\xf3n del equipo"),t.qZA(),t._UZ(9,"textarea",15),t.qZA()(),t.TgZ(10,"div",16)(11,"h6"),t._uU(12,"Par\xe1metros t\xe9cnicos"),t.qZA(),t.YNc(13,ft,2,1,"div",17),t.YNc(14,gt,2,0,"p",18),t.YNc(15,vt,3,0,"div",19),t.YNc(16,bt,1,0,"app-add-equipment-parameter",20),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.addEquipmentForm),t.xp6(13),t.Q6J("ngIf",e.equipmentParameters.length),t.xp6(1),t.Q6J("ngIf",!e.equipmentParameters.length),t.xp6(1),t.Q6J("ngIf",!e.addNewParameter),t.xp6(1),t.Q6J("ngIf",e.addNewParameter)}}class A{constructor(n,e,o){this.activeModal=n,this.fb=e,this.httpService=o,this.addNewParameter=!1,this.equipmentParameters=[]}ngOnInit(){this.initForm()}initForm(){this.addEquipmentForm=this.fb.group({equipmentName:["",a.kI.required],equipmentDescription:[]})}onSubmit(){var n=this;return(0,ct.Z)(function*(){const e={branchId:n.branch.branchId,customerId:n.branch.customerId,equipmentName:n.addEquipmentForm.controls.equipmentName.value,equipmentDescription:n.addEquipmentForm.controls.equipmentDescription.value,equipmentParameters:n.equipmentParameters.map(o=>({equipmentParameterId:o.equipmentParameterId,name:o.name,parameterValue:o.parameterValue||0,measurementUnitId:o.measurementUnitId}))};n.httpService.post("Equipment",e).subscribe(o=>{n.activeModal.close(o)})})()}setAddNewParameter(n){this.addNewParameter=n}onAddEquipmentParameter(n){this.setAddNewParameter(!1),this.addEquipmentParameter(n)}addEquipmentParameter(n){this.equipmentParameters.push(n)}createNewEquipmentParameters(n){return new Promise(o=>{const r=[];n.map((s,u)=>{this.httpService.post(p.G8.equipmentParametersApi,s).subscribe(rt=>{r.push(rt),u==n.length-1&&o(r)})})})}static#t=this.\u0275fac=function(e){return new(e||A)(t.Y36(_.Kz),t.Y36(a.qu),t.Y36(l.O))};static#e=this.\u0275cmp=t.Xpm({type:A,selectors:[["app-add-equipment-modal"]],inputs:{branch:"branch"},decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"btn","btn-outline-primary",3,"disabled","click"],[3,"formGroup","ngSubmit"],[1,"row","g-2"],[1,"col-12"],["for","equipmentName",1,"form-label"],["type","text","id","equipmentName","formControlName","equipmentName",1,"form-control"],["for","equipmentDescription",1,"form-label"],["id","equipmentDescription","formControlName","equipmentDescription",1,"form-control"],[1,"row","g-2","mt-2"],["class","technical-params d-flex",4,"ngIf"],[4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],[3,"cancelAddParameterEvent","addParameterEvent",4,"ngIf"],[1,"technical-params","d-flex"],["class","technical-params--param",3,"ngClass",4,"ngFor","ngForOf"],[1,"technical-params--param",3,"ngClass"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],[3,"cancelAddParameterEvent","addParameterEvent"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Agregar Nuevo equipo"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.activeModal.close()}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4),t.YNc(7,wt,17,5,"form",5),t.qZA(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return o.activeModal.close()}),t._uU(10,"Cerrar"),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){return o.onSubmit()}),t._uU(12,"Guardar"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("ngIf",o.addEquipmentForm),t.xp6(4),t.Q6J("disabled",!o.addEquipmentForm.valid))},dependencies:[c.mk,c.sg,c.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,w],styles:[".technical-params--param[_ngcontent-%COMP%]{margin-right:.5rem}.technical-params--param.last-child[_ngcontent-%COMP%]{margin-right:none}.technical-params--param.last-child[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}"]})}var T=m(1066);class C{transform(n,e){return n.some(o=>o==e)}static#t=this.\u0275fac=function(e){return new(e||C)};static#e=this.\u0275pipe=t.Yjl({name:"contains",type:C,pure:!0})}function It(i,n){if(1&i&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e," ")}}function kt(i,n){if(1&i&&(t.TgZ(0,"td")(1,"a",4),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("routerLink","/"+o.routeConstants.workItemPath+"/"+e.workItemId),t.xp6(1),t.hij(" ",e.workItemId," ")}}function qt(i,n){if(1&i&&(t.TgZ(0,"td")(1,"a",4),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("routerLink","/"+o.routeConstants.workOrderPath+"/"+e.workOrderId),t.xp6(1),t.hij(" ",e.workOrderId," ")}}function Zt(i,n){if(1&i&&(t.TgZ(0,"td")(1,"a",4),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("routerLink","/"+o.routeConstants.equipmentPath+"/"+e.equipment.equipmentId),t.xp6(1),t.hij(" ",e.equipment.equipmentName," ")}}function xt(i,n){if(1&i&&(t.TgZ(0,"td")(1,"a",4),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("routerLink","/"+o.routeConstants.usersManagement+"/"+e.assignedUserId),t.xp6(1),t.hij(" ",e.assignedUserName," ")}}function At(i,n){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.ALo(2,"workState"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.workState)," ")}}function Tt(i,n){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.workItemDescription?e.workItemDescription:"No se agreg\xf3 descripci\xf3n."," ")}}function Ct(i,n){if(1&i&&(t.TgZ(0,"tr"),t.YNc(1,kt,3,2,"td",3),t.ALo(2,"contains"),t.YNc(3,qt,3,2,"td",3),t.ALo(4,"contains"),t.YNc(5,Zt,3,2,"td",3),t.ALo(6,"contains"),t.YNc(7,xt,3,2,"td",3),t.ALo(8,"contains"),t.YNc(9,At,3,3,"td",3),t.ALo(10,"contains"),t.YNc(11,Tt,2,1,"td",3),t.ALo(12,"contains"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.xi3(2,6,e.columns,"Id")),t.xp6(2),t.Q6J("ngIf",t.xi3(4,9,e.columns,"OT")),t.xp6(2),t.Q6J("ngIf",t.xi3(6,12,e.columns,"Equipo")),t.xp6(2),t.Q6J("ngIf",t.xi3(8,15,e.columns,"Asignado a")),t.xp6(2),t.Q6J("ngIf",t.xi3(10,18,e.columns,"Estado")),t.xp6(2),t.Q6J("ngIf",t.xi3(12,21,e.columns,"Descripci\xf3n"))}}function Et(i,n){if(1&i&&(t.TgZ(0,"table",1)(1,"thead")(2,"tr"),t.YNc(3,It,2,1,"th",2),t.qZA()(),t.TgZ(4,"tbody"),t.YNc(5,Ct,13,24,"tr",2),t.qZA()()),2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.columns),t.xp6(2),t.Q6J("ngForOf",e.workItems)}}class f{constructor(){this.routeConstants=p.p7,this.columns=["Id","OT","Equipo","Asignado a","Estado"]}static#t=this.\u0275fac=function(e){return new(e||f)};static#e=this.\u0275cmp=t.Xpm({type:f,selectors:[["app-work-items-list"]],inputs:{workItems:"workItems",columns:"columns"},decls:1,vars:1,consts:[["class","table table-hover",4,"ngIf"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"routerLink"]],template:function(e,o){1&e&&t.YNc(0,Et,6,2,"table",0),2&e&&t.Q6J("ngIf",o.workItems&&o.workItems.length)},dependencies:[c.sg,c.O5,d.rH,T.$,C]})}function Nt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"p",5)(3,"b"),t._uU(4,"Cliente:"),t.qZA(),t._uU(5),t.qZA(),t.TgZ(6,"p")(7,"b"),t._uU(8,"Sucursal:"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"form",6)(11,"div",7),t._UZ(12,"textarea",8),t.TgZ(13,"label",9),t._uU(14,"Descripci\xf3n general"),t.qZA()()(),t.TgZ(15,"div",10)(16,"button",11),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.setAddingItem(!0))}),t._UZ(17,"fa-icon",12),t._uU(18," A\xf1adir \xedtem "),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(5),t.hij(" ",e.branch.customerName,""),t.xp6(4),t.hij(" ",e.branch.branchName,""),t.xp6(1),t.Q6J("formGroup",e.workOrderForm),t.xp6(6),t.Q6J("disabled",e.addingItem),t.xp6(1),t.Q6J("icon",e.faPlus)}}function Ft(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-dropdown",15),t.NdJ("onSelectOptionEvent",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onSelectItem(r,2))}),t.ALo(1,"toDropdownItem"),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("label","Tipo de trabajo")("options",t.lcZ(1,2,e.workItemTypes))}}function yt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-dropdown",15),t.NdJ("onSelectOptionEvent",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onSelectItem(r,3))}),t.ALo(1,"toDropdownItem"),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("label","Asignado a")("options",t.xi3(1,2,e.employees,"employee"))}}function Jt(i,n){if(1&i&&(t.TgZ(0,"form",22)(1,"div",7),t._UZ(2,"textarea",23),t.TgZ(3,"label",24),t._uU(4,"Descripci\xf3n del trabajo"),t.qZA()()()),2&i){const e=t.oxw(2);t.Q6J("formGroup",e.workItemForm)}}function Ut(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",13)(1,"div",14)(2,"app-dropdown",15),t.NdJ("onSelectOptionEvent",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.onSelectItem(r,1))}),t.ALo(3,"toDropdownItem"),t.qZA()(),t.TgZ(4,"div",14),t.YNc(5,Ft,2,4,"app-dropdown",16),t.qZA(),t.TgZ(6,"div",14),t.YNc(7,yt,2,5,"app-dropdown",16),t.qZA(),t.TgZ(8,"div",17),t.YNc(9,Jt,5,1,"form",18),t.qZA(),t.TgZ(10,"div",19)(11,"button",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.onSaveWorkItem())}),t._UZ(12,"fa-icon",12),t._uU(13," Guardar "),t.qZA(),t.TgZ(14,"button",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.setAddingItem(!1))}),t._UZ(15,"fa-icon",12),t._uU(16," Cancelar "),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("label","Seleccionar equipo")("options",t.xi3(3,8,e.branch.equipment,"equipment")),t.xp6(3),t.Q6J("ngIf",e.workItemTypes),t.xp6(2),t.Q6J("ngIf",e.employees),t.xp6(2),t.Q6J("ngIf",e.workItemForm),t.xp6(2),t.Q6J("disabled",e.workItemForm.invalid),t.xp6(1),t.Q6J("icon",e.faSave),t.xp6(3),t.Q6J("icon",e.faTrash)}}const Ot=function(){return["Equipo","Asignado a"]};function Pt(i,n){if(1&i&&(t.TgZ(0,"div",25)(1,"div",4),t._UZ(2,"app-work-items-list",26),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("columns",t.DdM(2,Ot))("workItems",e.tempWorkItems)}}class I{constructor(n,e){this.httpService=n,this.fb=e,this.faPlus=h.r8p,this.faSave=h.r6l,this.faTrash=h.$aW,this.addingItem=!1,this.tempWorkItems=[],this.woEvent=new t.vpe}ngOnInit(){this.initWorkOrderForm(),this.getWorkItemTypes(),this.getEmployees()}getWorkItemTypes(){this.httpService.get(p.G8.workItemTypesApi).subscribe(n=>this.workItemTypes=n)}getEmployees(){this.httpService.get(p.G8.userEmployeesApi).subscribe(n=>this.employees=n)}initWorkOrderForm(){this.workOrderForm=this.fb.group({workOrderDescription:[""]})}initWorkItemForm(){this.workItemForm=this.fb.group({assignedUserId:[null,a.kI.required],equipmentId:[null,a.kI.required],workItemDescription:["",a.kI.required],workItemTypeId:[null,a.kI.required]})}setAddingItem(n){this.addingItem=n,this.addingItem&&this.initWorkItemForm()}onSelectItem(n,e){switch(e){case 1:this.workItemForm.patchValue({equipmentId:n.id});break;case 2:this.workItemForm.patchValue({workItemTypeId:n.id});break;case 3:this.workItemForm.patchValue({assignedUserId:n.id})}}onSaveWorkItem(){this.tempWorkItems.push({assignedUserId:this.workItemForm.controls.assignedUserId.value,assignedUserName:this.employees.find(n=>n.userId==this.workItemForm.controls.assignedUserId.value).name,createdOn:(new Date).toISOString(),equipment:this.branch.equipment.find(n=>n.equipmentId==this.workItemForm.controls.equipmentId.value),workItemDescription:this.workItemForm.controls.workItemDescription.value,workItemId:0,workItemTypeId:this.workItemForm.controls.workItemTypeId.value,workItemTypeName:this.workItemTypes.find(n=>n.workItemTypeId==this.workItemForm.controls.workItemTypeId.value)?.workItemTypeName,workOrderId:0}),this.setAddingItem(!1)}emitWOInfo(){const n={workStateId:1,workStateName:"Open"},e={workOrderId:Date.now(),workOrderDescription:this.workOrderForm?.controls.workOrderDescription.value,customerId:this.branch.customerId,customerName:this.branch.customerName,branchId:this.branch.branchId,branchName:this.branch.branchName,workItems:this.tempWorkItems.map(o=>({assignedUserId:o.assignedUserId,createdOn:o.createdOn,equipment:o.equipment,workItemDescription:o.workItemDescription,workItemId:o.workItemId,workItemTypeId:o.workItemTypeId,workOrderId:o.workOrderId,workState:n})),workState:n};this.woEvent.emit(e)}static#t=this.\u0275fac=function(e){return new(e||I)(t.Y36(l.O),t.Y36(a.qu))};static#e=this.\u0275cmp=t.Xpm({type:I,selectors:[["app-add-work-order-form"]],inputs:{branch:"branch"},outputs:{woEvent:"woEvent"},decls:3,vars:3,consts:[["class","row",4,"ngIf"],["class","row mt-3 g-2",4,"ngIf"],["class","row mt-3",4,"ngIf"],[1,"row"],[1,"col"],[1,"mb-1"],[1,"mb-3",3,"formGroup"],[1,"form-floating"],["placeholder","Descripci\xf3n general","id","workOrderDescription","formControlName","workOrderDescription",1,"form-control"],["for","workOrderDescription"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"disabled","click"],[1,"me-1",3,"icon"],[1,"row","mt-3","g-2"],[1,"col-md-4"],[3,"label","options","onSelectOptionEvent"],[3,"label","options","onSelectOptionEvent",4,"ngIf"],[1,"col-12","mt-2"],[3,"formGroup",4,"ngIf"],[1,"d-flex","justify-content-center","mt-2"],["type","button",1,"btn","btn-sm","btn-outline-primary","me-2",3,"disabled","click"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click"],[3,"formGroup"],["placeholder","Descripci\xf3n del trabajo","id","workItemDescription","formControlName","workItemDescription",1,"form-control"],["for","workItemDescription"],[1,"row","mt-3"],[3,"columns","workItems"]],template:function(e,o){1&e&&(t.YNc(0,Nt,19,5,"div",0),t.YNc(1,Ut,17,11,"div",1),t.YNc(2,Pt,3,3,"div",2)),2&e&&(t.Q6J("ngIf",o.branch),t.xp6(1),t.Q6J("ngIf",o.branch&&o.addingItem),t.xp6(1),t.Q6J("ngIf",o.tempWorkItems.length))},dependencies:[c.O5,v.BN,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,ot.J,f,it.s]})}var g=m(1894);function St(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ngx-dropzone-image-preview",12),t.NdJ("removed",function(){const s=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.onRemoveFile(s))}),t.qZA()}2&i&&t.Q6J("file",n.$implicit)("removable",!0)}class E{constructor(n,e,o){this.activeModal=n,this.toastr=e,this.httpService=o,this.files=[]}onSelectFile(n){this.files.push(...n.addedFiles)}onRemoveFile(n){this.files=this.files.filter(e=>e!=n)}onSaveWO(n){n.workItems.length?(new FormData,this.httpService.post("WorkOrder",{workOrderDescription:n.workOrderDescription,customerId:n.customerId,branchId:n.branchId,workItems:n.workItems,workState:n.workState}).subscribe(r=>this.activeModal.close(r))):this.toastr.error("Debe agregar al menos un \xedtem de trabajo.")}static#t=this.\u0275fac=function(e){return new(e||E)(t.Y36(_.Kz),t.Y36(Z._W),t.Y36(l.O))};static#e=this.\u0275cmp=t.Xpm({type:E,selectors:[["app-add-work-order-modal"]],viewQuery:function(e,o){if(1&e&&t.Gf(I,5),2&e){let r;t.iGM(r=t.CRH())&&(o.addWorkOrderForm=r.first)}},inputs:{branch:"branch"},decls:19,vars:3,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"branch","woEvent"],[1,"text-center","mt-3"],[3,"accept","change"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],["type","button",1,"btn","btn-outline-primary",3,"click"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Nueva Orden de trabajo"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.activeModal.close()}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4)(7,"app-add-work-order-form",5),t.NdJ("woEvent",function(s){return o.onSaveWO(s)}),t.qZA(),t.TgZ(8,"h2",6),t._uU(9,"A\xf1adir im\xe1genes"),t.qZA(),t.TgZ(10,"ngx-dropzone",7),t.NdJ("change",function(s){return o.onSelectFile(s)}),t.TgZ(11,"ngx-dropzone-label"),t._uU(12,"Haga click o arrastre hasta aqu\xed para a\xf1adir archivos"),t.qZA(),t.YNc(13,St,1,2,"ngx-dropzone-image-preview",8),t.qZA()(),t.TgZ(14,"div",9)(15,"button",10),t.NdJ("click",function(){return o.activeModal.close()}),t._uU(16,"Cerrar"),t.qZA(),t.TgZ(17,"button",11),t.NdJ("click",function(){return o.addWorkOrderForm.emitWOInfo()}),t._uU(18,"Guardar"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("branch",o.branch),t.xp6(3),t.Q6J("accept","image/*"),t.xp6(3),t.Q6J("ngForOf",o.files))},dependencies:[c.sg,g._f,g.NP,g.sv,I]})}var k=m(1458),N=m(8073),F=m(3741);function Mt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"tr",4),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.onRowClicked(s))}),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.ALo(8,"workState"),t.qZA()()}if(2&i){const e=n.$implicit;t.xp6(2),t.hij(" ",e.workOrderId," "),t.xp6(2),t.hij(" ",t.lcZ(5,3,e.createdOn)," "),t.xp6(3),t.hij(" ",t.lcZ(8,5,e.workState)," ")}}function Qt(i,n){if(1&i&&(t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th"),t._uU(4," Id "),t.qZA(),t.TgZ(5,"th"),t._uU(6," Fecha de creaci\xf3n "),t.qZA(),t.TgZ(7,"th"),t._uU(8," Estado "),t.qZA()()(),t.TgZ(9,"tbody"),t.YNc(10,Mt,9,7,"tr",3),t.qZA()()),2&i){const e=t.oxw();t.xp6(10),t.Q6J("ngForOf",e.items)}}function Yt(i,n){1&i&&(t.TgZ(0,"p",5),t._uU(1," No se encontraron elementos\n"),t.qZA())}class y{constructor(n){this.router=n}onRowClicked(n){this.router.navigateByUrl(`customers/work-order/${n.workOrderId}`)}static#t=this.\u0275fac=function(e){return new(e||y)(t.Y36(d.F0))};static#e=this.\u0275cmp=t.Xpm({type:y,selectors:[["app-work-orders-table"]],inputs:{items:"items"},decls:2,vars:2,consts:[["class","table table-hover",4,"ngIf"],["class","text-center mt-3",4,"ngIf"],[1,"table","table-hover"],["role","button",3,"click",4,"ngFor","ngForOf"],["role","button",3,"click"],[1,"text-center","mt-3"]],template:function(e,o){1&e&&(t.YNc(0,Qt,11,1,"table",0),t.YNc(1,Yt,2,0,"p",1)),2&e&&(t.Q6J("ngIf",o.items&&o.items.length),t.xp6(1),t.Q6J("ngIf",o.items&&!o.items.length))},dependencies:[c.sg,c.O5,c.uU,T.$]})}class J{constructor(n){this.fb=n,this.cancelEditingBranchEvent=new t.vpe,this.updateBranchEvent=new t.vpe}ngOnInit(){this.editBranchForm=this.fb.group({branchName:[this.branch.branchName,a.kI.required]})}onSubmit(){const n={...this.branch,branchName:this.editBranchForm?.controls.branchName.value};this.updateBranchEvent.emit(n)}static#t=this.\u0275fac=function(e){return new(e||J)(t.Y36(a.qu))};static#e=this.\u0275cmp=t.Xpm({type:J,selectors:[["app-edit-branch"]],inputs:{branch:"branch"},outputs:{cancelEditingBranchEvent:"cancelEditingBranchEvent",updateBranchEvent:"updateBranchEvent"},decls:12,vars:3,consts:[[3,"formGroup","ngSubmit"],[1,"row","justify-content-center"],[1,"col-sm-6"],["for","branchName",1,"form-label"],["type","text","id","branchName","formControlName","branchName",1,"form-control",3,"placeholder"],[1,"row","mt-3"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","btn-outline-primary","me-2",3,"disabled"],["type","button",1,"btn","btn-outline-danger",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.editBranchForm.valid&&o.onSubmit()}),t.TgZ(1,"div",1)(2,"div",2)(3,"label",3),t._uU(4,"Nombre de la sucursal"),t.qZA(),t._UZ(5,"input",4),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"button",7),t._uU(9,"Guardar"),t.qZA(),t.TgZ(10,"button",8),t.NdJ("click",function(){return o.cancelEditingBranchEvent.emit()}),t._uU(11,"Cancelar"),t.qZA()()()()),2&e&&(t.Q6J("formGroup",o.editBranchForm),t.xp6(5),t.Q6J("placeholder",o.branch.branchName),t.xp6(3),t.Q6J("disabled",!o.editBranchForm.dirty))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}var U=m(2368);function Wt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-edit-model",13),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(3);return t.KtG(r.setEditingBranch(!0))}),t.qZA()}}function Dt(i,n){if(1&i&&(t.TgZ(0,"h1",11),t._uU(1),t.YNc(2,Wt,1,0,"app-edit-model",12),t.ALo(3,"userRoles"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.branch.branchName," "),t.xp6(1),t.Q6J("ngIf",t.lcZ(3,2,e.userRoles.CustomersAdmin))}}function Lt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-edit-branch",14),t.NdJ("cancelEditingBranchEvent",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.setEditingBranch(!1))})("updateBranchEvent",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onUpdateBranch(r))}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("branch",e.branch)}}function Gt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onOpenAddEquipmentModal())}),t._uU(1," Agregar nuevo equipo "),t.qZA()}}function Bt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onOpenAddWorkOrder())}),t._uU(1,"Agregar nueva OT"),t.qZA()}}function jt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2),t.YNc(2,Dt,4,4,"h1",3),t.YNc(3,Lt,1,1,"app-edit-branch",4),t.TgZ(4,"div",5)(5,"h5",6),t._uU(6,"Equipos"),t.qZA(),t.TgZ(7,"div",7),t.YNc(8,Gt,2,0,"button",8),t.ALo(9,"userRoles"),t.qZA(),t.TgZ(10,"app-items-list",9),t.NdJ("rowClickedEvent",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.navigateToEquipment(r))}),t.ALo(11,"toItemList"),t.qZA()(),t.TgZ(12,"div",5)(13,"h5",6),t._uU(14,"\xd3rdenes de trabajo"),t.qZA(),t.TgZ(15,"div",7),t.YNc(16,Bt,2,0,"button",8),t.ALo(17,"userRoles"),t.qZA(),t._UZ(18,"app-work-orders-table",10),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",!e.editingBranch),t.xp6(1),t.Q6J("ngIf",e.editingBranch),t.xp6(5),t.Q6J("ngIf",t.lcZ(9,6,e.userRoles.CustomersAdmin)),t.xp6(2),t.Q6J("items",t.xi3(11,8,e.branch.equipment,"equipment")),t.xp6(6),t.Q6J("ngIf",t.lcZ(17,11,e.userRoles.CustomersAdmin)),t.xp6(2),t.Q6J("items",e.branch.workOrders)}}class O{constructor(n,e,o,r){this.route=n,this.httpService=e,this.modalService=o,this.router=r,this.faEdit=h.Xcf,this.editingBranch=!1,this.userRoles=k.v}ngOnInit(){this.getBranch()}getBranch(){const n=this.route.snapshot.paramMap.get("branchId");this.httpService.get(`Branches?branchId=${n}`).subscribe(e=>this.branch=e)}onOpenAddEquipmentModal(){this.modalRef=this.modalService.open(A,{size:"lg"}),this.modalRef.componentInstance.branch=this.branch,this.modalRef.closed.subscribe(n=>n&&this.getBranch())}onOpenAddWorkOrder(){this.modalRef=this.modalService.open(E,{size:"lg"}),this.modalRef.componentInstance.branch=this.branch,this.modalRef.closed.subscribe(n=>n&&this.getBranch())}navigateToEquipment(n){this.router.navigateByUrl(`customers/equipment/${n.id}`)}setEditingBranch(n){this.editingBranch=n}onUpdateBranch(n){this.httpService.put(`${p.G8.branchesApi}/${n.branchId}`,n).subscribe(()=>{this.getBranch(),this.setEditingBranch(!1)})}static#t=this.\u0275fac=function(e){return new(e||O)(t.Y36(d.gz),t.Y36(l.O),t.Y36(_.FF),t.Y36(d.F0))};static#e=this.\u0275cmp=t.Xpm({type:O,selectors:[["app-branch-detail"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"row","mt-3"],["class","text-center d-flex justify-content-center align-items-center",4,"ngIf"],[3,"branch","cancelEditingBranchEvent","updateBranchEvent",4,"ngIf"],[1,"col-lg-6","mt-3"],[1,"text-center"],[1,"text-center","mt-3"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[3,"items","rowClickedEvent"],[3,"items"],[1,"text-center","d-flex","justify-content-center","align-items-center"],[3,"click",4,"ngIf"],[3,"click"],[3,"branch","cancelEditingBranchEvent","updateBranchEvent"],[1,"btn","btn-outline-primary",3,"click"]],template:function(e,o){1&e&&t.YNc(0,jt,19,13,"div",0),2&e&&t.Q6J("ngIf",o.branch)},dependencies:[c.O5,N.H,F.D,y,J,b.R,U.Y]})}function Ht(i,n){if(1&i&&(t.TgZ(0,"form",9)(1,"div",10)(2,"label",11),t._uU(3,"Nombre"),t.qZA(),t._UZ(4,"input",12),t.qZA()()),2&i){const e=t.oxw();t.Q6J("formGroup",e.addBranchForm)}}class P{constructor(n,e,o){this.activeModal=n,this.fb=e,this.httpService=o}ngOnInit(){this.initForm()}initForm(){this.addBranchForm=this.fb.group({branchName:["",a.kI.required]})}onSubmit(){this.httpService.post("Branches",{branchName:this.addBranchForm.controls.branchName.value,customerId:this.customer.customerId}).subscribe(e=>{this.activeModal.close(!0)})}static#t=this.\u0275fac=function(e){return new(e||P)(t.Y36(_.Kz),t.Y36(a.qu),t.Y36(l.O))};static#e=this.\u0275cmp=t.Xpm({type:P,selectors:[["app-add-branch-modal"]],inputs:{customer:"customer"},decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark","me-2",3,"click"],["type","button",1,"btn","btn-outline-primary",3,"disabled","click"],[3,"formGroup"],[1,"mb-3"],["for","branchName",1,"form-label"],["type","text","id","branchName","formControlName","branchName",1,"form-control"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Agregar Nueva sucursal"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.activeModal.close(!1)}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4),t.YNc(7,Ht,5,1,"form",5),t.qZA(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return o.activeModal.close(!1)}),t._uU(10,"Cerrar"),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){return o.onSubmit()}),t._uU(12,"Guardar"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("ngIf",o.addBranchForm),t.xp6(4),t.Q6J("disabled",!o.addBranchForm.valid))},dependencies:[c.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}class S{constructor(n){this.fb=n,this.cancelEditingEvent=new t.vpe,this.updateEvent=new t.vpe}ngOnInit(){this.editForm=this.fb.group({customerName:[this.customer.customerName,a.kI.required]})}onSubmit(){if(!this.editForm||!this.editForm.valid)return;const n={...this.customer,customerName:this.editForm.controls.customerName.value};this.updateEvent.emit(n)}static#t=this.\u0275fac=function(e){return new(e||S)(t.Y36(a.qu))};static#e=this.\u0275cmp=t.Xpm({type:S,selectors:[["app-edit-customer"]],inputs:{customer:"customer"},outputs:{cancelEditingEvent:"cancelEditingEvent",updateEvent:"updateEvent"},decls:12,vars:3,consts:[[3,"formGroup","ngSubmit"],[1,"row","justify-content-center"],[1,"col-sm-6"],["for","customerName",1,"form-label"],["type","text","id","customerName","formControlName","customerName",1,"form-control",3,"placeholder"],[1,"row","mt-3"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","btn-outline-primary","me-2",3,"disabled"],["type","button",1,"btn","btn-outline-danger",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.editForm.valid&&o.onSubmit()}),t.TgZ(1,"div",1)(2,"div",2)(3,"label",3),t._uU(4,"Nombre del cliente"),t.qZA(),t._UZ(5,"input",4),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"button",7),t._uU(9,"Guardar"),t.qZA(),t.TgZ(10,"button",8),t.NdJ("click",function(){return o.cancelEditingEvent.emit()}),t._uU(11,"Cancelar"),t.qZA()()()()),2&e&&(t.Q6J("formGroup",o.editForm),t.xp6(5),t.Q6J("placeholder",o.customer.customerName),t.xp6(3),t.Q6J("disabled",!o.editForm.dirty))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}function Kt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-edit-model",10),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(3);return t.KtG(r.setEditingCustomer(!0))}),t.qZA()}}function Rt(i,n){if(1&i&&(t.TgZ(0,"h1",8),t._uU(1),t.YNc(2,Kt,1,0,"app-edit-model",9),t.ALo(3,"userRoles"),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.customer.customerName," "),t.xp6(1),t.Q6J("ngIf",t.lcZ(3,2,e.userRoles.CustomersAdmin))}}function $t(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-edit-customer",11),t.NdJ("cancelEditingEvent",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.setEditingCustomer(!1))})("updateEvent",function(r){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onUpdateCustomer(r))}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("customer",e.customer)}}function zt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",12)(1,"button",13),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onOpenAddBranchModal())}),t._uU(2,"Agregar nueva sucursal"),t.qZA()()}}function Xt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2),t.YNc(2,Rt,4,4,"h1",3),t.YNc(3,$t,1,1,"app-edit-customer",4),t.YNc(4,zt,3,0,"div",5),t.ALo(5,"userRoles"),t.TgZ(6,"div",6)(7,"app-items-list",7),t.NdJ("rowClickedEvent",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.goToBranch(r))}),t.ALo(8,"toItemList"),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",!e.editingCustomer),t.xp6(1),t.Q6J("ngIf",e.editingCustomer),t.xp6(1),t.Q6J("ngIf",t.lcZ(5,4,e.userRoles.CustomersAdmin)),t.xp6(3),t.Q6J("items",t.xi3(8,6,e.customer.branches,"branch"))}}class M{constructor(n,e,o,r){this.route=n,this.httpService=e,this.modalService=o,this.router=r,this.editingCustomer=!1,this.userRoles=k.v}ngOnInit(){this.getCustomer()}getCustomer(){const n=this.route.snapshot.paramMap.get("id");this.httpService.get(`Customers/${n}`).subscribe(e=>this.customer=e)}onOpenAddBranchModal(){this.modalRef=this.modalService.open(P),this.modalRef.componentInstance.customer=this.customer,this.modalRef.closed.subscribe(n=>n&&this.getCustomer())}goToBranch(n){this.router.navigateByUrl(`customers/customer/${this.customer.customerId}/branch/${n.id}`)}setEditingCustomer(n){this.editingCustomer=n}onUpdateCustomer(n){this.httpService.put(`${p.G8.customersApi}/${n.customerId}`,n).subscribe(()=>{this.getCustomer(),this.setEditingCustomer(!1)})}static#t=this.\u0275fac=function(e){return new(e||M)(t.Y36(d.gz),t.Y36(l.O),t.Y36(_.FF),t.Y36(d.F0))};static#e=this.\u0275cmp=t.Xpm({type:M,selectors:[["app-customer-detail"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"row","mt-3"],["class","text-center d-flex justify-content-center align-items-center",4,"ngIf"],[3,"customer","cancelEditingEvent","updateEvent",4,"ngIf"],["class","text-center mt-3",4,"ngIf"],[1,"col","mt-3"],[3,"items","rowClickedEvent"],[1,"text-center","d-flex","justify-content-center","align-items-center"],[3,"click",4,"ngIf"],[3,"click"],[3,"customer","cancelEditingEvent","updateEvent"],[1,"text-center","mt-3"],[1,"btn","btn-outline-primary",3,"click"]],template:function(e,o){1&e&&t.YNc(0,Xt,9,9,"div",0),2&e&&t.Q6J("ngIf",o.customer)},dependencies:[c.O5,N.H,F.D,S,b.R,U.Y]})}var Vt=m(860);function te(i,n){if(1&i&&(t.TgZ(0,"form",9)(1,"div",10)(2,"label",11),t._uU(3,"Nombre"),t.qZA(),t._UZ(4,"input",12),t.qZA()()),2&i){const e=t.oxw();t.Q6J("formGroup",e.addCustomerForm)}}class Q{constructor(n,e,o){this.activeModal=n,this.fb=e,this.httpService=o}ngOnInit(){this.initForm()}initForm(){this.addCustomerForm=this.fb.group({customerName:["",a.kI.required]})}onSubmit(){this.httpService.post("Customers",{customerName:this.addCustomerForm.controls.customerName.value}).subscribe(e=>{this.activeModal.close(e)})}static#t=this.\u0275fac=function(e){return new(e||Q)(t.Y36(_.Kz),t.Y36(a.qu),t.Y36(l.O))};static#e=this.\u0275cmp=t.Xpm({type:Q,selectors:[["app-add-customer-modal"]],decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"btn","btn-outline-primary",3,"disabled","click"],[3,"formGroup"],[1,"mb-3"],["for","customerName",1,"form-label"],["type","text","id","customerName","formControlName","customerName",1,"form-control"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Agregar Nuevo cliente"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.activeModal.dismiss()}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4),t.YNc(7,te,5,1,"form",5),t.qZA(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return o.activeModal.close()}),t._uU(10,"Cerrar"),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){return o.onSubmit()}),t._uU(12,"Guardar"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("ngIf",o.addCustomerForm),t.xp6(4),t.Q6J("disabled",!o.addCustomerForm.valid))},dependencies:[c.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}function ee(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"button",6),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.onOpenAddCustomerModal())}),t._uU(2,"Agregar nuevo cliente"),t.qZA()()}}class Y{constructor(n,e,o){this.modalService=n,this.httpService=e,this.router=o,this.listActions=Vt.D,this.userRoles=k.v}ngOnInit(){this.getCustomers()}getCustomers(){this.httpService.get("Customers").subscribe(n=>this.customers=n)}onOpenAddCustomerModal(){this.modalRef=this.modalService.open(Q),this.modalRef.closed.subscribe(n=>n&&this.getCustomers())}goToBranch(n){this.router.navigateByUrl(`customers/customer/${n.id}`)}updateCustomers(n){if(!n)return;const e=this.customers.findIndex(o=>o.customerId==n.customerId);this.customers?.splice(e,1,n),this.customers=Object.assign([],this.customers)}static#t=this.\u0275fac=function(e){return new(e||Y)(t.Y36(_.FF),t.Y36(l.O),t.Y36(d.F0))};static#e=this.\u0275cmp=t.Xpm({type:Y,selectors:[["app-customers"]],decls:9,vars:7,consts:[[1,"container"],[1,"text-center","mt-3"],["class","text-center mt-3",4,"ngIf"],[1,"row","mt-3"],[1,"col"],[3,"items","rowClickedEvent"],[1,"btn","btn-outline-primary",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Clientes"),t.qZA(),t.YNc(3,ee,3,0,"div",2),t.ALo(4,"userRoles"),t.TgZ(5,"div",3)(6,"div",4)(7,"app-items-list",5),t.NdJ("rowClickedEvent",function(s){return o.goToBranch(s)}),t.ALo(8,"toItemList"),t.qZA()()()()),2&e&&(t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,o.userRoles.CustomersAdmin)),t.xp6(4),t.Q6J("items",t.xi3(8,4,o.customers,"customer")))},dependencies:[c.O5,N.H,b.R,U.Y]})}function ne(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-edit-model",2),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.editButtonClickedEvent.emit())}),t.qZA()}}class q{constructor(){this.editButtonClickedEvent=new t.vpe}static#t=this.\u0275fac=function(e){return new(e||q)};static#e=this.\u0275cmp=t.Xpm({type:q,selectors:[["app-section-title"]],inputs:{title:"title",editableSection:"editableSection"},outputs:{editButtonClickedEvent:"editButtonClickedEvent"},decls:3,vars:2,consts:[[1,"mt-3","d-flex","justify-content-center","align-items-center"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"h1",0),t._uU(1),t.YNc(2,ne,1,0,"app-edit-model",1),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",o.title," "),t.xp6(1),t.Q6J("ngIf",o.editableSection))},dependencies:[c.O5,F.D]})}function oe(i,n){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Oqu(e.appConstants.noEquipmentParametersFound)}}function ie(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",18)(2,"p",19),t._uU(3),t.qZA(),t.TgZ(4,"input",20),t.NdJ("change",function(r){const u=t.CHM(e).$implicit,rt=t.oxw();return t.KtG(rt.equipmentParameterChanged(r,u.equipmentParameterId))}),t.qZA(),t.TgZ(5,"p",21),t._uU(6),t.qZA(),t.TgZ(7,"div",22)(8,"fa-icon",23),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.deleteParameter(s.name))}),t.qZA()()()()}if(2&i){const e=n.$implicit,o=t.oxw();t.xp6(3),t.hij("",e.name,": "),t.xp6(1),t.Q6J("value",e.parameterValue),t.xp6(2),t.Oqu(e.measurementUnitSymbol),t.xp6(2),t.Q6J("icon",o.faTrash)}}function re(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-add-equipment-parameter",24),t.NdJ("cancelAddParameterEvent",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.setAddingNewEquipmentParameter(!1))})("addParameterEvent",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.addNewParameter(r))}),t.qZA()}}function ae(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",15)(1,"button",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.setAddingNewEquipmentParameter(!0))}),t._uU(2," A\xf1adir nuevo par\xe1metro "),t.qZA()()}}class W{constructor(n,e,o){this.fb=n,this.toastrService=e,this.httpService=o,this.faTrash=h.$aW,this.addingNewEquipmentParameter=!1,this.appConstants=p.$x,this.tempEquipmentParameters=[],this.cancelEvent=new t.vpe,this.equipmentUpdatedEvent=new t.vpe}ngOnInit(){this.initForm()}initForm(){this.tempEquipmentParameters=this.equipment.equipmentParameters,this.equipmentForm=this.fb.group({equipmentId:[this.equipment.equipmentId,a.kI.required],equipmentName:[this.equipment.equipmentName,a.kI.required],equipmentDescription:[this.equipment.equipmentDescription],equipmentParameters:[this.tempEquipmentParameters]})}equipmentParameterChanged(n,e){const o=this.equipment.equipmentParameters.findIndex(r=>r.equipmentParameterId==e);-1!=o&&(this.equipment.equipmentParameters[o].parameterValue=parseFloat(n.target.value),this.patchEquipmentParametersToForm())}setAddingNewEquipmentParameter(n){this.addingNewEquipmentParameter=n}addNewParameter(n){0!=n.equipmentParameterId&&this.tempEquipmentParameters.find(e=>e.equipmentParameterEquipmentId==n.equipmentParameterEquipmentId)?this.toastrService.error(p.aX.parameterAlreadyExists):(this.tempEquipmentParameters.push(n),this.patchEquipmentParametersToForm(),this.setAddingNewEquipmentParameter(!1))}deleteParameter(n){const e=this.tempEquipmentParameters.findIndex(o=>o.name==n);this.tempEquipmentParameters.splice(e,1),this.patchEquipmentParametersToForm()}patchEquipmentParametersToForm(){this.equipmentForm?.patchValue({equipmentParameters:this.tempEquipmentParameters}),this.equipmentForm.markAsDirty()}onSubmit(){this.equipmentForm.valid&&this.httpService.put(p.G8.equipmentApi,{equipmentId:this.equipment.equipmentId,equipmentName:this.equipmentForm.controls.equipmentName.value,equipmentDescription:this.equipmentForm.controls.equipmentDescription.value,equipmentParameters:this.equipmentForm.controls.equipmentParameters.value}).subscribe(e=>this.equipmentUpdatedEvent.emit(e))}static#t=this.\u0275fac=function(e){return new(e||W)(t.Y36(a.qu),t.Y36(Z._W),t.Y36(l.O))};static#e=this.\u0275cmp=t.Xpm({type:W,selectors:[["app-edit-equipment"]],inputs:{equipment:"equipment"},outputs:{cancelEvent:"cancelEvent",equipmentUpdatedEvent:"equipmentUpdatedEvent"},decls:23,vars:7,consts:[[3,"formGroup"],[1,"row"],[1,"col-sm-6"],["for","equipmentName",1,"form-label"],["type","text","id","equipmentName","formControlName","equipmentName",1,"form-control"],[1,"col-12","mt-3"],[1,"form-floating"],["id","equipmentDescription","formControlName","equipmentDescription",1,"form-control"],["for","equipmentDescription"],[1,"row","mt-3","g-2"],[1,"mb-3"],[4,"ngIf"],["class","col-sm-6",4,"ngFor","ngForOf"],[3,"cancelAddParameterEvent","addParameterEvent",4,"ngIf"],["class","d-flex justify-content-center mt-3",4,"ngIf"],[1,"d-flex","justify-content-center","mt-3"],["type","button",1,"btn","btn-outline-danger",3,"click"],["type","submit",1,"ms-2","btn","btn-outline-primary",3,"disabled","click"],[1,"parameter-card","d-flex","align-items-center"],[1,"parameter-card--name","m-0"],["type","number",1,"form-control","form-control-sm","parameter-card--value",3,"value","change"],[1,"parameter-card--symbol","m-0"],[1,"parameter-card--icon"],["role","button",3,"icon","click"],[3,"cancelAddParameterEvent","addParameterEvent"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),t._uU(4),t.qZA(),t._UZ(5,"input",4),t.qZA(),t.TgZ(6,"div",5)(7,"div",6),t._UZ(8,"textarea",7),t.TgZ(9,"label",8),t._uU(10,"Descripci\xf3n"),t.qZA()()()(),t.TgZ(11,"div",9)(12,"h4",10),t._uU(13,"Par\xe1metros del equipo"),t.qZA(),t.YNc(14,oe,2,1,"p",11),t.YNc(15,ie,9,4,"div",12),t.YNc(16,re,1,0,"app-add-equipment-parameter",13),t.YNc(17,ae,3,0,"div",14),t.qZA(),t.TgZ(18,"div",15)(19,"button",16),t.NdJ("click",function(){return o.cancelEvent.emit()}),t._uU(20,"Cancelar"),t.qZA(),t.TgZ(21,"button",17),t.NdJ("click",function(){return o.onSubmit()}),t._uU(22,"Guardar"),t.qZA()()()),2&e&&(t.Q6J("formGroup",o.equipmentForm),t.xp6(4),t.Oqu(o.appConstants.appName),t.xp6(10),t.Q6J("ngIf",!o.equipment.equipmentParameters.length),t.xp6(1),t.Q6J("ngForOf",o.equipment.equipmentParameters),t.xp6(1),t.Q6J("ngIf",o.addingNewEquipmentParameter),t.xp6(1),t.Q6J("ngIf",!o.addingNewEquipmentParameter),t.xp6(4),t.Q6J("disabled",!o.equipmentForm.valid||!o.equipmentForm.dirty))},dependencies:[c.sg,c.O5,v.BN,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,w],styles:[".parameter-card--name[_ngcontent-%COMP%]{width:55%}.parameter-card--value[_ngcontent-%COMP%], .parameter-card--icon[_ngcontent-%COMP%], .parameter-card--symbol[_ngcontent-%COMP%]{width:15%;text-align:center}.parameter-card--icon[_ngcontent-%COMP%]{color:#dc3545}"]})}function se(i,n){if(1&i&&(t.TgZ(0,"div",7)(1,"p",8),t._uU(2),t.qZA()()),2&i){const e=n.$implicit;t.xp6(2),t.AsE(" ",e.name,": ",e.parameterValue+" "+e.measurementUnitSymbol," ")}}function ce(i,n){if(1&i&&(t.TgZ(0,"div",4)(1,"h4",5),t._uU(2,"Par\xe1metros del equipo:"),t.qZA(),t.YNc(3,se,3,2,"div",6),t.qZA()),2&i){const e=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.equipment.equipmentParameters)}}function me(i,n){if(1&i&&(t.TgZ(0,"div",1)(1,"p")(2,"b"),t._uU(3,"Cliente: "),t.qZA(),t.TgZ(4,"a",2),t._uU(5),t.qZA()(),t.TgZ(6,"p")(7,"b"),t._uU(8,"Sucursal: "),t.qZA(),t.TgZ(9,"a",2),t._uU(10),t.qZA()(),t.TgZ(11,"p")(12,"b"),t._uU(13,"Descripci\xf3n: "),t.qZA(),t._uU(14),t.qZA(),t.YNc(15,ce,4,1,"div",3),t.qZA()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("routerLink","/"+e.routeConstants.customersPath+"/"+e.equipment.customerId),t.xp6(1),t.Oqu(e.equipment.customerName),t.xp6(4),t.Q6J("routerLink","/"+e.routeConstants.customersPath+"/"+e.equipment.customerId+"/"+e.routeConstants.branchPath+"/"+e.equipment.branchId),t.xp6(1),t.hij(" ",e.equipment.branchName," "),t.xp6(4),t.hij(" ",e.equipment.equipmentDescription?e.equipment.equipmentDescription:"No se ingres\xf3 descripci\xf3n del equipo.",""),t.xp6(1),t.Q6J("ngIf",e.equipment.equipmentParameters.length)}}class D{constructor(){this.routeConstants=p.p7}static#t=this.\u0275fac=function(e){return new(e||D)};static#e=this.\u0275cmp=t.Xpm({type:D,selectors:[["app-equipment-info"]],inputs:{equipment:"equipment"},decls:1,vars:1,consts:[["class","col",4,"ngIf"],[1,"col"],[3,"routerLink"],["class","row g-2",4,"ngIf"],[1,"row","g-2"],[1,"mb-1"],["class","col-lg-3 col-md-4 col-sm-6",4,"ngFor","ngForOf"],[1,"col-lg-3","col-md-4","col-sm-6"],[1,"m-0"]],template:function(e,o){1&e&&t.YNc(0,me,16,6,"div",0),2&e&&t.Q6J("ngIf",o.equipment)},dependencies:[c.sg,c.O5,d.rH]})}function pe(i,n){if(1&i&&(t.ynx(0),t._UZ(1,"app-equipment-info",7),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("equipment",e.equipment)}}function de(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-edit-equipment",8),t.NdJ("cancelEvent",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.setEditingEquipment(!1))})("equipmentUpdatedEvent",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onEquipmentUpdated())}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("equipment",e.equipment)}}const le=function(){return["Id","OT","Asignado a","Estado","Descripci\xf3n"]};function ue(i,n){if(1&i&&(t.TgZ(0,"div",3)(1,"h2",9),t._uU(2,"\xcdtems asociados"),t.qZA(),t._UZ(3,"app-work-items-list",10),t.qZA()),2&i){const e=t.oxw(2);t.xp6(3),t.Q6J("workItems",e.workItems)("columns",t.DdM(2,le))}}function _e(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",1)(1,"app-section-title",2),t.NdJ("editButtonClickedEvent",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.setEditingEquipment(!0))}),t.qZA(),t.TgZ(2,"div",3),t.YNc(3,pe,2,1,"ng-container",4),t.YNc(4,de,1,1,"ng-template",null,5,t.W1O),t.qZA(),t.YNc(6,ue,4,3,"div",6),t.qZA()}if(2&i){const e=t.MAs(5),o=t.oxw();t.xp6(1),t.Q6J("title",o.equipment.equipmentName)("editableSection",!o.editingEquipment),t.xp6(2),t.Q6J("ngIf",!o.editingEquipment)("ngIfElse",e),t.xp6(3),t.Q6J("ngIf",o.workItems&&o.workItems.length)}}class L{constructor(n,e){this.httpService=n,this.route=e,this.editingEquipment=!1,this.routeConstants=p.p7,this.userRoles=k.v}ngOnInit(){this.getEquipment()}getEquipment(){const n=this.route.snapshot.paramMap.get("id");this.httpService.get(`Equipment/${n}`).subscribe(e=>{this.equipment=e,this.getWorkItems()})}getWorkItems(){this.httpService.get(`WorkItem/equipment?equipmentId=${this.equipment.equipmentId}`).subscribe(n=>this.workItems=n)}setEditingEquipment(n){this.editingEquipment=n}onEquipmentUpdated(){this.setEditingEquipment(!1),this.getEquipment()}static#t=this.\u0275fac=function(e){return new(e||L)(t.Y36(l.O),t.Y36(d.gz))};static#e=this.\u0275cmp=t.Xpm({type:L,selectors:[["app-equipment"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[3,"title","editableSection","editButtonClickedEvent"],[1,"row","mt-3"],[4,"ngIf","ngIfElse"],["editEquipmentSection",""],["class","row mt-3",4,"ngIf"],[3,"equipment"],[3,"equipment","cancelEvent","equipmentUpdatedEvent"],[1,"text-center"],[3,"workItems","columns"]],template:function(e,o){1&e&&t.YNc(0,_e,7,5,"div",0),2&e&&t.Q6J("ngIf",o.equipment)},dependencies:[c.O5,q,f,W,D]})}var st=m(18),he=m(2340);function fe(i,n){if(1&i&&(t.TgZ(0,"div",4),t._UZ(1,"img",5),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("src",o.filesUrl+e.url,t.LSH)}}function ge(i,n){1&i&&t.YNc(0,fe,2,1,"ng-template",3)}function ve(i,n){if(1&i&&(t.TgZ(0,"ngb-carousel",1),t.YNc(1,ge,1,0,null,2),t.qZA()),2&i){const e=t.oxw();t.Q6J("interval",0),t.xp6(1),t.Q6J("ngForOf",e.images)}}class G{constructor(){this.filesUrl=he.N.filesUrl,this.images=[]}ngOnChanges(n){console.log(n)}static#t=this.\u0275fac=function(e){return new(e||G)};static#e=this.\u0275cmp=t.Xpm({type:G,selectors:[["app-image-carousel"]],inputs:{images:"images",config:"config"},features:[t.TTD],decls:1,vars:1,consts:[[3,"interval",4,"ngIf"],[3,"interval"],[4,"ngFor","ngForOf"],["ngbSlide",""],[1,"img-container","text-center"],[3,"src"]],template:function(e,o){1&e&&t.YNc(0,ve,2,2,"ngb-carousel",0),2&e&&t.Q6J("ngIf",o.images)},dependencies:[c.sg,c.O5,_.uo,_.xl],styles:["img[_ngcontent-%COMP%]{max-height:400px;max-width:100%}"]})}class B{transform(n){return n&&n.length?n:[]}static#t=this.\u0275fac=function(e){return new(e||B)};static#e=this.\u0275pipe=t.Yjl({name:"appFilesPipe",type:B,pure:!0})}class j{constructor(n){this.bsModalRef=n,this.sliderConfig={interval:0,noPause:!0}}static#t=this.\u0275fac=function(e){return new(e||j)(t.Y36(st.UZ))};static#e=this.\u0275cmp=t.Xpm({type:j,selectors:[["app-work-item-detail-modal"]],decls:21,vars:6,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"row","g-2"],[1,"col-12"],[3,"images","config"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.bsModalRef.hide()}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"p")(10,"b"),t._uU(11,"Descripci\xf3n:"),t.qZA(),t._uU(12),t.qZA()(),t.TgZ(13,"div",6)(14,"h5"),t._uU(15,"Archivos:"),t.qZA(),t._UZ(16,"app-image-carousel",7),t.ALo(17,"appFilesPipe"),t.qZA()()(),t.TgZ(18,"div",8)(19,"button",9),t.NdJ("click",function(){return o.bsModalRef.hide()}),t._uU(20,"Cerrar"),t.qZA()()),2&e&&(t.xp6(2),t.hij("Trabajo: ",o.activityLog.workItemActivityLogId,""),t.xp6(10),t.hij(" ",o.activityLog.description,""),t.xp6(4),t.Q6J("images",t.lcZ(17,4,o.activityLog.files))("config",o.sliderConfig))},dependencies:[G,B]})}class H{constructor(n){this.activeModal=n}static#t=this.\u0275fac=function(e){return new(e||H)(t.Y36(_.Kz))};static#e=this.\u0275cmp=t.Xpm({type:H,selectors:[["app-modal-image"]],inputs:{fileUrl:"fileUrl"},decls:9,vars:1,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","text-center"],[3,"src"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Imagen"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.activeModal.dismiss()}),t.qZA()(),t.TgZ(4,"div",3),t._UZ(5,"img",4),t.qZA(),t.TgZ(6,"div",5)(7,"button",6),t.NdJ("click",function(){return o.activeModal.close()}),t._uU(8,"Close"),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("src",o.fileUrl,t.LSH))},styles:["img[_ngcontent-%COMP%]{max-width:100%;max-height:60vh}"]})}function be(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"ngx-dropzone-preview",9),t.NdJ("removed",function(){const s=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.onRemove(s))}),t.TgZ(1,"ngx-dropzone-label"),t._uU(2),t.qZA()()}if(2&i){const e=n.$implicit;t.Q6J("removable",!0),t.xp6(2),t.Oqu(e.name)}}class K{constructor(n){this.activeModal=n,this.files=[]}onSelect(n){this.files.push(...n.addedFiles)}onRemove(n){this.files.splice(this.files.indexOf(n),1)}static#t=this.\u0275fac=function(e){return new(e||K)(t.Y36(_.Kz))};static#e=this.\u0275cmp=t.Xpm({type:K,selectors:[["app-upload-files-modal"]],inputs:{files:"files"},decls:14,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"accept","change"],[3,"removable","removed",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"removable","removed"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Cargar im\xe1genes"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.activeModal.close()}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4)(7,"ngx-dropzone",5),t.NdJ("change",function(s){return o.onSelect(s)}),t.TgZ(8,"ngx-dropzone-label"),t._uU(9,"Haga click o arrastre hasta aqu\xed para a\xf1adir archivos"),t.qZA(),t.YNc(10,be,3,2,"ngx-dropzone-preview",6),t.qZA()(),t.TgZ(11,"div",7)(12,"button",8),t.NdJ("click",function(){return o.activeModal.close(o.files)}),t._uU(13,"Cerrar"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("accept","image/*"),t.xp6(3),t.Q6J("ngForOf",o.files))},dependencies:[c.sg,g._f,g.NP,g.dt]})}var we=m(1481);function Ie(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",2)(1,"button",3),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.setAddingItem(!0))}),t._uU(2,"Agregar nuevo trabajo"),t.qZA()()}}function ke(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",18)(1,"span",19),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw(3);return t.KtG(u.showAddedImage(s))}),t._uU(2),t.qZA(),t.TgZ(3,"fa-icon",20),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw(3);return t.KtG(u.removeFile(s))}),t.qZA()()}if(2&i){const e=n.$implicit,o=t.oxw(3);t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Q6J("icon",o.faClose)}}function qe(i,n){if(1&i&&(t.TgZ(0,"div",15)(1,"p",16),t._uU(2,"Archivos agregados:"),t.qZA(),t.YNc(3,ke,4,2,"p",17),t.qZA()),2&i){const e=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.itemForm.value.files)}}function Ze(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"form",4),t.NdJ("ngSubmit",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.itemForm.valid&&r.onSubmit())}),t.TgZ(1,"div",5),t._UZ(2,"textarea",6),t.TgZ(3,"label",7),t._uU(4,"Descripci\xf3n del trabajo realizado"),t.qZA()(),t.YNc(5,qe,4,1,"div",8),t.TgZ(6,"div",9)(7,"button",10),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.onSaveWorkItem())}),t._UZ(8,"fa-icon",11),t._uU(9," Guardar "),t.qZA(),t.TgZ(10,"button",12),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.onAddImage())}),t._UZ(11,"fa-icon",11),t._uU(12," A\xf1adir imagen "),t.qZA(),t.TgZ(13,"button",13),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.setAddingItem(!1))}),t._UZ(14,"fa-icon",14),t._uU(15," Cancelar "),t.qZA()()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.itemForm),t.xp6(5),t.Q6J("ngIf",e.itemForm.value.files.length),t.xp6(2),t.Q6J("disabled",!e.itemForm.valid),t.xp6(1),t.Q6J("icon",e.faSave),t.xp6(3),t.Q6J("icon",e.faImage),t.xp6(3),t.Q6J("icon",e.faTrash)}}class R{constructor(n,e,o,r){this.fb=n,this.httpService=e,this.modalService=o,this.sanitazer=r,this.faSave=h.r6l,this.faTrash=h.$aW,this.faImage=h.VmB,this.faClose=h.YIN,this.addingItem=!1,this.workItemActivityLogCreatedEvent=new t.vpe}onSaveWorkItem(){}initForm(){this.itemForm=this.fb.group({description:["",a.kI.required],workItemId:[this.workItemId,a.kI.required],files:[new Array]})}setAddingItem(n){n&&this.initForm(),this.addingItem=n}onSubmit(){const n=this.itemForm.controls.files.value,e=new FormData;e.append("workItemId",this.workItemId.toString()),e.append("description",this.itemForm.controls.description.value),n.map(o=>{e.append("recievedFiles",o)}),this.httpService.post(`${p.G8.workItemActivityLogApi}`,e).subscribe(()=>{this.workItemActivityLogCreatedEvent.emit(),this.setAddingItem(!1)})}onAddImage(){this.modalRef=this.modalService.open(K,{size:"lg"}),this.modalRef.componentInstance.files=this.itemForm.controls.files.value,this.modalRef.closed.subscribe(n=>{!n||!n.length||this.itemForm.patchValue({files:n})})}removeFile(n){this.itemForm.patchValue({files:this.itemForm.value.files.filter(e=>e!=n)})}showAddedImage(n){this.modalRef=this.modalService.open(H),this.modalRef.componentInstance.fileUrl=this.sanitazer.bypassSecurityTrustUrl(URL.createObjectURL(new Blob([n],{type:n.type})))}static#t=this.\u0275fac=function(e){return new(e||R)(t.Y36(a.qu),t.Y36(l.O),t.Y36(_.FF),t.Y36(we.H7))};static#e=this.\u0275cmp=t.Xpm({type:R,selectors:[["app-new-work-item-activity-log"]],inputs:{workItemId:"workItemId"},outputs:{workItemActivityLogCreatedEvent:"workItemActivityLogCreatedEvent"},decls:2,vars:2,consts:[["class","d-flex justify-content-center mb-3",4,"ngIf"],["class","mb-3",3,"formGroup","ngSubmit",4,"ngIf"],[1,"d-flex","justify-content-center","mb-3"],[1,"btn","btn-outline-primary",3,"click"],[1,"mb-3",3,"formGroup","ngSubmit"],[1,"form-floating"],["placeholder","Leave a comment here","id","floatingTextarea","formControlName","description",1,"form-control"],["for","floatingTextarea"],["class","added-files",4,"ngIf"],[1,"d-flex","justify-content-center","mt-2"],["type","submit",1,"btn","btn-sm","btn-outline-primary","me-2",3,"disabled","click"],[1,"me-1",3,"icon"],["type","button",1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click"],[3,"icon"],[1,"added-files"],[1,"mb-2","mt-2"],["class","added-file",4,"ngFor","ngForOf"],[1,"added-file"],["role","button",3,"click"],["role","button",3,"icon","click"]],template:function(e,o){1&e&&(t.YNc(0,Ie,3,0,"div",0),t.YNc(1,Ze,16,6,"form",1)),2&e&&(t.Q6J("ngIf",!o.addingItem),t.xp6(1),t.Q6J("ngIf",o.addingItem&&o.itemForm))},dependencies:[c.sg,c.O5,v.BN,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u],styles:[".added-file[_ngcontent-%COMP%]{display:inline-flex;padding:.2rem .5rem;border-radius:.2rem;background-color:#c8c8c8b3;align-items:center;margin-bottom:.5rem;margin-right:.5rem}.added-file[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:.5rem;max-width:8rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.added-file[_ngcontent-%COMP%]:last-child{margin-right:0}"]})}function xe(i,n){if(1&i&&(t.TgZ(0,"div",1)(1,"div",2)(2,"p",3)(3,"b"),t._uU(4,"Orden de trabajo: "),t.qZA(),t.TgZ(5,"a",4),t._uU(6),t.qZA()()(),t.TgZ(7,"div",2)(8,"p",3)(9,"b"),t._uU(10,"Fecha de creaci\xf3n: "),t.qZA(),t._uU(11),t.ALo(12,"date"),t.qZA()(),t.TgZ(13,"div",2)(14,"p",3)(15,"b"),t._uU(16,"Cliente: "),t.qZA(),t.TgZ(17,"a",4),t._uU(18),t.qZA()()(),t.TgZ(19,"div",2)(20,"p",3)(21,"b"),t._uU(22,"Sucursal: "),t.qZA(),t.TgZ(23,"a",4),t._uU(24),t.qZA()()(),t.TgZ(25,"div",2)(26,"p",3)(27,"b"),t._uU(28,"Asignado a: "),t.qZA(),t.TgZ(29,"a",4),t._uU(30),t.qZA()()(),t.TgZ(31,"div",2)(32,"p",3)(33,"b"),t._uU(34,"Tipo de trabajo: "),t.qZA(),t._uU(35),t.qZA()(),t.TgZ(36,"div",2)(37,"p",3)(38,"b"),t._uU(39,"Equipo: "),t.qZA(),t.TgZ(40,"a",4),t._uU(41),t.qZA()()(),t.TgZ(42,"div",2)(43,"p",3)(44,"b"),t._uU(45,"Estado: "),t.qZA(),t._uU(46),t.ALo(47,"workState"),t.qZA()(),t.TgZ(48,"div",5)(49,"p",3)(50,"b"),t._uU(51,"Descripci\xf3n: "),t.qZA(),t._uU(52),t.qZA()()()),2&i){const e=t.oxw();t.xp6(5),t.Q6J("routerLink","/"+e.routeConstants.workOrderPath+"/"+e.workItem.workOrderId),t.xp6(1),t.Oqu(e.workItem.workOrderId),t.xp6(5),t.hij(" ",t.lcZ(12,14,e.workItem.createdOn),""),t.xp6(6),t.Q6J("routerLink","/"+e.routeConstants.customersPath+"/"+e.workItem.equipment.customerId),t.xp6(1),t.Oqu(e.workItem.equipment.customerName),t.xp6(5),t.Q6J("routerLink","/"+e.routeConstants.customersPath+"/"+e.workItem.equipment.customerId+"/"+e.routeConstants.branchPath+"/"+e.workItem.equipment.branchId),t.xp6(1),t.hij(" ",e.workItem.equipment.branchName," "),t.xp6(5),t.Q6J("routerLink","/"+e.routeConstants.usersManagement+"/"+e.workItem.assignedUserId),t.xp6(1),t.hij(" ",e.workItem.assignedUserName," "),t.xp6(5),t.hij(" ",e.workItem.workItemTypeName,""),t.xp6(5),t.Q6J("routerLink","/"+e.routeConstants.equipmentPath+"/"+e.workItem.equipment.equipmentId),t.xp6(1),t.Oqu(e.workItem.equipment.equipmentName),t.xp6(5),t.hij(" ",t.lcZ(47,16,e.workItem.workState),""),t.xp6(6),t.hij(" ",e.workItem.workItemDescription?e.workItem.workItemDescription:"No se ingres\xf3 descripci\xf3n de la OT.","")}}class ${constructor(){this.routeConstants=p.p7}static#t=this.\u0275fac=function(e){return new(e||$)};static#e=this.\u0275cmp=t.Xpm({type:$,selectors:[["app-work-item-general-info"]],inputs:{workItem:"workItem"},decls:1,vars:1,consts:[["class","row mt-3 g-3",4,"ngIf"],[1,"row","mt-3","g-3"],[1,"col-sm-6"],[1,"mb-0"],[3,"routerLink"],[1,"col-12"]],template:function(e,o){1&e&&t.YNc(0,xe,53,18,"div",0),2&e&&t.Q6J("ngIf",o.workItem)},dependencies:[c.O5,d.rH,c.uU,T.$]})}class z{static#t=this.\u0275fac=function(e){return new(e||z)};static#e=this.\u0275cmp=t.Xpm({type:z,selectors:[["app-work-item-edit"]],inputs:{workItem:"workItem"},decls:0,vars:0,template:function(e,o){}})}function Ae(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"app-new-work-item-activity-log",9),t.NdJ("workItemActivityLogCreatedEvent",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.activityLogCreated())}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("workItemId",e.workItem.workItemId)}}function Te(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"button",12),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.closeWorkItem())}),t._uU(3,"Cerrar \xedtem"),t.qZA()()()}}const Ce=function(){return["Id","Descripci\xf3n"]};function Ee(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",1),t._UZ(1,"app-section-title",2)(2,"app-work-item-general-info",3)(3,"app-work-item-edit",3),t.TgZ(4,"div",4)(5,"h2",5),t._uU(6,"Trabajos realizados"),t.qZA(),t.TgZ(7,"app-items-list",6),t.NdJ("rowClickedEvent",function(r){t.CHM(e);const s=t.oxw();return t.KtG(s.showWorkActivityLogDetail(r))}),t.ALo(8,"toItemList"),t.qZA(),t.YNc(9,Ae,1,1,"app-new-work-item-activity-log",7),t.qZA(),t.YNc(10,Te,4,0,"div",8),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("title","\xcdtem de trabajo: "+e.workItem.workItemId)("editableSection",3!=e.workItem.workState.workStateId),t.xp6(1),t.Q6J("workItem",e.workItem),t.xp6(1),t.Q6J("workItem",e.workItem),t.xp6(4),t.Q6J("headers",t.DdM(11,Ce))("items",t.xi3(8,8,e.workItem.workItemActivityLogs,"workItemActivityLog")),t.xp6(2),t.Q6J("ngIf",3!=e.workItem.workState.workStateId),t.xp6(1),t.Q6J("ngIf",3!=e.workItem.workState.workStateId)}}class X{constructor(n,e,o,r){this.httpService=n,this.route=e,this.modalService=o,this.toastrService=r,this.routeConstants=p.p7}ngOnInit(){this.getWorkItem(),this.getWorkStates()}getWorkItem(){const n=this.route.snapshot.paramMap.get("id");this.httpService.get(`WorkItem/${n}`).subscribe(e=>{this.workItem=e})}showWorkActivityLogDetail(n){const e={initialState:{activityLog:this.workItem.workItemActivityLogs.find(o=>o.workItemActivityLogId==n.id)},class:"modal-lg"};this.modalRef=this.modalService.show(j,e)}activityLogCreated(){this.getWorkItem()}getWorkStates(){this.httpService.get(p.G8.workStateApi).subscribe(n=>this.workStates=n)}closeWorkItem(){if(!this.workItem.workItemActivityLogs?.length)return void this.toastrService.error(p.aX.atLeastOneActivityLogMusBeAdded);const n={workItemId:this.workItem.workItemId.toString(),workStateId:this.workStates.find(e=>3==e.workStateId).workStateId.toString()};this.httpService.get(`${p.G8.workItemStateApi}?${new URLSearchParams(n).toString()}`).subscribe(e=>e&&this.getWorkItem())}static#t=this.\u0275fac=function(e){return new(e||X)(t.Y36(l.O),t.Y36(d.gz),t.Y36(st.tT),t.Y36(Z._W))};static#e=this.\u0275cmp=t.Xpm({type:X,selectors:[["app-work-item"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[3,"title","editableSection"],[3,"workItem"],[1,"row","mt-3"],[1,"text-center"],[3,"headers","items","rowClickedEvent"],[3,"workItemId","workItemActivityLogCreatedEvent",4,"ngIf"],["class","row mb-3",4,"ngIf"],[3,"workItemId","workItemActivityLogCreatedEvent"],[1,"row","mb-3"],[1,"col","text-center"],[1,"btn","btn-outline-primary",3,"click"]],template:function(e,o){1&e&&t.YNc(0,Ee,11,12,"div",0),2&e&&t.Q6J("ngIf",o.workItem)},dependencies:[c.O5,N.H,q,R,$,z,b.R]})}class V{constructor(n,e,o){this.activeModal=n,this.fb=e,this.httpService=o}ngOnInit(){this.getEquipment(),this.getWorkItemTypes(),this.getEmployees(),this.initForm()}getEquipment(){this.httpService.get(`${p.G8.equipmentApi}?BranchId=${this.workOrder.branchId}`).subscribe(n=>this.equipment=n)}getWorkItemTypes(){this.httpService.get(`${p.G8.workItemTypesApi}`).subscribe(n=>this.workItemTypes=n)}getEmployees(){this.httpService.get(`${p.G8.userEmployeesApi}`).subscribe(n=>this.employees=n)}initForm(){this.workItemForm=this.fb.group({assignedUserId:[null,a.kI.required],equipment:[null,a.kI.required],workItemTypeId:[null,a.kI.required],workItemDescription:["",a.kI.required]})}selectedDwElement(n,e){switch(e){case 1:this.workItemForm.patchValue({equipment:this.equipment.find(o=>o.equipmentId=n.id)});break;case 2:this.workItemForm.patchValue({workItemTypeId:n.id});break;case 3:this.workItemForm.patchValue({assignedUserId:n.id})}}submitWorkItem(){this.workItemForm&&this.workItemForm.valid&&this.httpService.post(p.G8.workItemApi,{assignedUserId:this.workItemForm.controls.assignedUserId.value,equipment:this.workItemForm.controls.equipment.value,workItemTypeId:this.workItemForm.controls.workItemTypeId.value,workItemDescription:this.workItemForm.controls.workItemDescription.value,workOrderId:this.workOrder.workOrderId}).subscribe(e=>this.activeModal.close(!0))}static#t=this.\u0275fac=function(e){return new(e||V)(t.Y36(_.Kz),t.Y36(a.qu),t.Y36(l.O))};static#e=this.\u0275cmp=t.Xpm({type:V,selectors:[["app-add-work-item-modal"]],inputs:{workOrder:"workOrder"},decls:27,vars:16,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"row","g-2"],[1,"col-lg-4"],[3,"label","options","onSelectOptionEvent"],[1,"row","mt-2"],[1,"col"],[1,"form-floating"],["id","new-work-item-description","formControlName","workItemDescription",1,"form-control"],["for","new-work-item-description"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-primary",3,"disabled","click"],["type","button",1,"btn","btn-outline-dark",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Nuevo \xedtem de trabajo"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.activeModal.dismiss("Cross click")}),t.qZA()(),t.TgZ(4,"div",3)(5,"form",4)(6,"div",5)(7,"div",6)(8,"app-dropdown",7),t.NdJ("onSelectOptionEvent",function(s){return o.selectedDwElement(s,1)}),t.ALo(9,"toDropdownItem"),t.qZA()(),t.TgZ(10,"div",6)(11,"app-dropdown",7),t.NdJ("onSelectOptionEvent",function(s){return o.selectedDwElement(s,2)}),t.ALo(12,"toDropdownItem"),t.qZA()(),t.TgZ(13,"div",6)(14,"app-dropdown",7),t.NdJ("onSelectOptionEvent",function(s){return o.selectedDwElement(s,3)}),t.ALo(15,"toDropdownItem"),t.qZA()()(),t.TgZ(16,"div",8)(17,"div",9)(18,"div",10),t._UZ(19,"textarea",11),t.TgZ(20,"label",12),t._uU(21,"Descripci\xf3n"),t.qZA()()()()()(),t.TgZ(22,"div",13)(23,"button",14),t.NdJ("click",function(){return o.submitWorkItem()}),t._uU(24,"Guardar"),t.qZA(),t.TgZ(25,"button",15),t.NdJ("click",function(){return o.activeModal.close(!1)}),t._uU(26,"Cerrar"),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("formGroup",o.workItemForm),t.xp6(3),t.Q6J("label","Equipo")("options",t.xi3(9,8,o.equipment,"equipment")),t.xp6(3),t.Q6J("label","Tipo de mantenimiento")("options",t.lcZ(12,11,o.workItemTypes)),t.xp6(3),t.Q6J("label","Asignado a")("options",t.xi3(15,13,o.employees,"employee")),t.xp6(9),t.Q6J("disabled",!o.workItemForm.valid))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,ot.J,it.s]})}function Ne(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",10)(1,"button",11),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.showNewWIModal())}),t._uU(2,"Agregar nuevo \xedtem"),t.qZA()()}}function Fe(i,n){if(1&i&&(t.TgZ(0,"div",1)(1,"h1",2),t._uU(2),t._UZ(3,"app-edit-model"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4)(6,"p")(7,"b"),t._uU(8,"Cliente: "),t.qZA(),t.TgZ(9,"a",5),t._uU(10),t.qZA()()(),t.TgZ(11,"div",4)(12,"p")(13,"b"),t._uU(14,"Sucursal: "),t.qZA(),t.TgZ(15,"a",5),t._uU(16),t.qZA()()(),t.TgZ(17,"div",4)(18,"p")(19,"b"),t._uU(20,"Fecha de creaci\xf3n: "),t.qZA(),t._uU(21),t.ALo(22,"date"),t.qZA()(),t.TgZ(23,"div",4)(24,"p")(25,"b"),t._uU(26,"Estado: "),t.qZA(),t._uU(27),t.ALo(28,"workState"),t.qZA()(),t.TgZ(29,"div",6)(30,"p")(31,"b"),t._uU(32,"Descripci\xf3n: "),t.qZA(),t._uU(33),t.qZA()()(),t.TgZ(34,"div",3)(35,"h2",7),t._uU(36,"\xcdtems"),t.qZA(),t._UZ(37,"app-work-items-list",8),t.YNc(38,Ne,3,0,"div",9),t.ALo(39,"userRoles"),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.hij(" Orden de trabajo: ",e.workOrder.workOrderId," "),t.xp6(7),t.Q6J("routerLink","/"+e.routeConstants.customersPath+"/"+e.workOrder.customerId),t.xp6(1),t.Oqu(e.workOrder.customerName),t.xp6(5),t.Q6J("routerLink","/"+e.routeConstants.customersPath+"/"+e.workOrder.customerId+"/"+e.routeConstants.branchPath+"/"+e.workOrder.branchId),t.xp6(1),t.hij(" ",e.workOrder.branchName," "),t.xp6(5),t.hij(" ",t.lcZ(22,10,e.workOrder.createdOn),""),t.xp6(6),t.hij(" ",t.lcZ(28,12,e.workOrder.workState),""),t.xp6(6),t.hij(" ",e.workOrder.workOrderDescription?e.workOrder.workOrderDescription:"No se ingres\xf3 descripci\xf3n de la OT.",""),t.xp6(4),t.Q6J("workItems",e.workOrder.workItems),t.xp6(1),t.Q6J("ngIf",t.lcZ(39,14,e.userRoles.CustomersAdmin))}}class tt{constructor(n,e,o,r){this.httpService=n,this.route=e,this.router=o,this.modalService=r,this.routeConstants=p.p7,this.userRoles=k.v}ngOnInit(){this.getWorkOrder()}getWorkOrder(){const n=this.route.snapshot.paramMap.get("id");this.httpService.get(`${p.G8.workOrderApi}/${n}`).subscribe(e=>this.workOrder=e)}navigateToWI(n){this.router.navigateByUrl(`${p.p7.workItemPath}/${n.workItemId}`)}showNewWIModal(){this.modalRef=this.modalService.open(V,{size:"lg"}),this.modalRef.componentInstance.workOrder=this.workOrder,this.modalRef.closed.subscribe(n=>n&&this.getWorkOrder())}static#t=this.\u0275fac=function(e){return new(e||tt)(t.Y36(l.O),t.Y36(d.gz),t.Y36(d.F0),t.Y36(_.FF))};static#e=this.\u0275cmp=t.Xpm({type:tt,selectors:[["app-work-order"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"mt-3","d-flex","justify-content-center","align-items-center"],[1,"row","mt-3"],[1,"col-sm-6"],[3,"routerLink"],[1,"col-12"],[1,"text-center"],[3,"workItems"],["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"btn","btn-outline-primary",3,"click"]],template:function(e,o){1&e&&t.YNc(0,Fe,40,16,"div",0),2&e&&t.Q6J("ngIf",o.workOrder)},dependencies:[c.O5,d.rH,F.D,f,c.uU,T.$,U.Y]})}const ye=[{path:"",component:Y},{path:"customer",children:[{path:":id",component:M},{path:":customerId/branch/:branchId",component:O}]},{path:"work-order/:id",component:tt},{path:"equipment/:id",component:L},{path:"work-item/:id",component:X}];class et{static#t=this.\u0275fac=function(e){return new(e||et)};static#e=this.\u0275mod=t.oAB({type:et});static#n=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(ye),d.Bz]})}var Je=m(6619),Ue=m(9127);class nt{static#t=this.\u0275fac=function(e){return new(e||nt)};static#e=this.\u0275mod=t.oAB({type:nt});static#n=this.\u0275inj=t.cJS({imports:[c.ez,et,Je.m,Ue.I]})}}}]);