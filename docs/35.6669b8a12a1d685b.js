"use strict";(self.webpackChunkToolsManagerClientApp=self.webpackChunkToolsManagerClientApp||[]).push([[35],{8035:(wt,$,d)=>{d.r($),d.d($,{CustomersModule:()=>G});var s=d(6895),l=d(8869),a=d(433),p=d(7323),e=d(1571),u=d(9453),m=d(5307),X=d(4028);const ee=function(o){return{"last-child":o}};function te(o,n){if(1&o&&(e.TgZ(0,"p",21),e._uU(1),e.TgZ(2,"span"),e._uU(3,","),e.qZA()()),2&o){const t=n.$implicit;e.Q6J("ngClass",e.VKq(4,ee,n.last)),e.xp6(1),e.lnq(" ",t.name,": ",t.parameterValue," ",t.measurementUnitSymbol,"")}}function ne(o,n){if(1&o&&(e.TgZ(0,"div",19),e.YNc(1,te,4,6,"p",20),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.parametersToAdd)}}function re(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"form",9),e.NdJ("ngSubmit",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addEquipmentForm.valid&&i.onSubmit())}),e.TgZ(1,"div",10)(2,"div",11)(3,"label",12),e._uU(4,"Nombre"),e.qZA(),e._UZ(5,"input",13),e.qZA(),e.TgZ(6,"div",11)(7,"label",14),e._uU(8,"Descripci\xf3n del equipo"),e.qZA(),e._UZ(9,"textarea",15),e.qZA()(),e.TgZ(10,"div",16)(11,"h6"),e._uU(12,"Par\xe1metros t\xe9cnicos"),e.qZA(),e.YNc(13,ne,2,1,"div",17),e.TgZ(14,"app-add-parameter",18),e.NdJ("newParameterAddedEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.onNewParameterAdded(i))}),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.addEquipmentForm),e.xp6(13),e.Q6J("ngIf",t.parametersToAdd.length),e.xp6(1),e.Q6J("existingParameters",t.allEquipmentParameters)("parametersToFilter",t.parametersToAdd)}}class w{constructor(n,t,r){this.activeModal=n,this.fb=t,this.httpService=r,this.addNewParameter=!1,this.allEquipmentParameters=[],this.parametersToAdd=[]}ngOnInit(){this.initForm(),this.getEquipmentParameters()}initForm(){this.addEquipmentForm=this.fb.group({equipmentName:["",a.kI.required],equipmentDescription:[]})}onSubmit(){this.branch&&this.addEquipmentForm?.valid&&this.parametersToAdd&&this.httpService.post(p.G.equipmentApi,{branchId:this.branch.id,customerId:this.branch.customerId,description:this.addEquipmentForm.controls.equipmentDescription.value,name:this.addEquipmentForm.controls.equipmentName.value,parameters:this.parametersToAdd}).subscribe(t=>this.activeModal.close(t))}setAddNewParameter(n){this.addNewParameter=n}getEquipmentParameters(){this.httpService.get(p.G.equipmentParametersApi).subscribe(n=>this.allEquipmentParameters=n)}onNewParameterAdded(n){console.log(n),this.parametersToAdd=[...this.parametersToAdd,n]}static#e=this.\u0275fac=function(t){return new(t||w)(e.Y36(u.Kz),e.Y36(a.qu),e.Y36(m.O))};static#t=this.\u0275cmp=e.Xpm({type:w,selectors:[["app-add-equipment-modal"]],inputs:{branch:"branch"},decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"btn","btn-outline-primary",3,"disabled","click"],[3,"formGroup","ngSubmit"],[1,"row","g-2"],[1,"col-12"],["for","equipmentName",1,"form-label"],["type","text","id","equipmentName","formControlName","equipmentName",1,"form-control"],["for","equipmentDescription",1,"form-label"],["id","equipmentDescription","formControlName","equipmentDescription",1,"form-control"],[1,"row","g-2","mt-2"],["class","technical-params d-flex",4,"ngIf"],[3,"existingParameters","parametersToFilter","newParameterAddedEvent"],[1,"technical-params","d-flex"],["class","technical-params--param",3,"ngClass",4,"ngFor","ngForOf"],[1,"technical-params--param",3,"ngClass"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Agregar Nuevo equipo"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.activeModal.close()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4),e.YNc(7,re,15,4,"form",5),e.qZA(),e.TgZ(8,"div",6)(9,"button",7),e.NdJ("click",function(){return r.activeModal.close()}),e._uU(10,"Cerrar"),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return r.onSubmit()}),e._uU(12,"Guardar"),e.qZA()()),2&t&&(e.xp6(7),e.Q6J("ngIf",r.addEquipmentForm),e.xp6(4),e.Q6J("disabled",!r.addEquipmentForm.valid))},dependencies:[s.mk,s.sg,s.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,X.d],styles:[".technical-params--param[_ngcontent-%COMP%]{margin-right:.5rem}.technical-params--param.last-child[_ngcontent-%COMP%]{margin-right:none}.technical-params--param.last-child[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}"]})}var W=d(1875),D=d(7281);function oe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-dropdown",13),e.NdJ("onSelectOptionEvent",function(i){e.CHM(t);const c=e.oxw(2);return e.KtG(c.onSelectItem(i,1))}),e.ALo(1,"toDropdownItem"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("label","Equipo")("options",e.xi3(1,2,t.branch.equipment,"equipment"))}}function ie(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-dropdown",13),e.NdJ("onSelectOptionEvent",function(i){e.CHM(t);const c=e.oxw(2);return e.KtG(c.onSelectItem(i,2))}),e.ALo(1,"toDropdownItem"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("label","Tipo de trabajo")("options",e.lcZ(1,2,t.workOrderTypes))}}function ae(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-dropdown",13),e.NdJ("onSelectOptionEvent",function(i){e.CHM(t);const c=e.oxw(2);return e.KtG(c.onSelectItem(i,3))}),e.ALo(1,"toDropdownItem"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("label","Asignado a")("options",e.xi3(1,2,t.employees,"employee"))}}function ce(o,n){if(1&o&&(e.TgZ(0,"div",2)(1,"div",3)(2,"p",4)(3,"b"),e._uU(4,"Cliente:"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"div",3)(7,"p",4)(8,"b"),e._uU(9,"Sucursal:"),e.qZA(),e._uU(10),e.qZA()(),e.TgZ(11,"div",5)(12,"label",6),e._uU(13,"C\xf3digo GMC"),e.qZA(),e._UZ(14,"input",7),e.qZA(),e.TgZ(15,"div",5)(16,"label",6),e._uU(17,"C\xf3digo OT cliente"),e.qZA(),e._UZ(18,"input",8),e.qZA(),e.TgZ(19,"div",9),e.YNc(20,oe,2,5,"app-dropdown",10),e.qZA(),e.TgZ(21,"div",9),e.YNc(22,ie,2,4,"app-dropdown",10),e.qZA(),e.TgZ(23,"div",9),e.YNc(24,ae,2,5,"app-dropdown",10),e.qZA(),e.TgZ(25,"div",11)(26,"div")(27,"label",6),e._uU(28,"Trabajo a realizar"),e.qZA(),e._UZ(29,"textarea",12),e.qZA()()()),2&o){const t=e.oxw();e.xp6(5),e.hij(" ",t.branch.customerName,""),e.xp6(5),e.hij(" ",t.branch.name,""),e.xp6(10),e.Q6J("ngIf",t.branch.equipment&&t.branch.equipment.length),e.xp6(2),e.Q6J("ngIf",t.workOrderTypes),e.xp6(2),e.Q6J("ngIf",t.employees)}}class g{constructor(n,t){this.httpService=n,this.fb=t,this.woEvent=new e.vpe}ngOnInit(){this.initWorkOrderForm(),this.getWorkOrderTypes(),this.getEmployees()}getWorkOrderTypes(){this.httpService.get(p.G.workOrderTypesApi).subscribe(n=>this.workOrderTypes=n)}getEmployees(){this.httpService.get(p.G.userEmployeesApi).subscribe(n=>this.employees=n)}initWorkOrderForm(){this.workOrderForm=this.fb.group({assignedUserId:[null,a.kI.required],customerCode:[],internalCode:[],equipmentId:[null],workOrderDescription:[""],workOrderTypeId:[null,a.kI.required]})}onSelectItem(n,t){if(this.workOrderForm)switch(t){case 1:this.workOrderForm.patchValue({equipmentId:n.id});break;case 2:this.workOrderForm.patchValue({workOrderTypeId:n.id});break;case 3:this.workOrderForm.patchValue({assignedUserId:n.id})}}emitWOInfo(){if(!this.branch||!this.workOrderForm||!this.workOrderForm.valid)return;const n={assignedUserId:this.workOrderForm.controls.assignedUserId.value,branchId:this.branch.id.toString(),customerId:this.branch.customerId.toString(),customerCode:this.workOrderForm.controls.customerCode.value,equipmentId:this.workOrderForm.controls.equipmentId.value,internalCode:this.workOrderForm.controls.internalCode.value,workOrderTypeId:this.workOrderForm.controls.workOrderTypeId.value,workOrderDescription:this.workOrderForm.controls.workOrderDescription.value};this.woEvent.emit(n)}static#e=this.\u0275fac=function(t){return new(t||g)(e.Y36(m.O),e.Y36(a.qu))};static#t=this.\u0275cmp=e.Xpm({type:g,selectors:[["app-add-work-order-form"]],inputs:{branch:"branch"},outputs:{woEvent:"woEvent"},decls:2,vars:2,consts:[[1,"mb-3",3,"formGroup"],["class","row g-3",4,"ngIf"],[1,"row","g-3"],[1,"col-sm-6"],[1,"m-0"],[1,"col-lg-6"],[1,"form-label"],["type","text","formControlName","internalCode",1,"form-control"],["type","text","formControlName","customerCode",1,"form-control"],[1,"col-lg-4","col-sm-6"],[3,"label","options","onSelectOptionEvent",4,"ngIf"],[1,"col-12"],["id","workOrderDescription","formControlName","workOrderDescription",1,"form-control"],[3,"label","options","onSelectOptionEvent"]],template:function(t,r){1&t&&(e.TgZ(0,"form",0),e.YNc(1,ce,30,5,"div",1),e.qZA()),2&t&&(e.Q6J("formGroup",r.workOrderForm),e.xp6(1),e.Q6J("ngIf",r.branch))},dependencies:[s.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,W.J,D.s]})}var j=d(1894);function se(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"ngx-dropzone-image-preview",12),e.NdJ("removed",function(){const c=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.onRemoveFile(c))}),e.qZA()}2&o&&e.Q6J("file",n.$implicit)("removable",!0)}class q{constructor(n,t){this.activeModal=n,this.httpService=t,this.files=[]}onSelectFile(n){this.files.push(...n.addedFiles)}onRemoveFile(n){this.files=this.files.filter(t=>t!=n)}onSaveWO(n){const t=new FormData;n.equipmentId&&t.append("equipmentId",n.equipmentId),t.append("assignedUserId",n.assignedUserId),t.append("branchId",n.branchId),t.append("customerId",n.customerId),t.append("workOrderTypeId",n.workOrderTypeId),n.customerCode&&t.append("customerCode",n.customerCode),n.workOrderDescription&&t.append("workOrderDescription",n.workOrderDescription),n.internalCode&&t.append("internalCode",n.internalCode),this.files.map(r=>{t.append("files",r)}),this.httpService.post("WorkOrder",t).subscribe(r=>this.activeModal.close(r))}static#e=this.\u0275fac=function(t){return new(t||q)(e.Y36(u.Kz),e.Y36(m.O))};static#t=this.\u0275cmp=e.Xpm({type:q,selectors:[["app-add-work-order-modal"]],viewQuery:function(t,r){if(1&t&&e.Gf(g,5),2&t){let i;e.iGM(i=e.CRH())&&(r.addWorkOrderForm=i.first)}},inputs:{branch:"branch"},decls:19,vars:3,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"branch","woEvent"],[1,"text-center","mt-3"],[3,"accept","change"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],["type","button",1,"btn","btn-outline-primary",3,"click"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"Nueva Orden de trabajo"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.activeModal.close()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"app-add-work-order-form",5),e.NdJ("woEvent",function(c){return r.onSaveWO(c)}),e.qZA(),e.TgZ(8,"h2",6),e._uU(9,"A\xf1adir im\xe1genes"),e.qZA(),e.TgZ(10,"ngx-dropzone",7),e.NdJ("change",function(c){return r.onSelectFile(c)}),e.TgZ(11,"ngx-dropzone-label"),e._uU(12,"Haga click o arrastre hasta aqu\xed para a\xf1adir archivos"),e.qZA(),e.YNc(13,se,1,2,"ngx-dropzone-image-preview",8),e.qZA()(),e.TgZ(14,"div",9)(15,"button",10),e.NdJ("click",function(){return r.activeModal.close()}),e._uU(16,"Cerrar"),e.qZA(),e.TgZ(17,"button",11),e.NdJ("click",function(){return r.addWorkOrderForm.emitWOInfo()}),e._uU(18,"Guardar"),e.qZA()()),2&t&&(e.xp6(7),e.Q6J("branch",r.branch),e.xp6(3),e.Q6J("accept","image/*"),e.xp6(3),e.Q6J("ngForOf",r.files))},dependencies:[s.sg,j._f,j.NP,j.sv,g]})}var f=d(2687),v=d(1458),R=d(8073),k=d(3741),z=d(1066);function de(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",4),e.NdJ("click",function(){const c=e.CHM(t).$implicit,_=e.oxw(2);return e.KtG(_.onRowClicked(c))}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"workState"),e.qZA()()}if(2&o){const t=n.$implicit;e.xp6(2),e.hij(" ",t.workOrderId," "),e.xp6(2),e.hij(" ",e.lcZ(5,3,t.createdOn)," "),e.xp6(3),e.hij(" ",e.lcZ(8,5,t.workState)," ")}}function pe(o,n){if(1&o&&(e.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th"),e._uU(4," Id "),e.qZA(),e.TgZ(5,"th"),e._uU(6," Fecha de creaci\xf3n "),e.qZA(),e.TgZ(7,"th"),e._uU(8," Estado "),e.qZA()()(),e.TgZ(9,"tbody"),e.YNc(10,de,9,7,"tr",3),e.qZA()()),2&o){const t=e.oxw();e.xp6(10),e.Q6J("ngForOf",t.items)}}function me(o,n){1&o&&(e.TgZ(0,"p",5),e._uU(1," No se encontraron elementos\n"),e.qZA())}class b{constructor(n){this.router=n}onRowClicked(n){this.router.navigateByUrl(`customers/work-order/${n.workOrderId}`)}static#e=this.\u0275fac=function(t){return new(t||b)(e.Y36(l.F0))};static#t=this.\u0275cmp=e.Xpm({type:b,selectors:[["app-work-orders-table"]],inputs:{items:"items"},decls:2,vars:2,consts:[["class","table table-hover",4,"ngIf"],["class","text-center mt-3",4,"ngIf"],[1,"table","table-hover"],["role","button",3,"click",4,"ngFor","ngForOf"],["role","button",3,"click"],[1,"text-center","mt-3"]],template:function(t,r){1&t&&(e.YNc(0,pe,11,1,"table",0),e.YNc(1,me,2,0,"p",1)),2&t&&(e.Q6J("ngIf",r.items&&r.items.length),e.xp6(1),e.Q6J("ngIf",r.items&&!r.items.length))},dependencies:[s.sg,s.O5,s.uU,z.$]})}class C{constructor(n){this.fb=n,this.cancelEditingBranchEvent=new e.vpe,this.updateBranchEvent=new e.vpe}ngOnInit(){this.editBranchForm=this.fb.group({branchName:[this.branch.name,a.kI.required],branchCode:[this.branch.code]})}onSubmit(){if(!this.branch)return;const n={...this.branch,name:this.editBranchForm?.controls.branchName.value,code:this.editBranchForm?.controls.branchCode.value};this.updateBranchEvent.emit(n)}static#e=this.\u0275fac=function(t){return new(t||C)(e.Y36(a.qu))};static#t=this.\u0275cmp=e.Xpm({type:C,selectors:[["app-edit-branch"]],inputs:{branch:"branch"},outputs:{cancelEditingBranchEvent:"cancelEditingBranchEvent",updateBranchEvent:"updateBranchEvent"},decls:16,vars:3,consts:[[3,"formGroup","ngSubmit"],[1,"row","justify-content-center"],[1,"col-sm-6"],["for","branchName",1,"form-label"],["type","text","id","branchName","formControlName","branchName",1,"form-control",3,"placeholder"],["for","branchCode",1,"form-label"],["type","text","id","branchCode","formControlName","branchCode",1,"form-control"],[1,"row","mt-3"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","btn-outline-primary","me-2",3,"disabled"],["type","button",1,"btn","btn-outline-danger",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return r.editBranchForm.valid&&r.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4,"Nombre de la sucursal"),e.qZA(),e._UZ(5,"input",4),e.qZA(),e.TgZ(6,"div",2)(7,"label",5),e._uU(8,"C\xf3digo"),e.qZA(),e._UZ(9,"input",6),e.qZA()(),e.TgZ(10,"div",7)(11,"div",8)(12,"button",9),e._uU(13,"Guardar"),e.qZA(),e.TgZ(14,"button",10),e.NdJ("click",function(){return r.cancelEditingBranchEvent.emit()}),e._uU(15,"Cancelar"),e.qZA()()()()),2&t&&(e.Q6J("formGroup",r.editBranchForm),e.xp6(5),e.Q6J("placeholder",r.branch.name),e.xp6(7),e.Q6J("disabled",!r.editBranchForm.dirty))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}var K=d(5090),H=d(2368);function le(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij("\xa0(",t.branch.code,")")}}function ue(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-model",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.setEditingBranch(!0))}),e.qZA()}}function _e(o,n){if(1&o&&(e.TgZ(0,"h1",11),e._uU(1),e.YNc(2,le,2,1,"span",12),e.YNc(3,ue,1,0,"app-edit-model",13),e.ALo(4,"userRoles"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.branch.name,""),e.xp6(1),e.Q6J("ngIf",t.branch.code),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,3,t.userRoles.CustomersAdmin))}}function he(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-branch",15),e.NdJ("cancelEditingBranchEvent",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.setEditingBranch(!1))})("updateBranchEvent",function(i){e.CHM(t);const c=e.oxw(2);return e.KtG(c.onUpdateBranch(i))}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("branch",t.branch)}}function fe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onOpenAddEquipmentModal())}),e._uU(1," Agregar nuevo equipo "),e.qZA()}}function ge(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onOpenAddWorkOrder())}),e._uU(1,"Agregar nueva OT"),e.qZA()}}function ve(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e.YNc(2,_e,5,5,"h1",3),e.YNc(3,he,1,1,"app-edit-branch",4),e.TgZ(4,"div",5)(5,"h5",6),e._uU(6,"Equipos"),e.qZA(),e.TgZ(7,"div",7),e.YNc(8,fe,2,0,"button",8),e.ALo(9,"userRoles"),e.qZA(),e.TgZ(10,"app-items-list",9),e.NdJ("rowClickedEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.navigateToEquipment(i))}),e.ALo(11,"toItemList"),e.qZA()(),e.TgZ(12,"div",5)(13,"h5",6),e._uU(14,"\xd3rdenes de trabajo"),e.qZA(),e.TgZ(15,"div",7),e.YNc(16,ge,2,0,"button",8),e.ALo(17,"userRoles"),e.qZA(),e._UZ(18,"app-work-orders-table",10),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.editingBranch),e.xp6(1),e.Q6J("ngIf",t.editingBranch),e.xp6(5),e.Q6J("ngIf",e.lcZ(9,6,t.userRoles.CustomersAdmin)),e.xp6(2),e.Q6J("items",e.xi3(11,8,t.branch.equipment,"equipment")),e.xp6(6),e.Q6J("ngIf",e.lcZ(17,11,t.userRoles.CustomersAdmin)),e.xp6(2),e.Q6J("items",t.branch.workOrders)}}class x{constructor(n,t,r,i){this.route=n,this.httpService=t,this.modalService=r,this.router=i,this.faEdit=f.Xcf,this.editingBranch=!1,this.userRoles=v.v}ngOnInit(){this.getBranch()}getBranch(){const n=this.route.snapshot.paramMap.get("branchId");this.httpService.get(`Branches?branchId=${n}`).subscribe(t=>this.branch=t)}onOpenAddEquipmentModal(){this.modalRef=this.modalService.open(w,{size:"lg"}),this.modalRef.componentInstance.branch=this.branch,this.modalRef.closed.subscribe(n=>n&&this.getBranch())}onOpenAddWorkOrder(){this.modalRef=this.modalService.open(q,{size:"lg"}),this.modalRef.componentInstance.branch=this.branch,this.modalRef.closed.subscribe(n=>n&&this.getBranch())}navigateToEquipment(n){this.router.navigateByUrl(`customers/equipment/${n.id}`)}setEditingBranch(n){this.editingBranch=n}onUpdateBranch(n){this.httpService.put(`${p.G.branchesApi}`,{id:n.id,code:n.code,name:n.name}).subscribe(()=>{this.getBranch(),this.setEditingBranch(!1)})}static#e=this.\u0275fac=function(t){return new(t||x)(e.Y36(l.gz),e.Y36(m.O),e.Y36(u.FF),e.Y36(l.F0))};static#t=this.\u0275cmp=e.Xpm({type:x,selectors:[["app-branch-detail"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"row","mt-3"],["class","text-center d-flex justify-content-center align-items-center",4,"ngIf"],[3,"branch","cancelEditingBranchEvent","updateBranchEvent",4,"ngIf"],[1,"col-lg-6","mt-3"],[1,"text-center"],[1,"text-center","mt-3"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[3,"items","rowClickedEvent"],[3,"items"],[1,"text-center","d-flex","justify-content-center","align-items-center"],[4,"ngIf"],[3,"click",4,"ngIf"],[3,"click"],[3,"branch","cancelEditingBranchEvent","updateBranchEvent"],[1,"btn","btn-outline-primary",3,"click"]],template:function(t,r){1&t&&e.YNc(0,ve,19,13,"div",0),2&t&&e.Q6J("ngIf",r.branch)},dependencies:[s.O5,R.H,k.D,b,C,K.R,H.Y]})}function be(o,n){if(1&o&&(e.TgZ(0,"form",9)(1,"div",10)(2,"label",11),e._uU(3,"Nombre"),e.qZA(),e._UZ(4,"input",12),e.qZA(),e.TgZ(5,"div",10)(6,"label",13),e._uU(7,"C\xf3digo"),e.qZA(),e._UZ(8,"input",14),e.qZA()()),2&o){const t=e.oxw();e.Q6J("formGroup",t.addBranchForm)}}class O{constructor(n,t,r){this.activeModal=n,this.fb=t,this.httpService=r}ngOnInit(){this.initForm()}initForm(){this.addBranchForm=this.fb.group({branchName:["",a.kI.required],branchCode:[""]})}onSubmit(){this.httpService.post("Branches",{id:0,name:this.addBranchForm.controls.branchName.value,code:this.addBranchForm.controls.branchCode.value,customerId:this.customer.id}).subscribe(t=>{this.activeModal.close(!0)})}static#e=this.\u0275fac=function(t){return new(t||O)(e.Y36(u.Kz),e.Y36(a.qu),e.Y36(m.O))};static#t=this.\u0275cmp=e.Xpm({type:O,selectors:[["app-add-branch-modal"]],inputs:{customer:"customer"},decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark","me-2",3,"click"],["type","button",1,"btn","btn-outline-primary",3,"disabled","click"],[3,"formGroup"],[1,"mb-3"],["for","branchName",1,"form-label"],["type","text","id","branchName","formControlName","branchName",1,"form-control"],["for","branchCode",1,"form-label"],["type","text","id","branchCode","formControlName","branchCode",1,"form-control"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Agregar Nueva sucursal"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.activeModal.close(!1)}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4),e.YNc(7,be,9,1,"form",5),e.qZA(),e.TgZ(8,"div",6)(9,"button",7),e.NdJ("click",function(){return r.activeModal.close(!1)}),e._uU(10,"Cerrar"),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return r.onSubmit()}),e._uU(12,"Guardar"),e.qZA()()),2&t&&(e.xp6(7),e.Q6J("ngIf",r.addBranchForm),e.xp6(4),e.Q6J("disabled",!r.addBranchForm.valid))},dependencies:[s.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}var h=d(2771),we=d(6709);class E{constructor(n){this.fb=n,this.cancelEditingEvent=new e.vpe,this.updateEvent=new e.vpe}ngOnInit(){this.initForm()}initForm(){!this.customer||(this.editForm=this.fb.group({customerName:[this.customer.name,a.kI.required]}))}onSubmit(){if(!this.editForm||!this.editForm.valid)return;const n={...this.customer,name:this.editForm.controls.customerName.value};this.updateEvent.emit(n)}static#e=this.\u0275fac=function(t){return new(t||E)(e.Y36(a.qu))};static#t=this.\u0275cmp=e.Xpm({type:E,selectors:[["app-edit-customer"]],inputs:{customer:"customer"},outputs:{cancelEditingEvent:"cancelEditingEvent",updateEvent:"updateEvent"},decls:12,vars:3,consts:[[3,"formGroup","ngSubmit"],[1,"row","justify-content-center"],[1,"col-sm-6"],["for","customerName",1,"form-label"],["type","text","id","customerName","formControlName","customerName",1,"form-control",3,"placeholder"],[1,"row","mt-3"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","btn-outline-primary","me-2",3,"disabled"],["type","button",1,"btn","btn-outline-danger",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return r.editForm.valid&&r.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4,"Nombre del cliente"),e.qZA(),e._UZ(5,"input",4),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"button",7),e._uU(9,"Guardar"),e.qZA(),e.TgZ(10,"button",8),e.NdJ("click",function(){return r.cancelEditingEvent.emit()}),e._uU(11,"Cancelar"),e.qZA()()()()),2&t&&(e.Q6J("formGroup",r.editForm),e.xp6(5),e.Q6J("placeholder",r.customer.name),e.xp6(3),e.Q6J("disabled",!r.editForm.dirty))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}var qe=d(6785);function ke(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-model",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.setEditingCustomer(!0))}),e.qZA()}}function Ce(o,n){if(1&o&&(e.TgZ(0,"h1",8),e._uU(1),e.YNc(2,ke,1,0,"app-edit-model",9),e.ALo(3,"userRoles"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.customer.name," "),e.xp6(1),e.Q6J("ngIf",e.lcZ(3,2,t.userRoles.CustomersAdmin))}}function xe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-customer",11),e.NdJ("cancelEditingEvent",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.setEditingCustomer(!1))})("updateEvent",function(i){e.CHM(t);const c=e.oxw(2);return e.KtG(c.onUpdateCustomer(i))}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("customer",t.customer)}}function Oe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"button",13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onOpenAddBranchModal())}),e._uU(2,"Agregar nueva sucursal"),e.qZA()()}}function Ee(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e.YNc(2,Ce,4,4,"h1",3),e.YNc(3,xe,1,1,"app-edit-customer",4),e.YNc(4,Oe,3,0,"div",5),e.ALo(5,"userRoles"),e.TgZ(6,"div",6)(7,"app-table",7),e.NdJ("rowClickedEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.onBranchClicked(i))}),e.ALo(8,"toTableData"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.editingCustomer),e.xp6(1),e.Q6J("ngIf",t.editingCustomer),e.xp6(1),e.Q6J("ngIf",e.lcZ(5,4,t.userRoles.CustomersAdmin)),e.xp6(3),e.Q6J("tableData",e.xi3(8,6,t.customer.branches,"branch"))}}class Z{constructor(n,t,r,i){this.route=n,this.httpService=t,this.modalService=r,this.router=i,this.editingCustomer=!1,this.userRoles=v.v}ngOnInit(){this.getCustomer()}getCustomer(){const n=this.route.snapshot.paramMap.get("id");this.httpService.get(`Customers/${n}`).subscribe(t=>this.customer=t)}onOpenAddBranchModal(){this.modalRef=this.modalService.open(O),this.modalRef.componentInstance.customer=this.customer,this.modalRef.closed.subscribe(n=>n&&this.getCustomer())}setEditingCustomer(n){this.editingCustomer=n}onUpdateCustomer(n){this.httpService.put(`${p.G.customersApi}/${n.id}`,n).subscribe(()=>{this.getCustomer(),this.setEditingCustomer(!1)})}onBranchClicked(n){this.router.navigateByUrl(`/${h.p7.customersPath}/${this.customer.id}/${h.p7.branchPath}/${n.id}`)}static#e=this.\u0275fac=function(t){return new(t||Z)(e.Y36(l.gz),e.Y36(m.O),e.Y36(u.FF),e.Y36(l.F0))};static#t=this.\u0275cmp=e.Xpm({type:Z,selectors:[["app-customer-detail"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"row","mt-3"],["class","text-center d-flex justify-content-center align-items-center",4,"ngIf"],[3,"customer","cancelEditingEvent","updateEvent",4,"ngIf"],["class","text-center mt-3",4,"ngIf"],[1,"col","mt-3"],[3,"tableData","rowClickedEvent"],[1,"text-center","d-flex","justify-content-center","align-items-center"],[3,"click",4,"ngIf"],[3,"click"],[3,"customer","cancelEditingEvent","updateEvent"],[1,"text-center","mt-3"],[1,"btn","btn-outline-primary",3,"click"]],template:function(t,r){1&t&&e.YNc(0,Ee,9,9,"div",0),2&t&&e.Q6J("ngIf",r.customer)},dependencies:[s.O5,k.D,we.a,E,qe.O,H.Y]})}var Ze=d(860);function Te(o,n){if(1&o&&(e.TgZ(0,"form",9)(1,"div",10)(2,"label",11),e._uU(3,"Nombre"),e.qZA(),e._UZ(4,"input",12),e.qZA()()),2&o){const t=e.oxw();e.Q6J("formGroup",t.addCustomerForm)}}class T{constructor(n,t,r){this.activeModal=n,this.fb=t,this.httpService=r}ngOnInit(){this.initForm()}initForm(){this.addCustomerForm=this.fb.group({customerName:["",a.kI.required]})}onSubmit(){this.httpService.post("Customers",{name:this.addCustomerForm.controls.customerName.value}).subscribe(t=>{this.activeModal.close(t)})}static#e=this.\u0275fac=function(t){return new(t||T)(e.Y36(u.Kz),e.Y36(a.qu),e.Y36(m.O))};static#t=this.\u0275cmp=e.Xpm({type:T,selectors:[["app-add-customer-modal"]],decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"btn","btn-outline-primary",3,"disabled","click"],[3,"formGroup"],[1,"mb-3"],["for","customerName",1,"form-label"],["type","text","id","customerName","formControlName","customerName",1,"form-control"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Agregar Nuevo cliente"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.activeModal.dismiss()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4),e.YNc(7,Te,5,1,"form",5),e.qZA(),e.TgZ(8,"div",6)(9,"button",7),e.NdJ("click",function(){return r.activeModal.close()}),e._uU(10,"Cerrar"),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return r.onSubmit()}),e._uU(12,"Guardar"),e.qZA()()),2&t&&(e.xp6(7),e.Q6J("ngIf",r.addCustomerForm),e.xp6(4),e.Q6J("disabled",!r.addCustomerForm.valid))},dependencies:[s.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}function Ae(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"button",6),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onOpenAddCustomerModal())}),e._uU(2,"Agregar nuevo cliente"),e.qZA()()}}class A{constructor(n,t,r){this.modalService=n,this.httpService=t,this.router=r,this.listActions=Ze.D,this.userRoles=v.v}ngOnInit(){this.getCustomers()}getCustomers(){this.httpService.get("Customers").subscribe(n=>this.customers=n)}onOpenAddCustomerModal(){this.modalRef=this.modalService.open(T),this.modalRef.closed.subscribe(n=>n&&this.getCustomers())}goToBranch(n){this.router.navigateByUrl(`customers/customer/${n.id}`)}updateCustomers(n){if(!n)return;const t=this.customers.findIndex(r=>r.id==n.id);this.customers?.splice(t,1,n),this.customers=Object.assign([],this.customers)}static#e=this.\u0275fac=function(t){return new(t||A)(e.Y36(u.FF),e.Y36(m.O),e.Y36(l.F0))};static#t=this.\u0275cmp=e.Xpm({type:A,selectors:[["app-customers"]],decls:9,vars:7,consts:[[1,"container"],[1,"text-center","mt-3"],["class","text-center mt-3",4,"ngIf"],[1,"row","mt-3"],[1,"col"],[3,"items","rowClickedEvent"],[1,"btn","btn-outline-primary",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Clientes"),e.qZA(),e.YNc(3,Ae,3,0,"div",2),e.ALo(4,"userRoles"),e.TgZ(5,"div",3)(6,"div",4)(7,"app-items-list",5),e.NdJ("rowClickedEvent",function(c){return r.goToBranch(c)}),e.ALo(8,"toItemList"),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("ngIf",e.lcZ(4,2,r.userRoles.CustomersAdmin)),e.xp6(4),e.Q6J("items",e.xi3(8,4,r.customers,"customer")))},dependencies:[s.O5,R.H,K.R,H.Y]})}function Ie(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-model",2),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.editButtonClickedEvent.emit())}),e.qZA()}}class I{constructor(){this.editButtonClickedEvent=new e.vpe}static#e=this.\u0275fac=function(t){return new(t||I)};static#t=this.\u0275cmp=e.Xpm({type:I,selectors:[["app-section-title"]],inputs:{title:"title",editableSection:"editableSection"},outputs:{editButtonClickedEvent:"editButtonClickedEvent"},decls:3,vars:2,consts:[[1,"mt-3","d-flex","justify-content-center","align-items-center"],[3,"click",4,"ngIf"],[3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.YNc(2,Ie,1,0,"app-edit-model",1),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",r.title," "),e.xp6(1),e.Q6J("ngIf",r.editableSection))},dependencies:[s.O5,k.D]})}var V=d(7185),L=d(2216);function Ne(o,n){if(1&o&&(e.TgZ(0,"label",5),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.uIk("for","dropdown-input-"+t.componentId),e.xp6(1),e.Oqu(t.label)}}function Fe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"li",13),e.NdJ("click",function(){const c=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.selectItemEvent.emit(c))}),e._uU(1),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function ye(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",10),e.NdJ("input",function(i){e.CHM(t);const c=e.oxw(2);return e.KtG(c.filterParameters(i))}),e.qZA(),e.TgZ(2,"ul",11),e.YNc(3,Fe,2,1,"li",12),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.filteredOptions)}}function Je(o,n){1&o&&(e.TgZ(0,"ul",11)(1,"li",14),e._uU(2," No hay elementos "),e.qZA()())}function Ue(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",15),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.addNewItemEvent.emit())}),e.TgZ(1,"button",16),e._uU(2),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.showAddNewItemButtonText?t.showAddNewItemButtonText:"A\xf1adir nuevo elemento"," ")}}function Pe(o,n){if(1&o&&(e.TgZ(0,"div",6),e.YNc(1,ye,4,1,"ng-container",7),e.YNc(2,Je,3,0,"ng-template",null,8,e.W1O),e.YNc(4,Ue,3,1,"div",9),e.qZA()),2&o){const t=e.MAs(3),r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.filteredOptions.length)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",r.showAddNewItemButton)}}class N{constructor(){this.componentId=Math.random().toString(36).slice(-6),this.showDropdownList=!1,this.showAddNewItemButton=!1,this.selectItemEvent=new e.vpe,this.addNewItemEvent=new e.vpe}ngOnChanges(){this.options&&(this.filteredOptions=this.options)}filterParameters(n){this.filteredOptions=!n.target.value||n.target.value.length<2?this.options:this.options?.filter(t=>t.name.toLocaleLowerCase().includes(n.target.value.toLocaleLowerCase()))}toggleShowDropdownList(){this.showDropdownList=!this.showDropdownList}static#e=this.\u0275fac=function(t){return new(t||N)};static#t=this.\u0275cmp=e.Xpm({type:N,selectors:[["app-dropdown-input"]],inputs:{label:"label",buttonText:"buttonText",options:"options",showAddNewItemButton:"showAddNewItemButton",showAddNewItemButtonText:"showAddNewItemButtonText"},outputs:{selectItemEvent:"selectItemEvent",addNewItemEvent:"addNewItemEvent"},features:[e.TTD],decls:6,vars:3,consts:[[1,"dropdown-intput"],["class","form-label",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary","dropdown-toggle",3,"click"],[1,"caret"],["class","dropdown-input--options",4,"ngIf"],[1,"form-label"],[1,"dropdown-input--options"],[4,"ngIf","ngIfElse"],["noOptions",""],["class","d-flex justify-content-center mt-1",3,"click",4,"ngIf"],["type","text","placeholder","Buscar par\xe1metro",1,"form-control","form-control-sm",3,"input"],[1,"list-group","list-group-flush"],["class","list-group-item","role","button",3,"click",4,"ngFor","ngForOf"],["role","button",1,"list-group-item",3,"click"],[1,"list-group-item"],[1,"d-flex","justify-content-center","mt-1",3,"click"],[1,"btn","btn-sm","btn-outline-primary"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Ne,2,2,"label",1),e.TgZ(2,"button",2),e.NdJ("click",function(){return r.toggleShowDropdownList()}),e._uU(3),e._UZ(4,"span",3),e.qZA(),e.YNc(5,Pe,5,3,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",r.label),e.xp6(2),e.hij(" ",r.buttonText," "),e.xp6(2),e.Q6J("ngIf",r.showDropdownList))},dependencies:[s.sg,s.O5],styles:[".dropdown-input--options[_ngcontent-%COMP%]{padding:.2rem;border:1px solid #ced4da;border-radius:.375rem;max-height:200px;overflow:auto}.dropdown-input--options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:.25rem}.dropdown-input--options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding-left:.5rem;font-size:.8rem}.dropdown-input--options[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#c8c8c833}"]})}function Se(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"form",1)(1,"div",2)(2,"h5"),e._uU(3,"Nuevo par\xe1metro"),e.qZA(),e.TgZ(4,"div",3)(5,"label",4),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",5),e.qZA(),e.TgZ(8,"div",3)(9,"label",4),e._uU(10,"Magnitud"),e.qZA(),e.TgZ(11,"app-dropdown",6),e.NdJ("onSelectOptionEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.setMeasurementUnitValue(i))}),e.ALo(12,"toDropdownItem"),e.qZA()(),e.TgZ(13,"div",7)(14,"label",4),e._uU(15,"Valor"),e.qZA(),e._UZ(16,"input",8),e.qZA(),e.TgZ(17,"div",9)(18,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addNewEquipmenParameter())}),e._UZ(19,"fa-icon",11),e.qZA(),e.TgZ(20,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelAddNewParameterEvent.emit())}),e._UZ(21,"fa-icon",11),e.qZA()()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.equipmentParameterForm),e.xp6(11),e.Q6J("options",e.xi3(12,5,t.measurementUnits,"measurementUnits")),e.xp6(7),e.Q6J("disabled",t.equipmentParameterForm.invalid),e.xp6(1),e.Q6J("icon",t.faCheck),e.xp6(2),e.Q6J("icon",t.faX)}}class F{constructor(n,t){this.httpService=n,this.fb=t,this.faCheck=f.LEp,this.faX=f.EOp,this.cancelAddNewParameterEvent=new e.vpe,this.addNewEquipmentParameterEvent=new e.vpe}ngOnInit(){this.getMeasurementUnits(),this.initForm()}initForm(){this.equipmentParameterForm=this.fb.group({equipmentParameterName:["",a.kI.required],measurementUnit:[null,a.kI.required],parameterValue:[null,a.kI.required]})}getMeasurementUnits(){this.httpService.get(p.G.measurementUnitsApi).subscribe(n=>this.measurementUnits=n)}addNewEquipmenParameter(){this.equipmentParameterForm.invalid||this.addNewEquipmentParameterEvent.emit({id:0,name:this.equipmentParameterForm.controls.equipmentParameterName.value,measurementUnitId:this.equipmentParameterForm.controls.measurementUnit.value.measurementUnitId,measurementUnitSymbol:this.equipmentParameterForm.controls.measurementUnit.value.symbol,parameterValue:this.equipmentParameterForm.controls.parameterValue.value})}setMeasurementUnitValue(n){this.equipmentParameterForm.patchValue({measurementUnit:this.measurementUnits.find(t=>t.measurementUnitId==n.id)})}static#e=this.\u0275fac=function(t){return new(t||F)(e.Y36(m.O),e.Y36(a.qu))};static#t=this.\u0275cmp=e.Xpm({type:F,selectors:[["app-add-new-equipment-parameter"]],outputs:{cancelAddNewParameterEvent:"cancelAddNewParameterEvent",addNewEquipmentParameterEvent:"addNewEquipmentParameterEvent"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"row","g-2"],[1,"col-md-4"],[1,"form-label"],["type","text","formControlName","equipmentParameterName",1,"form-control"],[3,"options","onSelectOptionEvent"],[1,"col-md-2"],["type","number","formControlName","parameterValue",1,"form-control"],[1,"col-md-2","action-buttons"],["type","button",1,"btn","btn-sm","btn-outline-success","action-buttons--button","me-2",3,"disabled","click"],[3,"icon"],["type","button",1,"btn","btn-sm","btn-outline-danger","action-buttons--button",3,"click"]],template:function(t,r){1&t&&e.YNc(0,Se,22,8,"form",0),2&t&&e.Q6J("ngIf",r.equipmentParameterForm)},dependencies:[s.O5,L.BN,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.sg,a.u,W.J,D.s],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:end;padding-top:35px}.action-buttons--button[_ngcontent-%COMP%]{width:2rem;height:2rem}"]})}function Me(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-dropdown-input",3),e.NdJ("selectItemEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.onSelectItem(i))})("addNewItemEvent",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.setAddingNewParameter(!0))}),e.ALo(1,"toItemList"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("buttonText","Seleccionar par\xe1metro")("options",e.xi3(1,4,t.equipmentParameters,"equipmentParameter"))("showAddNewItemButton",!0)("showAddNewItemButtonText","A\xf1adir nuevo par\xe1metro")}}function Qe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-add-new-equipment-parameter",4),e.NdJ("cancelAddNewParameterEvent",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelAddParameterEvent.emit())})("addNewEquipmentParameterEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.addParameterEvent.emit(i))}),e.qZA()}}function Ye(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"h5"),e._uU(2,"A\xf1adir par\xe1metro"),e.qZA(),e.TgZ(3,"div",5)(4,"div",6),e._uU(5),e.qZA(),e.TgZ(6,"div",7)(7,"input",8),e.NdJ("ngModelChange",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.parameterValue=i)}),e.qZA()(),e.TgZ(8,"div",9)(9,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addEquipmentParameter())}),e._UZ(10,"fa-icon",11),e.qZA(),e.TgZ(11,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelAddParameterEvent.emit())}),e._UZ(12,"fa-icon",11),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(5),e.hij(" ",t.selectedItem.name+" | "+t.selectedItem.measurementUnitSymbol," "),e.xp6(2),e.Q6J("ngModel",t.parameterValue),e.xp6(3),e.Q6J("icon",t.faCheck),e.xp6(2),e.Q6J("icon",t.faX)}}class y{constructor(n,t){this.httpService=n,this.toastrService=t,this.selectingParameter=!0,this.faCheck=f.LEp,this.faX=f.EOp,this.addingNewParameter=!1,this.cancelAddParameterEvent=new e.vpe,this.addParameterEvent=new e.vpe}ngOnInit(){this.getEquipmentParameters()}getEquipmentParameters(){this.httpService.get(p.G.equipmentParametersApi).subscribe(n=>this.equipmentParameters=n)}onSelectItem(n){this.selectedItem=this.equipmentParameters?.find(t=>t.id==n.id),this.setSelectingParameter(!1)}setSelectingParameter(n){this.selectingParameter=n}setAddingNewParameter(n){this.setSelectingParameter(!1),this.addingNewParameter=n}addEquipmentParameter(){if(null==this.parameterValue)return void this.toastrService.error(h.aX.equipmentParameterWrongValue);const n={...this.selectedItem,parameterValue:this.parameterValue};this.addParameterEvent.emit(n)}static#e=this.\u0275fac=function(t){return new(t||y)(e.Y36(m.O),e.Y36(V._W))};static#t=this.\u0275cmp=e.Xpm({type:y,selectors:[["app-add-equipment-parameter"]],outputs:{cancelAddParameterEvent:"cancelAddParameterEvent",addParameterEvent:"addParameterEvent"},decls:3,vars:3,consts:[[3,"buttonText","options","showAddNewItemButton","showAddNewItemButtonText","selectItemEvent","addNewItemEvent",4,"ngIf"],[3,"cancelAddNewParameterEvent","addNewEquipmentParameterEvent",4,"ngIf"],[4,"ngIf"],[3,"buttonText","options","showAddNewItemButton","showAddNewItemButtonText","selectItemEvent","addNewItemEvent"],[3,"cancelAddNewParameterEvent","addNewEquipmentParameterEvent"],[1,"row","g-1"],[1,"col-6"],[1,"col-4"],["type","number","placeholder","Valor",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"col-2","d-flex","justify-content-end"],[1,"btn","btn-sm","btn-outline-success","action-button","me-2",3,"click"],[3,"icon"],[1,"btn","btn-sm","btn-outline-danger","action-button",3,"click"]],template:function(t,r){1&t&&(e.YNc(0,Me,2,7,"app-dropdown-input",0),e.YNc(1,Qe,1,0,"app-add-new-equipment-parameter",1),e.YNc(2,Ye,13,4,"div",2)),2&t&&(e.Q6J("ngIf",r.selectingParameter),e.xp6(1),e.Q6J("ngIf",r.addingNewParameter),e.xp6(1),e.Q6J("ngIf",!r.selectingParameter&&!r.addingNewParameter&&r.selectedItem))},dependencies:[s.O5,L.BN,a.Fj,a.wV,a.JJ,a.On,N,F,K.R],styles:[".action-button[_ngcontent-%COMP%]{width:2rem;height:2rem}"]})}function Be(o,n){if(1&o&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.appConstants.noEquipmentParametersFound)}}function Ge(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",18)(2,"p",19),e._uU(3),e.qZA(),e.TgZ(4,"input",20),e.NdJ("change",function(i){const _=e.CHM(t).$implicit,bt=e.oxw();return e.KtG(bt.equipmentParameterChanged(i,_.id))}),e.qZA(),e.TgZ(5,"p",21),e._uU(6),e.qZA(),e.TgZ(7,"div",22)(8,"fa-icon",23),e.NdJ("click",function(){const c=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.deleteParameter(c.name))}),e.qZA()()()()}if(2&o){const t=n.$implicit,r=e.oxw();e.xp6(3),e.hij("",t.name,": "),e.xp6(1),e.Q6J("value",t.parameterValue),e.xp6(2),e.Oqu(t.measurementUnitSymbol),e.xp6(2),e.Q6J("icon",r.faTrash)}}function We(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-add-equipment-parameter",24),e.NdJ("cancelAddParameterEvent",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.setAddingNewEquipmentParameter(!1))})("addParameterEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.addNewParameter(i))}),e.qZA()}}function De(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",15)(1,"button",25),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.setAddingNewEquipmentParameter(!0))}),e._uU(2," A\xf1adir nuevo par\xe1metro "),e.qZA()()}}class J{constructor(n,t,r){this.fb=n,this.toastrService=t,this.httpService=r,this.faTrash=f.$aW,this.addingNewEquipmentParameter=!1,this.appConstants=h.$x,this.tempEquipmentParameters=[],this.cancelEvent=new e.vpe,this.equipmentUpdatedEvent=new e.vpe}ngOnInit(){this.initForm()}initForm(){this.tempEquipmentParameters=this.equipment.equipmentParameters,this.equipmentForm=this.fb.group({equipmentId:[this.equipment.id,a.kI.required],equipmentName:[this.equipment.name,a.kI.required],equipmentDescription:[this.equipment.description],equipmentParameters:[this.tempEquipmentParameters]})}equipmentParameterChanged(n,t){const r=this.equipment.equipmentParameters.findIndex(i=>i.id==t);-1!=r&&(this.equipment.equipmentParameters[r].parameterValue=parseFloat(n.target.value),this.patchEquipmentParametersToForm())}setAddingNewEquipmentParameter(n){this.addingNewEquipmentParameter=n}addNewParameter(n){this.tempEquipmentParameters.push(n),this.patchEquipmentParametersToForm(),this.setAddingNewEquipmentParameter(!1)}deleteParameter(n){const t=this.tempEquipmentParameters.findIndex(r=>r.name==n);this.tempEquipmentParameters.splice(t,1),this.patchEquipmentParametersToForm()}patchEquipmentParametersToForm(){this.equipmentForm?.patchValue({equipmentParameters:this.tempEquipmentParameters}),this.equipmentForm.markAsDirty()}onSubmit(){this.equipmentForm.valid&&this.httpService.put(p.G.equipmentApi,{id:this.equipment.id,name:this.equipmentForm.controls.equipmentName.value,description:this.equipmentForm.controls.equipmentDescription.value,equipmentParameters:this.equipmentForm.controls.equipmentParameters.value}).subscribe(t=>this.equipmentUpdatedEvent.emit(t))}static#e=this.\u0275fac=function(t){return new(t||J)(e.Y36(a.qu),e.Y36(V._W),e.Y36(m.O))};static#t=this.\u0275cmp=e.Xpm({type:J,selectors:[["app-edit-equipment"]],inputs:{equipment:"equipment"},outputs:{cancelEvent:"cancelEvent",equipmentUpdatedEvent:"equipmentUpdatedEvent"},decls:23,vars:7,consts:[[3,"formGroup"],[1,"row"],[1,"col-sm-6"],["for","equipmentName",1,"form-label"],["type","text","id","equipmentName","formControlName","equipmentName",1,"form-control"],[1,"col-12","mt-3"],[1,"form-floating"],["id","equipmentDescription","formControlName","equipmentDescription",1,"form-control"],["for","equipmentDescription"],[1,"row","mt-3","g-2"],[1,"mb-3"],[4,"ngIf"],["class","col-sm-6",4,"ngFor","ngForOf"],[3,"cancelAddParameterEvent","addParameterEvent",4,"ngIf"],["class","d-flex justify-content-center mt-3",4,"ngIf"],[1,"d-flex","justify-content-center","mt-3"],["type","button",1,"btn","btn-outline-danger",3,"click"],["type","submit",1,"ms-2","btn","btn-outline-primary",3,"disabled","click"],[1,"parameter-card","d-flex","align-items-center"],[1,"parameter-card--name","m-0"],["type","number",1,"form-control","form-control-sm","parameter-card--value",3,"value","change"],[1,"parameter-card--symbol","m-0"],[1,"parameter-card--icon"],["role","button",3,"icon","click"],[3,"cancelAddParameterEvent","addParameterEvent"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4),e.qZA(),e._UZ(5,"input",4),e.qZA(),e.TgZ(6,"div",5)(7,"div",6),e._UZ(8,"textarea",7),e.TgZ(9,"label",8),e._uU(10,"Descripci\xf3n"),e.qZA()()()(),e.TgZ(11,"div",9)(12,"h4",10),e._uU(13,"Par\xe1metros del equipo"),e.qZA(),e.YNc(14,Be,2,1,"p",11),e.YNc(15,Ge,9,4,"div",12),e.YNc(16,We,1,0,"app-add-equipment-parameter",13),e.YNc(17,De,3,0,"div",14),e.qZA(),e.TgZ(18,"div",15)(19,"button",16),e.NdJ("click",function(){return r.cancelEvent.emit()}),e._uU(20,"Cancelar"),e.qZA(),e.TgZ(21,"button",17),e.NdJ("click",function(){return r.onSubmit()}),e._uU(22,"Guardar"),e.qZA()()()),2&t&&(e.Q6J("formGroup",r.equipmentForm),e.xp6(4),e.Oqu(r.appConstants.appName),e.xp6(10),e.Q6J("ngIf",!r.equipment.equipmentParameters.length),e.xp6(1),e.Q6J("ngForOf",r.equipment.equipmentParameters),e.xp6(1),e.Q6J("ngIf",r.addingNewEquipmentParameter),e.xp6(1),e.Q6J("ngIf",!r.addingNewEquipmentParameter),e.xp6(4),e.Q6J("disabled",!r.equipmentForm.valid||!r.equipmentForm.dirty))},dependencies:[s.sg,s.O5,L.BN,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,y],styles:[".parameter-card--name[_ngcontent-%COMP%]{width:55%}.parameter-card--value[_ngcontent-%COMP%], .parameter-card--icon[_ngcontent-%COMP%], .parameter-card--symbol[_ngcontent-%COMP%]{width:15%;text-align:center}.parameter-card--icon[_ngcontent-%COMP%]{color:#dc3545}"]})}function je(o,n){if(1&o&&(e.TgZ(0,"div",9)(1,"p",10),e._uU(2),e.qZA()()),2&o){const t=n.$implicit;e.xp6(2),e.AsE(" ",t.name,": ",t.parameterValue+" "+t.measurementUnitSymbol," ")}}function Ke(o,n){if(1&o&&(e.TgZ(0,"div",6)(1,"h4",7),e._uU(2,"Par\xe1metros del equipo:"),e.qZA(),e.YNc(3,je,3,2,"div",8),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.equipment.equipmentParameters)}}function He(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",1)(2,"div",2)(3,"p")(4,"b"),e._uU(5,"Cliente: "),e.qZA(),e.TgZ(6,"a",3),e._uU(7),e.qZA()()(),e.TgZ(8,"div",2)(9,"p")(10,"b"),e._uU(11,"Sucursal: "),e.qZA(),e.TgZ(12,"a",3),e._uU(13),e.qZA()()(),e.TgZ(14,"div",4)(15,"p")(16,"b"),e._uU(17,"Descripci\xf3n: "),e.qZA(),e._uU(18),e.qZA()()(),e.YNc(19,Ke,4,1,"div",5),e.BQk()),2&o){const t=e.oxw();e.xp6(6),e.Q6J("routerLink","/"+t.routeConstants.customersPath+"/"+t.equipment.customerId),e.xp6(1),e.Oqu(t.equipment.customerName),e.xp6(5),e.Q6J("routerLink","/"+t.routeConstants.customersPath+"/"+t.equipment.customerId+"/"+t.routeConstants.branchPath+"/"+t.equipment.branchId),e.xp6(1),e.hij(" ",t.equipment.branchName," "),e.xp6(5),e.hij(" ",t.equipment.description?t.equipment.description:"No se ingres\xf3 descripci\xf3n del equipo.",""),e.xp6(1),e.Q6J("ngIf",t.equipment.equipmentParameters.length)}}class U{constructor(){this.routeConstants=h.p7}static#e=this.\u0275fac=function(t){return new(t||U)};static#t=this.\u0275cmp=e.Xpm({type:U,selectors:[["app-equipment-info"]],inputs:{equipment:"equipment"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"col-sm-6","col-md-4"],[3,"routerLink"],[1,"col-12"],["class","row g-2",4,"ngIf"],[1,"row","g-2"],[1,"mb-1"],["class","col-lg-3 col-md-4 col-sm-6",4,"ngFor","ngForOf"],[1,"col-lg-3","col-md-4","col-sm-6"],[1,"m-0"]],template:function(t,r){1&t&&e.YNc(0,He,20,6,"ng-container",0),2&t&&e.Q6J("ngIf",r.equipment)},dependencies:[s.sg,s.O5,l.rH]})}function Le(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"app-equipment-info",6),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("equipment",t.equipment)}}function $e(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",7)(1,"app-edit-equipment",8),e.NdJ("cancelEvent",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.setEditingEquipment(!1))})("equipmentUpdatedEvent",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onEquipmentUpdated())}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("equipment",t.equipment)}}function Re(o,n){if(1&o&&(e.TgZ(0,"div",7)(1,"h2",9),e._uU(2,"Ordenes de trabajo asociadas"),e.qZA(),e._UZ(3,"app-work-orders-table",10),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("items",t.workOrders)}}function ze(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"app-section-title",2),e.NdJ("editButtonClickedEvent",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.setEditingEquipment(!0))}),e.qZA(),e.YNc(2,Le,2,1,"ng-container",3),e.YNc(3,$e,2,1,"ng-template",null,4,e.W1O),e.YNc(5,Re,4,1,"div",5),e.qZA()}if(2&o){const t=e.MAs(4),r=e.oxw();e.xp6(1),e.Q6J("title",r.equipment.name)("editableSection",!r.editingEquipment),e.xp6(1),e.Q6J("ngIf",!r.editingEquipment)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",null==r.workOrders?null:r.workOrders.length)}}class P{constructor(n,t){this.httpService=n,this.route=t,this.editingEquipment=!1,this.routeConstants=h.p7,this.userRoles=v.v}ngOnInit(){this.getEquipment()}getEquipment(){const n=this.route.snapshot.paramMap.get("id");this.httpService.get(`Equipment/${n}`).subscribe(t=>{this.equipment=t,this.getWorkOrders()})}getWorkOrders(){this.httpService.get(`${p.G.workOrderApi}/equipment?equipmentId=${this.equipment.id}`).subscribe(n=>this.workOrders=n)}setEditingEquipment(n){this.editingEquipment=n}onEquipmentUpdated(){this.setEditingEquipment(!1),this.getEquipment()}static#e=this.\u0275fac=function(t){return new(t||P)(e.Y36(m.O),e.Y36(l.gz))};static#t=this.\u0275cmp=e.Xpm({type:P,selectors:[["app-equipment"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[3,"title","editableSection","editButtonClickedEvent"],[4,"ngIf","ngIfElse"],["editEquipmentSection",""],["class","row mt-3",4,"ngIf"],[3,"equipment"],[1,"row","mt-3"],[3,"equipment","cancelEvent","equipmentUpdatedEvent"],[1,"text-center"],[3,"items"]],template:function(t,r){1&t&&e.YNc(0,ze,6,5,"div",0),2&t&&e.Q6J("ngIf",r.equipment)},dependencies:[s.O5,I,b,J,U]})}function Ve(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",5)(1,"app-dropdown",9),e.NdJ("onSelectOptionEvent",function(i){e.CHM(t);const c=e.oxw(2);return e.KtG(c.onSelectEquipment(i))}),e.ALo(2,"toDropdownItem"),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("label","Equipo")("options",e.xi3(2,3,t.equipment,"equipment"))("selectedOptionId",t.workOrder.equipmentId)}}function Xe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onSubmit())}),e.TgZ(1,"div",2)(2,"div",3)(3,"p",4)(4,"b"),e._uU(5,"Cliente: "),e.qZA(),e._uU(6),e.qZA()(),e.TgZ(7,"div",5)(8,"label",6),e._uU(9,"C\xf3digo GMC"),e.qZA(),e._UZ(10,"input",7),e.qZA(),e.TgZ(11,"div",5)(12,"label",6),e._uU(13,"C\xf3digo OT cliente"),e.qZA(),e._UZ(14,"input",8),e.qZA(),e.TgZ(15,"div",5)(16,"app-dropdown",9),e.NdJ("onSelectOptionEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.onSelectBranch(i))}),e.ALo(17,"toDropdownItem"),e.qZA()(),e.YNc(18,Ve,3,6,"div",10),e.TgZ(19,"div",5)(20,"app-dropdown",9),e.NdJ("onSelectOptionEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.onSelectWorkOrderState(i))}),e.ALo(21,"toDropdownItem"),e.qZA()(),e.TgZ(22,"div",5)(23,"app-dropdown",9),e.NdJ("onSelectOptionEvent",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.onSelectEmployee(i))}),e.ALo(24,"toDropdownItem"),e.qZA()(),e.TgZ(25,"div",3)(26,"label",6),e._uU(27,"Trabajo a realizar"),e.qZA(),e._UZ(28,"textarea",11),e.qZA()(),e.TgZ(29,"div",12)(30,"button",13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelUpdateEvent.emit())}),e._uU(31,"Cancelar"),e.qZA(),e.TgZ(32,"button",14),e._uU(33,"Guardar"),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.workOrderForm),e.xp6(6),e.Oqu(t.workOrder.customerName),e.xp6(10),e.Q6J("label","Sucursal")("options",e.xi3(17,13,t.branches,"branch"))("selectedOptionId",t.workOrder.branchId),e.xp6(2),e.Q6J("ngIf",t.equipment&&t.equipment.length),e.xp6(2),e.Q6J("label","Estado")("options",e.xi3(21,16,t.workOrderStates,"workState"))("selectedOptionId",null==t.workOrder.workState?null:t.workOrder.workState.id),e.xp6(3),e.Q6J("label","Asignado a")("options",e.xi3(24,19,t.employees,"user"))("selectedOptionId",t.workOrder.assignedUserId),e.xp6(9),e.Q6J("disabled",!t.workOrderForm.valid)}}class S{constructor(n,t){this.httpService=n,this.fb=t,this.workOrderUpdatedEvent=new e.vpe,this.cancelUpdateEvent=new e.vpe}ngOnChanges(n){this.workOrder&&(this.initForm(),this.getCustomerBranches(),this.getEmployeesList(),this.getWorkOrderStates(),this.getEquipment())}initForm(){!this.workOrder||(console.log(this.workOrder),this.workOrderForm=this.fb.group({assignedUserId:[this.workOrder.assignedUserId,a.kI.required],branchId:[this.workOrder.branchId,a.kI.required],customerCode:[this.workOrder.customerCode],description:[this.workOrder.workOrderDescription],equipmentId:[this.workOrder.equipmentId],internalCode:[this.workOrder.internalCode],workState:[this.workOrder.workState,a.kI.required]}))}onSubmit(){if(!this.workOrder||!this.workOrderForm||!this.workOrderForm.valid)return;const n={...this.workOrder,assignedUserId:this.workOrderForm.controls.assignedUserId.value,branchId:this.workOrderForm.controls.branchId.value,customerCode:this.workOrderForm.controls.customerCode.value,equipmentId:this.workOrderForm.controls.equipmentId.value,internalCode:this.workOrderForm.controls.internalCode.value,workOrderDescription:this.workOrderForm.controls.description.value,workState:this.workOrderForm.controls.workState.value};this.httpService.put(p.G.workOrderApi,n).subscribe(()=>this.workOrderUpdatedEvent.emit())}getCustomerBranches(){!this.workOrder||this.httpService.get(`${p.G.branchesApi}/${this.workOrder.customerId}`).subscribe(n=>this.branches=n)}onSelectBranch(n){if(!this.workOrderForm)return;const t=this.branches.find(r=>r.id==n.id);t&&(this.getEquipment(t.id),this.workOrderForm.patchValue({branchId:t.id}))}getEquipment(n=0){0==n&&(n=this.workOrder.branchId),this.httpService.get(`${p.G.equipmentApi}?branchId=${n}`).subscribe(t=>this.equipment=t)}onSelectEquipment(n){if(!this.workOrderForm)return;const t=this.equipment.find(r=>r.id==n.id);t&&this.workOrderForm.patchValue({equipmentId:t.id})}getEmployeesList(){!this.workOrder||this.httpService.get(`${p.G.userEmployeesApi}`).subscribe(n=>this.employees=n)}onSelectEmployee(n){if(!this.workOrderForm)return;const t=this.employees.find(r=>r.userId==n.id);t&&this.workOrderForm?.patchValue({assignedUserId:t.userId})}getWorkOrderStates(){!this.workOrder||this.httpService.get(`${p.G.workStateApi}`).subscribe(n=>this.workOrderStates=n)}onSelectWorkOrderState(n){if(!this.workOrderForm)return;const t=this.workOrderStates.find(r=>r.id==n.id);t&&this.workOrderForm?.patchValue({workState:t})}static#e=this.\u0275fac=function(t){return new(t||S)(e.Y36(m.O),e.Y36(a.qu))};static#t=this.\u0275cmp=e.Xpm({type:S,selectors:[["app-edit-work-order"]],inputs:{workOrder:"workOrder"},outputs:{workOrderUpdatedEvent:"workOrderUpdatedEvent",cancelUpdateEvent:"cancelUpdateEvent"},features:[e.TTD],decls:1,vars:1,consts:[[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"row","mt-3","g-3"],[1,"col-12"],[1,"m-0"],[1,"col-lg-4","col-sm-6"],[1,"form-label"],["type","text","formControlName","internalCode",1,"form-control"],["type","text","formControlName","customerCode",1,"form-control"],[3,"label","options","selectedOptionId","onSelectOptionEvent"],["class","col-lg-4 col-sm-6",4,"ngIf"],["rows","5","formControlName","description",1,"form-control"],[1,"d-flex","mt-3","justify-content-center"],["type","buttol",1,"btn","btn-outline-danger","me-3",3,"click"],[1,"btn","btn-outline-primary",3,"disabled"]],template:function(t,r){1&t&&e.YNc(0,Xe,34,22,"form",0),2&t&&e.Q6J("ngIf",r.workOrder&&r.workOrderForm)},dependencies:[s.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,W.J,D.s]})}function et(o,n){if(1&o&&(e.TgZ(0,"form",8)(1,"div",9)(2,"div",10)(3,"label",11),e._uU(4,"Descripci\xf3n:"),e.qZA(),e._UZ(5,"textarea",12),e.qZA()()()),2&o){const t=e.oxw();e.Q6J("formGroup",t.activityForm)}}class M{constructor(n,t,r){this.fb=n,this.httpService=t,this.activeModal=r}ngOnInit(){this.initForm()}initForm(){!this.workOrderId||(this.activityForm=this.fb.group({description:["",a.kI.required],workOrderId:[this.workOrderId,a.kI.required]}))}onSubmit(){this.activityForm&&this.activityForm.valid&&this.httpService.post(`${p.G.workOrderActivity}`,{description:this.activityForm.controls.description.value,workOrderId:this.activityForm.controls.workOrderId.value}).subscribe(()=>{this.activeModal.close(!0)})}static#e=this.\u0275fac=function(t){return new(t||M)(e.Y36(a.qu),e.Y36(m.O),e.Y36(u.Kz))};static#t=this.\u0275cmp=e.Xpm({type:M,selectors:[["app-new-work-order-activity"]],inputs:{workOrderId:"workOrderId"},decls:11,vars:2,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],["type","button",1,"btn","btn-outline-primary",3,"disabled","click"],[3,"formGroup"],[1,"row"],[1,"col"],["for","label-form"],["rows","5","formControlName","description",1,"form-control"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Registrar trabajo realizado"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.activeModal.dismiss("Cross click")}),e.qZA()(),e.TgZ(4,"div",3),e.YNc(5,et,6,1,"form",4),e.qZA(),e.TgZ(6,"div",5)(7,"button",6),e.NdJ("click",function(){return r.activeModal.close(!1)}),e._uU(8,"Cerrar"),e.qZA(),e.TgZ(9,"button",7),e.NdJ("click",function(){return r.onSubmit()}),e._uU(10,"Guardar"),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",r.activityForm),e.xp6(4),e.Q6J("disabled",!r.activityForm||!r.activityForm.valid))},dependencies:[s.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u],styles:[".added-file[_ngcontent-%COMP%]{display:inline-flex;padding:.2rem .5rem;border-radius:.2rem;background-color:#c8c8c8b3;align-items:center;margin-bottom:.5rem;margin-right:.5rem}.added-file[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:.5rem;max-width:8rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.added-file[_ngcontent-%COMP%]:last-child{margin-right:0}"]})}var tt=d(2706);function nt(o,n){if(1&o&&(e.TgZ(0,"div",2)(1,"p")(2,"b"),e._uU(3,"C\xf3digo OT cliente: "),e.qZA(),e._uU(4),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.hij(" ",t.workOrder.customerCode," ")}}function rt(o,n){if(1&o&&(e.TgZ(0,"div",2)(1,"p")(2,"b"),e._uU(3,"Equipo: "),e.qZA(),e.TgZ(4,"a",3),e._uU(5),e.qZA()()()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("routerLink","/"+t.routeConstants.equipmentPath+"/"+t.workOrder.equipmentId),e.xp6(1),e.hij(" ",t.workOrder.equipmentName," ")}}function ot(o,n){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function it(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2,"Trabajos realizados"),e.qZA(),e.TgZ(3,"ul"),e.YNc(4,ot,2,1,"li",10),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",t.workOrder.activities)}}function at(o,n){1&o&&e._UZ(0,"app-image-thumbnail",13),2&o&&e.Q6J("appFile",n.$implicit)}function ct(o,n){if(1&o&&(e.TgZ(0,"div",1)(1,"h2",11),e._uU(2,"Archivos"),e.qZA(),e.YNc(3,at,1,1,"app-image-thumbnail",12),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.workOrder.files)}}function st(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",1)(2,"div",2)(3,"p")(4,"b"),e._uU(5,"Cliente: "),e.qZA(),e.TgZ(6,"a",3),e._uU(7),e.qZA()()(),e.TgZ(8,"div",2)(9,"p")(10,"b"),e._uU(11,"Sucursal: "),e.qZA(),e.TgZ(12,"a",3),e._uU(13),e.qZA()()(),e.YNc(14,nt,5,1,"div",4),e.TgZ(15,"div",2)(16,"p")(17,"b"),e._uU(18,"Fecha de creaci\xf3n: "),e.qZA(),e._uU(19),e.ALo(20,"date"),e.qZA()(),e.TgZ(21,"div",2)(22,"p")(23,"b"),e._uU(24,"Tipo: "),e.qZA(),e._uU(25),e.qZA()(),e.TgZ(26,"div",2)(27,"p")(28,"b"),e._uU(29,"Asignado a: "),e.qZA(),e.TgZ(30,"a",3),e._uU(31),e.qZA()()(),e.YNc(32,rt,6,2,"div",4),e.TgZ(33,"div",5)(34,"h2"),e._uU(35,"Trabajo a realizar"),e.qZA(),e.TgZ(36,"p"),e._uU(37),e.qZA()()(),e.TgZ(38,"div",6),e.YNc(39,it,5,1,"ng-container",0),e.TgZ(40,"div",7)(41,"button",8),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openNewWorkOrderActivityModal())}),e._uU(42,"Registrar trabajo realizado"),e.qZA()()(),e.YNc(43,ct,4,1,"div",9),e.BQk()}if(2&o){const t=e.oxw();e.xp6(6),e.Q6J("routerLink","/"+t.routeConstants.customersPath+"/"+t.workOrder.customerId),e.xp6(1),e.hij(" ",t.workOrder.customerName," "),e.xp6(5),e.Q6J("routerLink","/"+t.routeConstants.customersPath+"/"+t.workOrder.customerId+"/"+t.routeConstants.branchPath+"/"+t.workOrder.branchId),e.xp6(1),e.hij(" ",t.workOrder.branchName," "),e.xp6(1),e.Q6J("ngIf",t.workOrder.customerCode),e.xp6(5),e.hij(" ",e.lcZ(20,13,t.workOrder.createdOn),""),e.xp6(6),e.hij(" ",t.workOrder.workOrderTypeName,""),e.xp6(5),e.Q6J("routerLink","/"+t.routeConstants.usersManagement+"/"+t.workOrder.assignedUserId),e.xp6(1),e.hij(" ",t.workOrder.assignedUserName," "),e.xp6(1),e.Q6J("ngIf",t.workOrder.equipmentId),e.xp6(5),e.hij(" ",t.workOrder.workOrderDescription?t.workOrder.workOrderDescription:"No se ingres\xf3 descripci\xf3n de la OT."," "),e.xp6(2),e.Q6J("ngIf",t.workOrder.activities&&t.workOrder.activities.length),e.xp6(4),e.Q6J("ngIf",t.workOrder.files.length)}}class Q{constructor(n){this.modalService=n,this.routeConstants=h.p7,this.workOrderActivityCreatedEvent=new e.vpe}openNewWorkOrderActivityModal(){if(!this.workOrder)return;const n=this.modalService.open(M,{size:"xl"});n.componentInstance.workOrderId=this.workOrder.workOrderId,n.closed.subscribe(t=>{t&&this.workOrderActivityCreatedEvent.emit()})}static#e=this.\u0275fac=function(t){return new(t||Q)(e.Y36(u.FF))};static#t=this.\u0275cmp=e.Xpm({type:Q,selectors:[["app-work-order-info"]],inputs:{workOrder:"workOrder"},outputs:{workOrderActivityCreatedEvent:"workOrderActivityCreatedEvent"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"row","mt-3"],[1,"col-lg-4","col-sm-6"],[3,"routerLink"],["class","col-lg-4 col-sm-6",4,"ngIf"],[1,"col-12"],[1,"row"],[1,"col-12","text-center","mt-3"],[1,"btn","btn-outline-primary",3,"click"],["class","row mt-3",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"text-center"],[3,"appFile",4,"ngFor","ngForOf"],[3,"appFile"]],template:function(t,r){1&t&&e.YNc(0,st,44,15,"ng-container",0),2&t&&e.Q6J("ngIf",r.workOrder)},dependencies:[s.sg,s.O5,l.rH,tt.w,s.uU]})}function dt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-model",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onEditWorkOrder())}),e.qZA()}}function pt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-model",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onEditWorkOrder())}),e.qZA()}}function mt(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-work-order-info",11),e.NdJ("workOrderActivityCreatedEvent",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.woActivityCreated())}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("workOrder",t.workOrder)}}function lt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-work-order",12),e.NdJ("cancelUpdateEvent",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onCancelEditWorkOrder())})("workOrderUpdatedEvent",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onWorkOrderEdited())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("workOrder",t.workOrder)}}const ut=function(o){return[o,"work-order-state m-0"]},_t=function(o){return[o,"work-order-state d-inline-block mt-2 mb-0"]};function ht(o,n){if(1&o&&(e.TgZ(0,"div",1)(1,"section",2)(2,"p",3),e._uU(3),e.ALo(4,"workState"),e.qZA(),e.TgZ(5,"h1",4),e._uU(6),e.YNc(7,dt,1,0,"app-edit-model",5),e.qZA()(),e.TgZ(8,"section",6)(9,"h1",4),e._uU(10),e.YNc(11,pt,1,0,"app-edit-model",5),e.qZA(),e.TgZ(12,"div",7)(13,"p",3),e._uU(14),e.ALo(15,"workState"),e.qZA()()(),e.YNc(16,mt,2,1,"ng-container",8),e.YNc(17,lt,1,1,"ng-template",null,9,e.W1O),e.qZA()),2&o){const t=e.MAs(18),r=e.oxw();e.xp6(2),e.Q6J("ngClass",e.VKq(14,ut,r.setWorkOrderStateClass(r.workOrder.workState))),e.xp6(1),e.hij(" ",e.lcZ(4,10,r.workOrder.workState)," "),e.xp6(3),e.hij(" Orden de trabajo: ",r.workOrder.internalCode?r.workOrder.internalCode:r.workOrder.workOrderId," "),e.xp6(1),e.Q6J("ngIf",!r.isEditingWorkOrder),e.xp6(3),e.hij(" Orden de trabajo: ",r.workOrder.internalCode?r.workOrder.internalCode:r.workOrder.workOrderId," "),e.xp6(1),e.Q6J("ngIf",!r.isEditingWorkOrder),e.xp6(2),e.Q6J("ngClass",e.VKq(16,_t,r.setWorkOrderStateClass(r.workOrder.workState))),e.xp6(1),e.hij(" ",e.lcZ(15,12,r.workOrder.workState)," "),e.xp6(2),e.Q6J("ngIf",!r.isEditingWorkOrder)("ngIfElse",t)}}class Y{constructor(n,t){this.httpService=n,this.route=t,this.routeConstants=h.p7,this.userRoles=v.v,this.isEditingWorkOrder=!1}ngOnInit(){this.getWorkOrder()}getWorkOrder(){const n=this.route.snapshot.paramMap.get("id");this.httpService.get(`${p.G.workOrderApi}/${n}`).subscribe(t=>this.workOrder=t)}setWorkOrderStateClass(n){switch(n.id){case 2:return"in-progress";case 3:return"closed";default:return"open"}}onEditWorkOrder(){this.isEditingWorkOrder=!0}onWorkOrderEdited(){this.isEditingWorkOrder=!1,this.getWorkOrder()}onCancelEditWorkOrder(){this.isEditingWorkOrder=!1}woActivityCreated(){this.getWorkOrder()}static#e=this.\u0275fac=function(t){return new(t||Y)(e.Y36(m.O),e.Y36(l.gz))};static#t=this.\u0275cmp=e.Xpm({type:Y,selectors:[["app-work-order"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"d-none","d-md-flex","justify-content-center","align-items-center","gap-3","mt-3"],[3,"ngClass"],[1,"m-0","d-flex","justify-content-center","align-items-center"],[3,"click",4,"ngIf"],[1,"d-md-none","mt-3"],[1,"text-center"],[4,"ngIf","ngIfElse"],["editingWorkOrder",""],[3,"click"],[3,"workOrder","workOrderActivityCreatedEvent"],[3,"workOrder","cancelUpdateEvent","workOrderUpdatedEvent"]],template:function(t,r){1&t&&e.YNc(0,ht,19,18,"div",0),2&t&&e.Q6J("ngIf",r.workOrder)},dependencies:[s.mk,s.O5,k.D,S,Q,z.$],styles:[".work-order-state[_ngcontent-%COMP%]{color:#fff;padding:.2rem .5rem;border-radius:.2rem}.work-order-state.open[_ngcontent-%COMP%]{background-color:#0d6efd}.work-order-state.in-progress[_ngcontent-%COMP%]{background-color:#ffc107}.work-order-state.closed[_ngcontent-%COMP%]{background-color:#198754}"]})}const ft=[{path:"",component:A},{path:"customer",children:[{path:":id",component:Z},{path:":customerId/branch/:branchId",component:x}]},{path:"work-order/:id",component:Y},{path:"equipment/:id",component:P}];class B{static#e=this.\u0275fac=function(t){return new(t||B)};static#t=this.\u0275mod=e.oAB({type:B});static#n=this.\u0275inj=e.cJS({imports:[l.Bz.forChild(ft),l.Bz]})}var gt=d(6619),vt=d(9127);class G{static#e=this.\u0275fac=function(t){return new(t||G)};static#t=this.\u0275mod=e.oAB({type:G});static#n=this.\u0275inj=e.cJS({imports:[s.ez,B,gt.m,vt.I]})}}}]);